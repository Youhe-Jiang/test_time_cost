
{
  "schemaVersion": 1,
  "distributedInfo": {"backend": "nccl", "rank": 1, "world_size": 4},
  "deviceProperties": [
    {
      "id": 0, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 1, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 2, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 3, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    }
  ],
  "traceEvents": [
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278911314,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736199417280, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278911307, "dur": 37,
    "args": {
       "External id": 2,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 38976, "tid": 38976,
    "ts": 1638154278911378, "dur": 1,
    "args": {
       "External id": 3,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 38976, "tid": 38976,
    "ts": 1638154278911263, "dur": 121,
    "args": {
       "External id": 1,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278911446,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94733085825088, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278911444, "dur": 8,
    "args": {
       "External id": 5,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278911454,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94733085825088, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278911461,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736199417280, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278911924,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736199438144, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278911922, "dur": 12,
    "args": {
       "External id": 7,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 38976, "tid": 38976,
    "ts": 1638154278911973, "dur": 1,
    "args": {
       "External id": 8,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 38976, "tid": 38976,
    "ts": 1638154278911897, "dur": 79,
    "args": {
       "External id": 6,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912043,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736199540736, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278912042, "dur": 6,
    "args": {
       "External id": 10,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912050,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736199540736, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912057,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736199438144, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 38976, "tid": 38976,
    "ts": 1638154278912019, "dur": 287,
    "args": {
       "External id": 9,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912494,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333171200, "Bytes": -24576, "Total Allocated": 566995456, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912501,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333195776, "Bytes": -24576, "Total Allocated": 566970880, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912783,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333171200, "Bytes": 24576, "Total Allocated": 566995456, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278912771, "dur": 19,
    "args": {
       "External id": 13,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278912826, "dur": 48,
    "args": {
       "External id": 14,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 38976, "tid": 38976,
    "ts": 1638154278912656, "dur": 221,
    "args": {
       "External id": 12,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278912576, "dur": 303,
    "args": {
       "External id": 11,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278912985,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333195776, "Bytes": 24576, "Total Allocated": 567020032, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278912976, "dur": 15,
    "args": {
       "External id": 17,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278913012, "dur": 32,
    "args": {
       "External id": 18,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 38976, "tid": 38976,
    "ts": 1638154278912922, "dur": 124,
    "args": {
       "External id": 16,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278912903, "dur": 145,
    "args": {
       "External id": 15,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913248, "dur": 1,
    "args": {
       "External id": 19,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913349, "dur": 0,
    "args": {
       "External id": 20,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913491, "dur": 0,
    "args": {
       "External id": 21,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913634, "dur": 1,
    "args": {
       "External id": 22,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913757, "dur": 1,
    "args": {
       "External id": 23,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913791, "dur": 1,
    "args": {
       "External id": 24,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278913996, "dur": 0,
    "args": {
       "External id": 25,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278914024, "dur": 0,
    "args": {
       "External id": 26,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 38976, "tid": 38976,
    "ts": 1638154278914222, "dur": 1,
    "args": {
       "External id": 27,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[28342272], [113369088]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278914295, "dur": 2,
    "args": {
       "External id": 29,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278914264, "dur": 37,
    "args": {
       "External id": 28,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278914335, "dur": 5,
    "args": {
       "External id": 30,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 38976, "tid": 38976,
    "ts": 1638154278914369, "dur": 1,
    "args": {
       "External id": 31,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [113369088]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278914571, "dur": 1,
    "args": {
       "External id": 35,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278914538, "dur": 37,
    "args": {
       "External id": 34,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278914507, "dur": 70,
    "args": {
       "External id": 33,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278914691, "dur": 0,
    "args": {
       "External id": 38,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278914661, "dur": 32,
    "args": {
       "External id": 37,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278914620, "dur": 75,
    "args": {
       "External id": 36,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278914787, "dur": 0,
    "args": {
       "External id": 41,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278914758, "dur": 31,
    "args": {
       "External id": 40,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278914727, "dur": 64,
    "args": {
       "External id": 39,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278914887, "dur": 1,
    "args": {
       "External id": 44,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278914856, "dur": 34,
    "args": {
       "External id": 43,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278914822, "dur": 70,
    "args": {
       "External id": 42,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278914983, "dur": 1,
    "args": {
       "External id": 47,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278914952, "dur": 33,
    "args": {
       "External id": 46,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278914921, "dur": 66,
    "args": {
       "External id": 45,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915078, "dur": 0,
    "args": {
       "External id": 50,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915047, "dur": 33,
    "args": {
       "External id": 49,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915017, "dur": 65,
    "args": {
       "External id": 48,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915172, "dur": 1,
    "args": {
       "External id": 53,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915142, "dur": 33,
    "args": {
       "External id": 52,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915114, "dur": 63,
    "args": {
       "External id": 51,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915267, "dur": 0,
    "args": {
       "External id": 56,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915236, "dur": 33,
    "args": {
       "External id": 55,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915208, "dur": 86,
    "args": {
       "External id": 54,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915385, "dur": 0,
    "args": {
       "External id": 59,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915355, "dur": 32,
    "args": {
       "External id": 58,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915326, "dur": 63,
    "args": {
       "External id": 57,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915485, "dur": 1,
    "args": {
       "External id": 62,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915450, "dur": 38,
    "args": {
       "External id": 61,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915418, "dur": 71,
    "args": {
       "External id": 60,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915580, "dur": 1,
    "args": {
       "External id": 65,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915549, "dur": 34,
    "args": {
       "External id": 64,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915519, "dur": 65,
    "args": {
       "External id": 63,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915684, "dur": 1,
    "args": {
       "External id": 68,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915653, "dur": 34,
    "args": {
       "External id": 67,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915623, "dur": 65,
    "args": {
       "External id": 66,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915779, "dur": 1,
    "args": {
       "External id": 71,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915749, "dur": 33,
    "args": {
       "External id": 70,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915720, "dur": 63,
    "args": {
       "External id": 69,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915874, "dur": 1,
    "args": {
       "External id": 74,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915845, "dur": 32,
    "args": {
       "External id": 73,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915815, "dur": 63,
    "args": {
       "External id": 72,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278915979, "dur": 0,
    "args": {
       "External id": 77,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278915950, "dur": 31,
    "args": {
       "External id": 76,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278915918, "dur": 65,
    "args": {
       "External id": 75,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916076, "dur": 0,
    "args": {
       "External id": 80,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916045, "dur": 33,
    "args": {
       "External id": 79,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916014, "dur": 68,
    "args": {
       "External id": 78,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916173, "dur": 1,
    "args": {
       "External id": 83,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916142, "dur": 34,
    "args": {
       "External id": 82,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916112, "dur": 65,
    "args": {
       "External id": 81,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916268, "dur": 0,
    "args": {
       "External id": 86,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916237, "dur": 33,
    "args": {
       "External id": 85,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916207, "dur": 65,
    "args": {
       "External id": 84,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916362, "dur": 1,
    "args": {
       "External id": 89,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916331, "dur": 34,
    "args": {
       "External id": 88,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916303, "dur": 63,
    "args": {
       "External id": 87,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916456, "dur": 1,
    "args": {
       "External id": 92,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916428, "dur": 31,
    "args": {
       "External id": 91,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916397, "dur": 63,
    "args": {
       "External id": 90,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916551, "dur": 1,
    "args": {
       "External id": 95,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916523, "dur": 35,
    "args": {
       "External id": 94,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916491, "dur": 69,
    "args": {
       "External id": 93,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916656, "dur": 1,
    "args": {
       "External id": 98,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916625, "dur": 34,
    "args": {
       "External id": 97,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916589, "dur": 71,
    "args": {
       "External id": 96,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916750, "dur": 1,
    "args": {
       "External id": 101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916720, "dur": 33,
    "args": {
       "External id": 100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916689, "dur": 65,
    "args": {
       "External id": 99,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916844, "dur": 1,
    "args": {
       "External id": 104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916814, "dur": 33,
    "args": {
       "External id": 103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916783, "dur": 66,
    "args": {
       "External id": 102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278916938, "dur": 1,
    "args": {
       "External id": 107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278916908, "dur": 33,
    "args": {
       "External id": 106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916880, "dur": 63,
    "args": {
       "External id": 105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917035, "dur": 1,
    "args": {
       "External id": 110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917006, "dur": 31,
    "args": {
       "External id": 109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278916976, "dur": 63,
    "args": {
       "External id": 108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917130, "dur": 1,
    "args": {
       "External id": 113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917102, "dur": 33,
    "args": {
       "External id": 112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917070, "dur": 66,
    "args": {
       "External id": 111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917234, "dur": 1,
    "args": {
       "External id": 116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917203, "dur": 34,
    "args": {
       "External id": 115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917166, "dur": 72,
    "args": {
       "External id": 114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917329, "dur": 1,
    "args": {
       "External id": 119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917298, "dur": 33,
    "args": {
       "External id": 118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917267, "dur": 66,
    "args": {
       "External id": 117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917457, "dur": 1,
    "args": {
       "External id": 122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917428, "dur": 31,
    "args": {
       "External id": 121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917399, "dur": 62,
    "args": {
       "External id": 120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917549, "dur": 1,
    "args": {
       "External id": 125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917520, "dur": 32,
    "args": {
       "External id": 124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917491, "dur": 62,
    "args": {
       "External id": 123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917647, "dur": 0,
    "args": {
       "External id": 128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917617, "dur": 32,
    "args": {
       "External id": 127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917583, "dur": 70,
    "args": {
       "External id": 126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917746, "dur": 1,
    "args": {
       "External id": 131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917716, "dur": 33,
    "args": {
       "External id": 130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917685, "dur": 66,
    "args": {
       "External id": 129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917842, "dur": 0,
    "args": {
       "External id": 134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917811, "dur": 33,
    "args": {
       "External id": 133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917780, "dur": 66,
    "args": {
       "External id": 132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278917938, "dur": 1,
    "args": {
       "External id": 137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278917906, "dur": 35,
    "args": {
       "External id": 136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917875, "dur": 67,
    "args": {
       "External id": 135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918033, "dur": 1,
    "args": {
       "External id": 140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918002, "dur": 33,
    "args": {
       "External id": 139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278917974, "dur": 63,
    "args": {
       "External id": 138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918128, "dur": 1,
    "args": {
       "External id": 143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918097, "dur": 34,
    "args": {
       "External id": 142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918069, "dur": 67,
    "args": {
       "External id": 141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918226, "dur": 1,
    "args": {
       "External id": 146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918198, "dur": 31,
    "args": {
       "External id": 145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918167, "dur": 63,
    "args": {
       "External id": 144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918330, "dur": 1,
    "args": {
       "External id": 149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918292, "dur": 41,
    "args": {
       "External id": 148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918262, "dur": 73,
    "args": {
       "External id": 147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918426, "dur": 1,
    "args": {
       "External id": 152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918395, "dur": 34,
    "args": {
       "External id": 151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918364, "dur": 66,
    "args": {
       "External id": 150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918521, "dur": 1,
    "args": {
       "External id": 155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918490, "dur": 34,
    "args": {
       "External id": 154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918460, "dur": 65,
    "args": {
       "External id": 153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918622, "dur": 0,
    "args": {
       "External id": 158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918585, "dur": 42,
    "args": {
       "External id": 157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918557, "dur": 71,
    "args": {
       "External id": 156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918719, "dur": 1,
    "args": {
       "External id": 161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918688, "dur": 34,
    "args": {
       "External id": 160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918659, "dur": 65,
    "args": {
       "External id": 159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918814, "dur": 1,
    "args": {
       "External id": 164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918786, "dur": 31,
    "args": {
       "External id": 163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918755, "dur": 63,
    "args": {
       "External id": 162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278918911, "dur": 1,
    "args": {
       "External id": 167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918880, "dur": 34,
    "args": {
       "External id": 166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918850, "dur": 65,
    "args": {
       "External id": 165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919005, "dur": 1,
    "args": {
       "External id": 170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278918975, "dur": 33,
    "args": {
       "External id": 169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278918945, "dur": 65,
    "args": {
       "External id": 168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919102, "dur": 1,
    "args": {
       "External id": 173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919071, "dur": 34,
    "args": {
       "External id": 172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919041, "dur": 65,
    "args": {
       "External id": 171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919196, "dur": 1,
    "args": {
       "External id": 176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919166, "dur": 33,
    "args": {
       "External id": 175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919138, "dur": 62,
    "args": {
       "External id": 174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919291, "dur": 1,
    "args": {
       "External id": 179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919263, "dur": 31,
    "args": {
       "External id": 178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919231, "dur": 65,
    "args": {
       "External id": 177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919385, "dur": 1,
    "args": {
       "External id": 182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919357, "dur": 31,
    "args": {
       "External id": 181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919327, "dur": 62,
    "args": {
       "External id": 180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919483, "dur": 1,
    "args": {
       "External id": 185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919452, "dur": 34,
    "args": {
       "External id": 184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919422, "dur": 67,
    "args": {
       "External id": 183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919586, "dur": 0,
    "args": {
       "External id": 188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919549, "dur": 39,
    "args": {
       "External id": 187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919519, "dur": 71,
    "args": {
       "External id": 186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919686, "dur": 1,
    "args": {
       "External id": 191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919655, "dur": 34,
    "args": {
       "External id": 190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919625, "dur": 65,
    "args": {
       "External id": 189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919781, "dur": 1,
    "args": {
       "External id": 194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919751, "dur": 33,
    "args": {
       "External id": 193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919722, "dur": 63,
    "args": {
       "External id": 192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919877, "dur": 0,
    "args": {
       "External id": 197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919848, "dur": 31,
    "args": {
       "External id": 196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919817, "dur": 64,
    "args": {
       "External id": 195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278919971, "dur": 1,
    "args": {
       "External id": 200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278919942, "dur": 36,
    "args": {
       "External id": 199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278919912, "dur": 68,
    "args": {
       "External id": 198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920070, "dur": 0,
    "args": {
       "External id": 203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920039, "dur": 33,
    "args": {
       "External id": 202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920009, "dur": 65,
    "args": {
       "External id": 201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920164, "dur": 1,
    "args": {
       "External id": 206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920133, "dur": 34,
    "args": {
       "External id": 205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920103, "dur": 65,
    "args": {
       "External id": 204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920258, "dur": 1,
    "args": {
       "External id": 209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920228, "dur": 33,
    "args": {
       "External id": 208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920197, "dur": 65,
    "args": {
       "External id": 207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920352, "dur": 1,
    "args": {
       "External id": 212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920322, "dur": 33,
    "args": {
       "External id": 211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920294, "dur": 63,
    "args": {
       "External id": 210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920448, "dur": 1,
    "args": {
       "External id": 215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920420, "dur": 33,
    "args": {
       "External id": 214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920388, "dur": 66,
    "args": {
       "External id": 213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920545, "dur": 3,
    "args": {
       "External id": 218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920516, "dur": 33,
    "args": {
       "External id": 217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920486, "dur": 65,
    "args": {
       "External id": 216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920647, "dur": 1,
    "args": {
       "External id": 221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920616, "dur": 33,
    "args": {
       "External id": 220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920580, "dur": 71,
    "args": {
       "External id": 219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920741, "dur": 1,
    "args": {
       "External id": 224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920710, "dur": 33,
    "args": {
       "External id": 223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920680, "dur": 65,
    "args": {
       "External id": 222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920835, "dur": 1,
    "args": {
       "External id": 227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920805, "dur": 33,
    "args": {
       "External id": 226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920776, "dur": 63,
    "args": {
       "External id": 225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278920939, "dur": 1,
    "args": {
       "External id": 230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278920908, "dur": 34,
    "args": {
       "External id": 229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920880, "dur": 64,
    "args": {
       "External id": 228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278921035, "dur": 1,
    "args": {
       "External id": 233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278921007, "dur": 31,
    "args": {
       "External id": 232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278920976, "dur": 63,
    "args": {
       "External id": 231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278921129, "dur": 3,
    "args": {
       "External id": 236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278921101, "dur": 33,
    "args": {
       "External id": 235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278921071, "dur": 64,
    "args": {
       "External id": 234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278921226, "dur": 1,
    "args": {
       "External id": 239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278921195, "dur": 34,
    "args": {
       "External id": 238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 38976, "tid": 38976,
    "ts": 1638154278921165, "dur": 65,
    "args": {
       "External id": 237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 38976, "tid": 38976,
    "ts": 1638154278914468, "dur": 6816,
    "args": {
       "External id": 32,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 497
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921337, "dur": 7,
    "args": {
       "External id": 240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 498
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921382, "dur": 4,
    "args": {
       "External id": 241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 499
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921420, "dur": 4,
    "args": {
       "External id": 242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 500
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921457, "dur": 3,
    "args": {
       "External id": 243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 501
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921492, "dur": 3,
    "args": {
       "External id": 244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 502
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921530, "dur": 4,
    "args": {
       "External id": 245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 503
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921566, "dur": 4,
    "args": {
       "External id": 246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 504
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921686, "dur": 5,
    "args": {
       "External id": 247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 505
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921722, "dur": 4,
    "args": {
       "External id": 248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 506
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921758, "dur": 3,
    "args": {
       "External id": 249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 507
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921795, "dur": 4,
    "args": {
       "External id": 250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 508
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921830, "dur": 4,
    "args": {
       "External id": 251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 509
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921865, "dur": 3,
    "args": {
       "External id": 252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 510
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921900, "dur": 3,
    "args": {
       "External id": 253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 511
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921934, "dur": 4,
    "args": {
       "External id": 254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 512
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278921969, "dur": 3,
    "args": {
       "External id": 255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 513
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922004, "dur": 3,
    "args": {
       "External id": 256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 514
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922038, "dur": 4,
    "args": {
       "External id": 257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 515
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922073, "dur": 3,
    "args": {
       "External id": 258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 516
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922108, "dur": 3,
    "args": {
       "External id": 259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 517
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922142, "dur": 3,
    "args": {
       "External id": 260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 518
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922177, "dur": 6,
    "args": {
       "External id": 261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 519
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922215, "dur": 3,
    "args": {
       "External id": 262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 520
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922252, "dur": 4,
    "args": {
       "External id": 263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 521
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922292, "dur": 3,
    "args": {
       "External id": 264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 522
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922329, "dur": 4,
    "args": {
       "External id": 265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 523
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922368, "dur": 3,
    "args": {
       "External id": 266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 524
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922403, "dur": 5,
    "args": {
       "External id": 267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 525
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922439, "dur": 4,
    "args": {
       "External id": 268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 526
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922476, "dur": 4,
    "args": {
       "External id": 269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 527
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922513, "dur": 4,
    "args": {
       "External id": 270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922550, "dur": 4,
    "args": {
       "External id": 271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 529
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922587, "dur": 4,
    "args": {
       "External id": 272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 530
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922628, "dur": 6,
    "args": {
       "External id": 273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 531
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922666, "dur": 5,
    "args": {
       "External id": 274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 532
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922703, "dur": 3,
    "args": {
       "External id": 275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 533
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922740, "dur": 4,
    "args": {
       "External id": 276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 534
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922778, "dur": 3,
    "args": {
       "External id": 277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 535
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922817, "dur": 3,
    "args": {
       "External id": 278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 536
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922854, "dur": 3,
    "args": {
       "External id": 279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 537
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922888, "dur": 6,
    "args": {
       "External id": 280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 538
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922926, "dur": 3,
    "args": {
       "External id": 281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 539
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278922964, "dur": 3,
    "args": {
       "External id": 282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 540
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923001, "dur": 3,
    "args": {
       "External id": 283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 541
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923038, "dur": 4,
    "args": {
       "External id": 284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 542
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923081, "dur": 4,
    "args": {
       "External id": 285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 543
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923116, "dur": 6,
    "args": {
       "External id": 286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 544
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923153, "dur": 6,
    "args": {
       "External id": 287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 545
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923190, "dur": 4,
    "args": {
       "External id": 288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 546
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923227, "dur": 3,
    "args": {
       "External id": 289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 547
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923264, "dur": 4,
    "args": {
       "External id": 290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 548
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923301, "dur": 4,
    "args": {
       "External id": 291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 549
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923341, "dur": 3,
    "args": {
       "External id": 292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 550
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923376, "dur": 5,
    "args": {
       "External id": 293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 551
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923413, "dur": 3,
    "args": {
       "External id": 294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 552
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923449, "dur": 4,
    "args": {
       "External id": 295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 553
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923486, "dur": 4,
    "args": {
       "External id": 296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 554
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923524, "dur": 4,
    "args": {
       "External id": 297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 555
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923561, "dur": 4,
    "args": {
       "External id": 298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 556
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923596, "dur": 11,
    "args": {
       "External id": 299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 557
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923644, "dur": 4,
    "args": {
       "External id": 300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 558
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923682, "dur": 4,
    "args": {
       "External id": 301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 559
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923719, "dur": 4,
    "args": {
       "External id": 302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 560
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923757, "dur": 4,
    "args": {
       "External id": 303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 561
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923794, "dur": 3,
    "args": {
       "External id": 304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 562
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923829, "dur": 5,
    "args": {
       "External id": 305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 563
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923867, "dur": 6,
    "args": {
       "External id": 306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 564
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923904, "dur": 3,
    "args": {
       "External id": 307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 565
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278923940, "dur": 4,
    "args": {
       "External id": 308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 566
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278924074, "dur": 3,
    "args": {
       "External id": 309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278924112, "dur": 0,
    "args": {
       "External id": 310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 567
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 38976, "tid": 38976,
    "ts": 1638154278924169, "dur": 1,
    "args": {
       "External id": 312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 38976, "tid": 38976,
    "ts": 1638154278924143, "dur": 29,
    "args": {
       "External id": 311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 567
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278924233,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94734251291904, "Bytes": 5056, "Total Allocated": 5056, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278924261,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94734251297088, "Bytes": 816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278924381, "dur": 10,
    "args": {
       "External id": 316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278924423, "dur": 31,
    "args": {
       "External id": 317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 38976, "tid": 38976,
    "ts": 1638154278924348, "dur": 109,
    "args": {
       "External id": 315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278924317, "dur": 142,
    "args": {
       "External id": 314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278924556, "dur": 5,
    "args": {
       "External id": 320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278924592, "dur": 25,
    "args": {
       "External id": 321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 38976, "tid": 38976,
    "ts": 1638154278924526, "dur": 97,
    "args": {
       "External id": 319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278924496, "dur": 128,
    "args": {
       "External id": 318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 38976, "tid": 38976,
    "ts": 1638154278924792, "dur": 2,
    "args": {
       "External id": 324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278924753, "dur": 43,
    "args": {
       "External id": 323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278924870, "dur": 6,
    "args": {
       "External id": 326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278924928,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745388658688, "Bytes": 18874368, "Total Allocated": 585894400, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 38976, "tid": 38976,
    "ts": 1638154278924921, "dur": 13,
    "args": {
       "External id": 327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 38976, "tid": 38976,
    "ts": 1638154278924834, "dur": 141,
    "args": {
       "External id": 325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278925013, "dur": 2,
    "args": {
       "External id": 328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 38976, "tid": 38976,
    "ts": 1638154278924713, "dur": 305,
    "args": {
       "External id": 322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278925094, "dur": 1,
    "args": {
       "External id": 330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278925062, "dur": 37,
    "args": {
       "External id": 329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278925162, "dur": 0,
    "args": {
       "External id": 332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278925132, "dur": 33,
    "args": {
       "External id": 331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925237,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": 18874368, "Total Allocated": 604768768, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 38976, "tid": 38976,
    "ts": 1638154278925227, "dur": 43,
    "args": {
       "External id": 333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925467,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745522876416, "Bytes": 18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278925458, "dur": 16,
    "args": {
       "External id": 337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278925423, "dur": 54,
    "args": {
       "External id": 336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925554,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 4718592, "Total Allocated": 628361728, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278925546, "dur": 14,
    "args": {
       "External id": 339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278925513, "dur": 49,
    "args": {
       "External id": 338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278925380, "dur": 209,
    "args": {
       "External id": 335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925593,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -4718592, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278925338, "dur": 259,
    "args": {
       "External id": 334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925610,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": -18874368, "Total Allocated": 604768768, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925798,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": 18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278925793, "dur": 11,
    "args": {
       "External id": 342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925856,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 623655424, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278925852, "dur": 9,
    "args": {
       "External id": 343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278925908,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 623667712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278925905, "dur": 9,
    "args": {
       "External id": 344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278925990, "dur": 3,
    "args": {
       "External id": 345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278926036, "dur": 2,
    "args": {
       "External id": 346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278925743, "dur": 300,
    "args": {
       "External id": 341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278926046,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 623655424, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278926050,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278925695, "dur": 359,
    "args": {
       "External id": 340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278926280, "dur": 2,
    "args": {
       "External id": 350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278926235, "dur": 49,
    "args": {
       "External id": 349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278926186, "dur": 102,
    "args": {
       "External id": 348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278926384, "dur": 3,
    "args": {
       "External id": 352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278926449,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278926442, "dur": 74,
    "args": {
       "External id": 353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278926631, "dur": 2,
    "args": {
       "External id": 355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278926576, "dur": 59,
    "args": {
       "External id": 354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278926338, "dur": 300,
    "args": {
       "External id": 351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278926689, "dur": 31,
    "args": {
       "External id": 356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278926138, "dur": 585,
    "args": {
       "External id": 347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278926771, "dur": 4,
    "args": {
       "External id": 357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278926862, "dur": 1,
    "args": {
       "External id": 359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278926820, "dur": 47,
    "args": {
       "External id": 358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278927060, "dur": 2,
    "args": {
       "External id": 363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278927016, "dur": 48,
    "args": {
       "External id": 362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278926971, "dur": 96,
    "args": {
       "External id": 361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278927157, "dur": 2,
    "args": {
       "External id": 365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278927214,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": 18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278927207, "dur": 66,
    "args": {
       "External id": 366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278927375, "dur": 2,
    "args": {
       "External id": 368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278927329, "dur": 51,
    "args": {
       "External id": 367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278927112, "dur": 271,
    "args": {
       "External id": 364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278927429, "dur": 26,
    "args": {
       "External id": 369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278926926, "dur": 531,
    "args": {
       "External id": 360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278927506, "dur": 3,
    "args": {
       "External id": 370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278927592, "dur": 1,
    "args": {
       "External id": 372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278927551, "dur": 46,
    "args": {
       "External id": 371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278927799, "dur": 1,
    "args": {
       "External id": 376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278927754, "dur": 48,
    "args": {
       "External id": 375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278927710, "dur": 95,
    "args": {
       "External id": 374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278927902, "dur": 2,
    "args": {
       "External id": 378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278927959,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278927952, "dur": 76,
    "args": {
       "External id": 379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278928128, "dur": 1,
    "args": {
       "External id": 381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278928084, "dur": 48,
    "args": {
       "External id": 380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278927851, "dur": 284,
    "args": {
       "External id": 377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278928181, "dur": 26,
    "args": {
       "External id": 382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278927666, "dur": 543,
    "args": {
       "External id": 373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278928258, "dur": 3,
    "args": {
       "External id": 383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278928348, "dur": 2,
    "args": {
       "External id": 385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278928306, "dur": 47,
    "args": {
       "External id": 384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278928434, "dur": 1,
    "args": {
       "External id": 387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278928394, "dur": 44,
    "args": {
       "External id": 386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278928571, "dur": 1,
    "args": {
       "External id": 390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278928530, "dur": 45,
    "args": {
       "External id": 389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278928766,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278928759, "dur": 19,
    "args": {
       "External id": 394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278928718, "dur": 63,
    "args": {
       "External id": 393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278928824, "dur": 30,
    "args": {
       "External id": 395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278928676, "dur": 181,
    "args": {
       "External id": 392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278928941, "dur": 1,
    "args": {
       "External id": 397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278928900, "dur": 45,
    "args": {
       "External id": 396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278928633, "dur": 314,
    "args": {
       "External id": 391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278929026, "dur": 2,
    "args": {
       "External id": 399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278928986, "dur": 45,
    "args": {
       "External id": 398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929203,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278929198, "dur": 12,
    "args": {
       "External id": 403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278929153, "dur": 60,
    "args": {
       "External id": 402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278929256, "dur": 24,
    "args": {
       "External id": 404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278929113, "dur": 169,
    "args": {
       "External id": 401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278929368, "dur": 1,
    "args": {
       "External id": 406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278929328, "dur": 43,
    "args": {
       "External id": 405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278929072, "dur": 301,
    "args": {
       "External id": 400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929469,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 3538944, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278929465, "dur": 11,
    "args": {
       "External id": 408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278929415, "dur": 87,
    "args": {
       "External id": 407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278929587, "dur": 2,
    "args": {
       "External id": 410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278929548, "dur": 44,
    "args": {
       "External id": 409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929595,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929600,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -18874368, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278928482, "dur": 1128,
    "args": {
       "External id": 388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929625,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736200883712, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929687,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 3538944, "Total Allocated": 687344128, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 38976, "tid": 38976,
    "ts": 1638154278929677, "dur": 37,
    "args": {
       "External id": 411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929722,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736200883712, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929728,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -3538944, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278929827, "dur": 2,
    "args": {
       "External id": 413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278929786, "dur": 47,
    "args": {
       "External id": 412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278929914, "dur": 2,
    "args": {
       "External id": 415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278929874, "dur": 44,
    "args": {
       "External id": 414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929974,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736200906112, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929986,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": 512, "Total Allocated": 683805696, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278929993,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736200906112, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 38976, "tid": 38976,
    "ts": 1638154278929972, "dur": 46,
    "args": {
       "External id": 416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278930156, "dur": 2,
    "args": {
       "External id": 419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278930115, "dur": 46,
    "args": {
       "External id": 418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278930243, "dur": 2,
    "args": {
       "External id": 421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278930203, "dur": 44,
    "args": {
       "External id": 420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278930374,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749242568704, "Bytes": 3538944, "Total Allocated": 687344640, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278930369, "dur": 14,
    "args": {
       "External id": 424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278930329, "dur": 59,
    "args": {
       "External id": 423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278930428, "dur": 30,
    "args": {
       "External id": 425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278930287, "dur": 174,
    "args": {
       "External id": 422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278930592, "dur": 2,
    "args": {
       "External id": 428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278930552, "dur": 44,
    "args": {
       "External id": 427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 38976, "tid": 38976,
    "ts": 1638154278930508, "dur": 122,
    "args": {
       "External id": 426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 38976, "tid": 38976,
    "ts": 1638154278930073, "dur": 560,
    "args": {
       "External id": 417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278930638,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": -512, "Total Allocated": 687344128, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278930644,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -3538944, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278930754,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 3538944, "Total Allocated": 687344128, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278930749, "dur": 31,
    "args": {
       "External id": 430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278930704, "dur": 79,
    "args": {
       "External id": 429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278930787,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749242568704, "Bytes": -3538944, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278931011,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749242568704, "Bytes": 3538944, "Total Allocated": 687344128, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278931001, "dur": 16,
    "args": {
       "External id": 434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278930956, "dur": 64,
    "args": {
       "External id": 433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278931119,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": 884736, "Total Allocated": 688228864, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278931112, "dur": 13,
    "args": {
       "External id": 436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278931068, "dur": 60,
    "args": {
       "External id": 435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278930906, "dur": 248,
    "args": {
       "External id": 432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278931157,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": -884736, "Total Allocated": 687344128, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278930861, "dur": 301,
    "args": {
       "External id": 431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278931167,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -3538944, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278931308, "dur": 2,
    "args": {
       "External id": 439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278931267, "dur": 47,
    "args": {
       "External id": 438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 38976, "tid": 38976,
    "ts": 1638154278931396, "dur": 4,
    "args": {
       "External id": 441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278931355, "dur": 47,
    "args": {
       "External id": 440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278931483, "dur": 2,
    "args": {
       "External id": 443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278931444, "dur": 44,
    "args": {
       "External id": 442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278931663,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278931657, "dur": 12,
    "args": {
       "External id": 447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278931617, "dur": 55,
    "args": {
       "External id": 446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278931715, "dur": 28,
    "args": {
       "External id": 448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278931568, "dur": 177,
    "args": {
       "External id": 445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278931830, "dur": 2,
    "args": {
       "External id": 450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278931790, "dur": 44,
    "args": {
       "External id": 449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278931529, "dur": 307,
    "args": {
       "External id": 444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278931923,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278931919, "dur": 11,
    "args": {
       "External id": 452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278931876, "dur": 79,
    "args": {
       "External id": 451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278932039, "dur": 2,
    "args": {
       "External id": 454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278931999, "dur": 44,
    "args": {
       "External id": 453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278932047,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278931221, "dur": 831,
    "args": {
       "External id": 437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278932139, "dur": 1,
    "args": {
       "External id": 456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278932098, "dur": 45,
    "args": {
       "External id": 455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278932316,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278932312, "dur": 10,
    "args": {
       "External id": 460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278932272, "dur": 55,
    "args": {
       "External id": 459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278932366, "dur": 24,
    "args": {
       "External id": 461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278932232, "dur": 161,
    "args": {
       "External id": 458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 38976, "tid": 38976,
    "ts": 1638154278932194, "dur": 201,
    "args": {
       "External id": 457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278932442, "dur": 4,
    "args": {
       "External id": 462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278932611,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278932811, "dur": 2,
    "args": {
       "External id": 466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278932768, "dur": 48,
    "args": {
       "External id": 465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278932725, "dur": 94,
    "args": {
       "External id": 464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278932906, "dur": 2,
    "args": {
       "External id": 468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278932966,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278932958, "dur": 76,
    "args": {
       "External id": 469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278933128, "dur": 2,
    "args": {
       "External id": 471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278933085, "dur": 47,
    "args": {
       "External id": 470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278932862, "dur": 273,
    "args": {
       "External id": 467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278933180, "dur": 29,
    "args": {
       "External id": 472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278932682, "dur": 529,
    "args": {
       "External id": 463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933419,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278933408, "dur": 18,
    "args": {
       "External id": 476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278933365, "dur": 64,
    "args": {
       "External id": 475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933523,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749246107648, "Bytes": 4718592, "Total Allocated": 745146880, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278933515, "dur": 14,
    "args": {
       "External id": 478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278933473, "dur": 58,
    "args": {
       "External id": 477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278933318, "dur": 238,
    "args": {
       "External id": 474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933570,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749246107648, "Bytes": -4718592, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278933276, "dur": 298,
    "args": {
       "External id": 473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933579,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933585,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933590,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933595,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": -18874368, "Total Allocated": 664930816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933600,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": -18874368, "Total Allocated": 646056448, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933615,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749242568704, "Bytes": -3538944, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933671,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 38976, "tid": 38976,
    "ts": 1638154278933663, "dur": 32,
    "args": {
       "External id": 479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933702,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933857,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": 18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278933853, "dur": 10,
    "args": {
       "External id": 482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933909,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 661404160, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278933905, "dur": 9,
    "args": {
       "External id": 483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278933962,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 661416448, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278933959, "dur": 9,
    "args": {
       "External id": 484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278934039, "dur": 2,
    "args": {
       "External id": 485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278934082, "dur": 2,
    "args": {
       "External id": 486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278933809, "dur": 279,
    "args": {
       "External id": 481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278934091,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 661404160, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278934096,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278933768, "dur": 332,
    "args": {
       "External id": 480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278934302, "dur": 2,
    "args": {
       "External id": 490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278934257, "dur": 49,
    "args": {
       "External id": 489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278934211, "dur": 99,
    "args": {
       "External id": 488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278934404, "dur": 3,
    "args": {
       "External id": 492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278934462,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": 75497472, "Total Allocated": 736889344, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278934455, "dur": 47,
    "args": {
       "External id": 493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278934609, "dur": 2,
    "args": {
       "External id": 495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278934556, "dur": 57,
    "args": {
       "External id": 494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278934358, "dur": 258,
    "args": {
       "External id": 491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278934664, "dur": 26,
    "args": {
       "External id": 496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278934166, "dur": 526,
    "args": {
       "External id": 487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278934762,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": 75497472, "Total Allocated": 812386816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 38976, "tid": 38976,
    "ts": 1638154278934755, "dur": 33,
    "args": {
       "External id": 497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278934793,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": -75497472, "Total Allocated": 736889344, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278934984, "dur": 2,
    "args": {
       "External id": 501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278934939, "dur": 49,
    "args": {
       "External id": 500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278934894, "dur": 97,
    "args": {
       "External id": 499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278935082, "dur": 2,
    "args": {
       "External id": 503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935140,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": 18874368, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278935134, "dur": 58,
    "args": {
       "External id": 504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278935293, "dur": 2,
    "args": {
       "External id": 506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278935248, "dur": 49,
    "args": {
       "External id": 505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278935037, "dur": 263,
    "args": {
       "External id": 502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278935347, "dur": 24,
    "args": {
       "External id": 507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278934850, "dur": 523,
    "args": {
       "External id": 498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935380,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": -75497472, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935598,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278935588, "dur": 23,
    "args": {
       "External id": 511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278935539, "dur": 75,
    "args": {
       "External id": 510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935713,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 4718592, "Total Allocated": 703859200, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278935706, "dur": 13,
    "args": {
       "External id": 513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278935661, "dur": 61,
    "args": {
       "External id": 512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278935490, "dur": 257,
    "args": {
       "External id": 509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935751,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -4718592, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278935448, "dur": 320,
    "args": {
       "External id": 508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935773,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": -18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935779,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935783,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": -18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935787,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": -18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278935950,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": 18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278935946, "dur": 11,
    "args": {
       "External id": 516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278936005,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 642529792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278936001, "dur": 9,
    "args": {
       "External id": 517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278936057,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 642542080, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278936054, "dur": 9,
    "args": {
       "External id": 518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278936140, "dur": 2,
    "args": {
       "External id": 519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278936186, "dur": 1,
    "args": {
       "External id": 520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278935898, "dur": 294,
    "args": {
       "External id": 515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278936197,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 642529792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278936202,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278935856, "dur": 349,
    "args": {
       "External id": 514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278936406, "dur": 2,
    "args": {
       "External id": 524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278936362, "dur": 48,
    "args": {
       "External id": 523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278936317, "dur": 97,
    "args": {
       "External id": 522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278936506, "dur": 3,
    "args": {
       "External id": 526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278936564,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278936558, "dur": 73,
    "args": {
       "External id": 527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278936730, "dur": 2,
    "args": {
       "External id": 529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278936684, "dur": 50,
    "args": {
       "External id": 528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278936459, "dur": 278,
    "args": {
       "External id": 525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278936782, "dur": 26,
    "args": {
       "External id": 530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278936272, "dur": 539,
    "args": {
       "External id": 521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278936860, "dur": 4,
    "args": {
       "External id": 531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278936952, "dur": 2,
    "args": {
       "External id": 533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278936911, "dur": 46,
    "args": {
       "External id": 532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278937151, "dur": 1,
    "args": {
       "External id": 537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278937106, "dur": 48,
    "args": {
       "External id": 536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278937061, "dur": 96,
    "args": {
       "External id": 535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278937247, "dur": 3,
    "args": {
       "External id": 539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278937304,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278937298, "dur": 61,
    "args": {
       "External id": 540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278937455, "dur": 2,
    "args": {
       "External id": 542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278937411, "dur": 48,
    "args": {
       "External id": 541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278937203, "dur": 259,
    "args": {
       "External id": 538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278937517, "dur": 24,
    "args": {
       "External id": 543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278937017, "dur": 527,
    "args": {
       "External id": 534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278937590, "dur": 3,
    "args": {
       "External id": 544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278937689, "dur": 1,
    "args": {
       "External id": 546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278937647, "dur": 47,
    "args": {
       "External id": 545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278937885, "dur": 1,
    "args": {
       "External id": 550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278937840, "dur": 48,
    "args": {
       "External id": 549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278937795, "dur": 96,
    "args": {
       "External id": 548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278937982, "dur": 2,
    "args": {
       "External id": 552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278938039,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": 18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278938032, "dur": 60,
    "args": {
       "External id": 553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278938193, "dur": 1,
    "args": {
       "External id": 555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278938148, "dur": 49,
    "args": {
       "External id": 554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278937937, "dur": 263,
    "args": {
       "External id": 551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278938246, "dur": 25,
    "args": {
       "External id": 556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278937751, "dur": 523,
    "args": {
       "External id": 547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278938324, "dur": 3,
    "args": {
       "External id": 557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278938415, "dur": 1,
    "args": {
       "External id": 559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278938373, "dur": 49,
    "args": {
       "External id": 558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278938504, "dur": 1,
    "args": {
       "External id": 561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278938463, "dur": 45,
    "args": {
       "External id": 560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278938644, "dur": 1,
    "args": {
       "External id": 564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278938594, "dur": 54,
    "args": {
       "External id": 563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278938815,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278938809, "dur": 17,
    "args": {
       "External id": 568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278938771, "dur": 58,
    "args": {
       "External id": 567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278938869, "dur": 28,
    "args": {
       "External id": 569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278938730, "dur": 172,
    "args": {
       "External id": 566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278938983, "dur": 1,
    "args": {
       "External id": 571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278938943, "dur": 44,
    "args": {
       "External id": 570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278938690, "dur": 299,
    "args": {
       "External id": 565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278939074, "dur": 2,
    "args": {
       "External id": 573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278939034, "dur": 45,
    "args": {
       "External id": 572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939249,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 736889344, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278939244, "dur": 14,
    "args": {
       "External id": 577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278939207, "dur": 54,
    "args": {
       "External id": 576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278939301, "dur": 22,
    "args": {
       "External id": 578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278939167, "dur": 161,
    "args": {
       "External id": 575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278939407, "dur": 2,
    "args": {
       "External id": 580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278939368, "dur": 43,
    "args": {
       "External id": 579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278939126, "dur": 287,
    "args": {
       "External id": 574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939502,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 3538944, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278939498, "dur": 10,
    "args": {
       "External id": 582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278939455, "dur": 78,
    "args": {
       "External id": 581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278939623, "dur": 1,
    "args": {
       "External id": 584,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278939576, "dur": 51,
    "args": {
       "External id": 583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939632,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939637,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278938552, "dur": 1089,
    "args": {
       "External id": 562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939654,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736201754624, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939715,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745306214400, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 38976, "tid": 38976,
    "ts": 1638154278939705, "dur": 36,
    "args": {
       "External id": 585,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939746,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736201754624, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939752,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278939852, "dur": 2,
    "args": {
       "External id": 587,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278939810, "dur": 47,
    "args": {
       "External id": 586,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278939940, "dur": 1,
    "args": {
       "External id": 589,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278939899, "dur": 45,
    "args": {
       "External id": 588,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278939994,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736201771904, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940006,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": 512, "Total Allocated": 702680064, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940016,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736201771904, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 38976, "tid": 38976,
    "ts": 1638154278939990, "dur": 50,
    "args": {
       "External id": 590,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278940179, "dur": 3,
    "args": {
       "External id": 593,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278940140, "dur": 45,
    "args": {
       "External id": 592,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278940265, "dur": 1,
    "args": {
       "External id": 595,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278940225, "dur": 44,
    "args": {
       "External id": 594,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940397,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745309753344, "Bytes": 3538944, "Total Allocated": 706219008, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278940392, "dur": 11,
    "args": {
       "External id": 598,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278940351, "dur": 55,
    "args": {
       "External id": 597,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278940450, "dur": 31,
    "args": {
       "External id": 599,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278940310, "dur": 173,
    "args": {
       "External id": 596,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278940620, "dur": 2,
    "args": {
       "External id": 602,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278940570, "dur": 54,
    "args": {
       "External id": 601,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 38976, "tid": 38976,
    "ts": 1638154278940527, "dur": 123,
    "args": {
       "External id": 600,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 38976, "tid": 38976,
    "ts": 1638154278940098, "dur": 558,
    "args": {
       "External id": 591,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940661,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": -512, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940667,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745306214400, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940766,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745313292288, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278940760, "dur": 40,
    "args": {
       "External id": 604,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278940720, "dur": 82,
    "args": {
       "External id": 603,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278940807,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745309753344, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278941029,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745316831232, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278941019, "dur": 16,
    "args": {
       "External id": 608,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278940973, "dur": 65,
    "args": {
       "External id": 607,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278941138,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": 884736, "Total Allocated": 707103232, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278941130, "dur": 14,
    "args": {
       "External id": 610,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278941085, "dur": 61,
    "args": {
       "External id": 609,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278940924, "dur": 247,
    "args": {
       "External id": 606,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278941177,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": -884736, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278940878, "dur": 304,
    "args": {
       "External id": 605,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278941187,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745313292288, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278941318, "dur": 1,
    "args": {
       "External id": 613,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278941279, "dur": 46,
    "args": {
       "External id": 612,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 38976, "tid": 38976,
    "ts": 1638154278941405, "dur": 4,
    "args": {
       "External id": 615,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278941365, "dur": 46,
    "args": {
       "External id": 614,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278941493, "dur": 1,
    "args": {
       "External id": 617,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278941453, "dur": 44,
    "args": {
       "External id": 616,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278941671,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278941666, "dur": 14,
    "args": {
       "External id": 621,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278941628, "dur": 55,
    "args": {
       "External id": 620,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278941723, "dur": 28,
    "args": {
       "External id": 622,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278941578, "dur": 178,
    "args": {
       "External id": 619,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278941857, "dur": 2,
    "args": {
       "External id": 624,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278941799, "dur": 62,
    "args": {
       "External id": 623,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278941539, "dur": 324,
    "args": {
       "External id": 618,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278942059,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278942054, "dur": 12,
    "args": {
       "External id": 626,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278941987, "dur": 105,
    "args": {
       "External id": 625,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278942232, "dur": 2,
    "args": {
       "External id": 628,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278942137, "dur": 99,
    "args": {
       "External id": 627,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278942240,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278941237, "dur": 1008,
    "args": {
       "External id": 611,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278942356, "dur": 1,
    "args": {
       "External id": 630,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278942300, "dur": 61,
    "args": {
       "External id": 629,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278942571,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278942567, "dur": 11,
    "args": {
       "External id": 634,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278942506, "dur": 75,
    "args": {
       "External id": 633,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278942708, "dur": 27,
    "args": {
       "External id": 635,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278942465, "dur": 272,
    "args": {
       "External id": 632,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 38976, "tid": 38976,
    "ts": 1638154278942411, "dur": 328,
    "args": {
       "External id": 631,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278942799, "dur": 3,
    "args": {
       "External id": 636,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278942830,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278943123, "dur": 2,
    "args": {
       "External id": 640,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278943045, "dur": 82,
    "args": {
       "External id": 639,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278942981, "dur": 149,
    "args": {
       "External id": 638,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278943246, "dur": 3,
    "args": {
       "External id": 642,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943309,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278943302, "dur": 87,
    "args": {
       "External id": 643,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278943503, "dur": 2,
    "args": {
       "External id": 645,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278943457, "dur": 51,
    "args": {
       "External id": 644,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278943201, "dur": 310,
    "args": {
       "External id": 641,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278943561, "dur": 28,
    "args": {
       "External id": 646,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278942923, "dur": 668,
    "args": {
       "External id": 637,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943817,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": 18874368, "Total Allocated": 759302656, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278943807, "dur": 18,
    "args": {
       "External id": 650,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278943759, "dur": 69,
    "args": {
       "External id": 649,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943930,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 4718592, "Total Allocated": 764021248, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278943922, "dur": 14,
    "args": {
       "External id": 652,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278943877, "dur": 61,
    "args": {
       "External id": 651,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278943710, "dur": 254,
    "args": {
       "External id": 648,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943967,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -4718592, "Total Allocated": 759302656, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278943664, "dur": 307,
    "args": {
       "External id": 647,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943977,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943983,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943988,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278943995,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": -18874368, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944000,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": -18874368, "Total Allocated": 664930816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944005,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745316831232, "Bytes": -3538944, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944064,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745369784320, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 38976, "tid": 38976,
    "ts": 1638154278944056, "dur": 32,
    "args": {
       "External id": 653,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944094,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944257,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278944252, "dur": 11,
    "args": {
       "External id": 656,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944311,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 680278528, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278944308, "dur": 9,
    "args": {
       "External id": 657,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944364,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 680290816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278944360, "dur": 9,
    "args": {
       "External id": 658,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278944442, "dur": 3,
    "args": {
       "External id": 659,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278944493, "dur": 1,
    "args": {
       "External id": 660,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278944206, "dur": 296,
    "args": {
       "External id": 655,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944505,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 680278528, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944509,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278944163, "dur": 350,
    "args": {
       "External id": 654,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278944729, "dur": 2,
    "args": {
       "External id": 664,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278944684, "dur": 49,
    "args": {
       "External id": 663,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278944637, "dur": 100,
    "args": {
       "External id": 662,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278944826, "dur": 3,
    "args": {
       "External id": 666,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278944884,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": 75497472, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278944877, "dur": 50,
    "args": {
       "External id": 667,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278945024, "dur": 2,
    "args": {
       "External id": 669,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278944979, "dur": 49,
    "args": {
       "External id": 668,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278944783, "dur": 248,
    "args": {
       "External id": 665,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278945075, "dur": 26,
    "args": {
       "External id": 670,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278944578, "dur": 525,
    "args": {
       "External id": 661,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278945171,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": 75497472, "Total Allocated": 831261184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 38976, "tid": 38976,
    "ts": 1638154278945164, "dur": 31,
    "args": {
       "External id": 671,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278945201,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": -75497472, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278945393, "dur": 2,
    "args": {
       "External id": 675,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278945348, "dur": 51,
    "args": {
       "External id": 674,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278945303, "dur": 99,
    "args": {
       "External id": 673,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278945492, "dur": 3,
    "args": {
       "External id": 677,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278945549,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 774638080, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278945543, "dur": 64,
    "args": {
       "External id": 678,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278945705, "dur": 2,
    "args": {
       "External id": 680,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278945660, "dur": 49,
    "args": {
       "External id": 679,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278945446, "dur": 266,
    "args": {
       "External id": 676,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278945759, "dur": 24,
    "args": {
       "External id": 681,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278945258, "dur": 528,
    "args": {
       "External id": 672,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278945795,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": -75497472, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946013,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278946003, "dur": 16,
    "args": {
       "External id": 685,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278945957, "dur": 65,
    "args": {
       "External id": 684,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946121,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": 4718592, "Total Allocated": 722733568, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278946113, "dur": 14,
    "args": {
       "External id": 687,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278946069, "dur": 63,
    "args": {
       "External id": 686,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278945908, "dur": 249,
    "args": {
       "External id": 683,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946160,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": -4718592, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278945862, "dur": 302,
    "args": {
       "External id": 682,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946169,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946175,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745369784320, "Bytes": -18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946180,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946184,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": -18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946191,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946352,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": 18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278946347, "dur": 11,
    "args": {
       "External id": 690,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946413,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 642529792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278946409, "dur": 10,
    "args": {
       "External id": 691,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946466,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 642542080, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278946462, "dur": 11,
    "args": {
       "External id": 692,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278946552, "dur": 2,
    "args": {
       "External id": 693,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278946596, "dur": 1,
    "args": {
       "External id": 694,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278946301, "dur": 312,
    "args": {
       "External id": 689,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946616,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 642529792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946620,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278946260, "dur": 364,
    "args": {
       "External id": 688,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278946824, "dur": 1,
    "args": {
       "External id": 698,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278946779, "dur": 51,
    "args": {
       "External id": 697,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278946734, "dur": 100,
    "args": {
       "External id": 696,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278946925, "dur": 3,
    "args": {
       "External id": 700,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278946982,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278946976, "dur": 65,
    "args": {
       "External id": 701,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278947140, "dur": 2,
    "args": {
       "External id": 703,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278947096, "dur": 48,
    "args": {
       "External id": 702,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278946880, "dur": 268,
    "args": {
       "External id": 699,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278947195, "dur": 26,
    "args": {
       "External id": 704,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278946689, "dur": 535,
    "args": {
       "External id": 695,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278947274, "dur": 4,
    "args": {
       "External id": 705,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278947365, "dur": 2,
    "args": {
       "External id": 707,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278947323, "dur": 47,
    "args": {
       "External id": 706,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278947564, "dur": 1,
    "args": {
       "External id": 711,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278947518, "dur": 51,
    "args": {
       "External id": 710,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278947474, "dur": 98,
    "args": {
       "External id": 709,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278947668, "dur": 2,
    "args": {
       "External id": 713,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278947726,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278947719, "dur": 64,
    "args": {
       "External id": 714,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278947881, "dur": 2,
    "args": {
       "External id": 716,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278947837, "dur": 48,
    "args": {
       "External id": 715,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278947623, "dur": 265,
    "args": {
       "External id": 712,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278947933, "dur": 24,
    "args": {
       "External id": 717,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278947429, "dur": 530,
    "args": {
       "External id": 708,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278948008, "dur": 3,
    "args": {
       "External id": 718,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278948097, "dur": 1,
    "args": {
       "External id": 720,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278948055, "dur": 47,
    "args": {
       "External id": 719,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278948300, "dur": 1,
    "args": {
       "External id": 724,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278948255, "dur": 48,
    "args": {
       "External id": 723,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278948211, "dur": 97,
    "args": {
       "External id": 722,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278948398, "dur": 2,
    "args": {
       "External id": 726,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278948454,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278948448, "dur": 58,
    "args": {
       "External id": 727,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278948627, "dur": 2,
    "args": {
       "External id": 729,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278948562, "dur": 70,
    "args": {
       "External id": 728,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278948354, "dur": 281,
    "args": {
       "External id": 725,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278948681, "dur": 26,
    "args": {
       "External id": 730,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278948167, "dur": 542,
    "args": {
       "External id": 721,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278948758, "dur": 3,
    "args": {
       "External id": 731,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278948847, "dur": 1,
    "args": {
       "External id": 733,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278948805, "dur": 47,
    "args": {
       "External id": 732,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278948936, "dur": 2,
    "args": {
       "External id": 735,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278948896, "dur": 44,
    "args": {
       "External id": 734,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278949068, "dur": 2,
    "args": {
       "External id": 738,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278949028, "dur": 45,
    "args": {
       "External id": 737,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278949238,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278949232, "dur": 15,
    "args": {
       "External id": 742,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278949192, "dur": 57,
    "args": {
       "External id": 741,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278949292, "dur": 28,
    "args": {
       "External id": 743,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278949152, "dur": 170,
    "args": {
       "External id": 740,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278949407, "dur": 2,
    "args": {
       "External id": 745,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278949367, "dur": 44,
    "args": {
       "External id": 744,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278949112, "dur": 301,
    "args": {
       "External id": 739,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278949495, "dur": 1,
    "args": {
       "External id": 747,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278949454, "dur": 46,
    "args": {
       "External id": 746,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278949669,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 736889344, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278949664, "dur": 12,
    "args": {
       "External id": 751,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278949624, "dur": 56,
    "args": {
       "External id": 750,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278949729, "dur": 23,
    "args": {
       "External id": 752,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278949578, "dur": 177,
    "args": {
       "External id": 749,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278949836, "dur": 2,
    "args": {
       "External id": 754,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278949797, "dur": 43,
    "args": {
       "External id": 753,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278949538, "dur": 304,
    "args": {
       "External id": 748,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278949931,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 3538944, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278949927, "dur": 11,
    "args": {
       "External id": 756,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278949884, "dur": 78,
    "args": {
       "External id": 755,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278950043, "dur": 2,
    "args": {
       "External id": 758,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278950005, "dur": 45,
    "args": {
       "External id": 757,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950054,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950059,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278948986, "dur": 1076,
    "args": {
       "External id": 736,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950079,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736202429184, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950137,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745306214400, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 38976, "tid": 38976,
    "ts": 1638154278950128, "dur": 35,
    "args": {
       "External id": 759,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950168,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736202429184, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950174,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278950273, "dur": 2,
    "args": {
       "External id": 761,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278950232, "dur": 46,
    "args": {
       "External id": 760,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278950357, "dur": 1,
    "args": {
       "External id": 763,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278950318, "dur": 43,
    "args": {
       "External id": 762,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950412,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736202451648, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950423,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": 512, "Total Allocated": 702680064, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950430,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736202451648, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 38976, "tid": 38976,
    "ts": 1638154278950409, "dur": 45,
    "args": {
       "External id": 764,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278950592, "dur": 1,
    "args": {
       "External id": 767,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278950550, "dur": 46,
    "args": {
       "External id": 766,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278950689, "dur": 1,
    "args": {
       "External id": 769,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278950648, "dur": 45,
    "args": {
       "External id": 768,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278950821,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745309753344, "Bytes": 3538944, "Total Allocated": 706219008, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278950816, "dur": 12,
    "args": {
       "External id": 772,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278950776, "dur": 55,
    "args": {
       "External id": 771,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278950873, "dur": 30,
    "args": {
       "External id": 773,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278950734, "dur": 172,
    "args": {
       "External id": 770,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278951033, "dur": 1,
    "args": {
       "External id": 776,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278950993, "dur": 43,
    "args": {
       "External id": 775,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 38976, "tid": 38976,
    "ts": 1638154278950952, "dur": 110,
    "args": {
       "External id": 774,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 38976, "tid": 38976,
    "ts": 1638154278950509, "dur": 555,
    "args": {
       "External id": 765,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951070,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": -512, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951076,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745306214400, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951175,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745313292288, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278951170, "dur": 32,
    "args": {
       "External id": 778,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278951128, "dur": 77,
    "args": {
       "External id": 777,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951209,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745309753344, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951437,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745316831232, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278951427, "dur": 17,
    "args": {
       "External id": 782,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278951375, "dur": 74,
    "args": {
       "External id": 781,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951550,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": 884736, "Total Allocated": 707103232, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278951543, "dur": 13,
    "args": {
       "External id": 784,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278951496, "dur": 63,
    "args": {
       "External id": 783,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278951326, "dur": 259,
    "args": {
       "External id": 780,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951588,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": -884736, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278951281, "dur": 311,
    "args": {
       "External id": 779,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278951598,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745313292288, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278951733, "dur": 2,
    "args": {
       "External id": 787,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278951692, "dur": 49,
    "args": {
       "External id": 786,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 38976, "tid": 38976,
    "ts": 1638154278951823, "dur": 4,
    "args": {
       "External id": 789,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278951783, "dur": 46,
    "args": {
       "External id": 788,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278951911, "dur": 1,
    "args": {
       "External id": 791,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278951870, "dur": 45,
    "args": {
       "External id": 790,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278952078,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278952073, "dur": 12,
    "args": {
       "External id": 795,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278952034, "dur": 53,
    "args": {
       "External id": 794,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278952129, "dur": 28,
    "args": {
       "External id": 796,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278951993, "dur": 167,
    "args": {
       "External id": 793,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278952243, "dur": 2,
    "args": {
       "External id": 798,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278952202, "dur": 45,
    "args": {
       "External id": 797,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278951954, "dur": 295,
    "args": {
       "External id": 792,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278952345,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278952341, "dur": 13,
    "args": {
       "External id": 800,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278952293, "dur": 86,
    "args": {
       "External id": 799,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278952460, "dur": 2,
    "args": {
       "External id": 802,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278952422, "dur": 44,
    "args": {
       "External id": 801,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278952470,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278951650, "dur": 824,
    "args": {
       "External id": 785,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278952559, "dur": 1,
    "args": {
       "External id": 804,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278952518, "dur": 45,
    "args": {
       "External id": 803,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278952742,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278952738, "dur": 10,
    "args": {
       "External id": 808,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278952698, "dur": 52,
    "args": {
       "External id": 807,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278952793, "dur": 24,
    "args": {
       "External id": 809,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278952657, "dur": 163,
    "args": {
       "External id": 806,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 38976, "tid": 38976,
    "ts": 1638154278952615, "dur": 207,
    "args": {
       "External id": 805,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278952872, "dur": 4,
    "args": {
       "External id": 810,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278952880,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278953089, "dur": 2,
    "args": {
       "External id": 814,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278953043, "dur": 50,
    "args": {
       "External id": 813,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278952999, "dur": 97,
    "args": {
       "External id": 812,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278953184, "dur": 2,
    "args": {
       "External id": 816,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953242,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278953235, "dur": 67,
    "args": {
       "External id": 817,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278953399, "dur": 2,
    "args": {
       "External id": 819,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278953355, "dur": 50,
    "args": {
       "External id": 818,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278953139, "dur": 269,
    "args": {
       "External id": 815,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278953453, "dur": 26,
    "args": {
       "External id": 820,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278952946, "dur": 536,
    "args": {
       "External id": 811,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953705,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": 18874368, "Total Allocated": 759302656, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278953695, "dur": 18,
    "args": {
       "External id": 824,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278953650, "dur": 68,
    "args": {
       "External id": 823,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953816,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 4718592, "Total Allocated": 764021248, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278953809, "dur": 13,
    "args": {
       "External id": 826,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278953763, "dur": 64,
    "args": {
       "External id": 825,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278953592, "dur": 261,
    "args": {
       "External id": 822,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953856,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -4718592, "Total Allocated": 759302656, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278953547, "dur": 313,
    "args": {
       "External id": 821,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953865,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953871,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953877,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953882,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": -18874368, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953886,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -18874368, "Total Allocated": 664930816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953891,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745316831232, "Bytes": -3538944, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953946,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745369784320, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 38976, "tid": 38976,
    "ts": 1638154278953939, "dur": 31,
    "args": {
       "External id": 827,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278953976,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278954136,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278954132, "dur": 10,
    "args": {
       "External id": 830,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278954190,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 680278528, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278954186, "dur": 10,
    "args": {
       "External id": 831,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278954243,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 680290816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278954240, "dur": 8,
    "args": {
       "External id": 832,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278954321, "dur": 2,
    "args": {
       "External id": 833,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278954708, "dur": 2,
    "args": {
       "External id": 834,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278954086, "dur": 635,
    "args": {
       "External id": 829,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278954724,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 680278528, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278954730,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278954043, "dur": 691,
    "args": {
       "External id": 828,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278954933, "dur": 2,
    "args": {
       "External id": 838,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278954890, "dur": 47,
    "args": {
       "External id": 837,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278954847, "dur": 94,
    "args": {
       "External id": 836,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278955028, "dur": 3,
    "args": {
       "External id": 840,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278955086,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": 75497472, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278955078, "dur": 55,
    "args": {
       "External id": 841,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278955225, "dur": 2,
    "args": {
       "External id": 843,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278955183, "dur": 46,
    "args": {
       "External id": 842,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278954985, "dur": 248,
    "args": {
       "External id": 839,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278955277, "dur": 27,
    "args": {
       "External id": 844,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278954805, "dur": 505,
    "args": {
       "External id": 835,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278955373,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": 75497472, "Total Allocated": 831261184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 38976, "tid": 38976,
    "ts": 1638154278955366, "dur": 32,
    "args": {
       "External id": 845,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278955403,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": -75497472, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278955585, "dur": 2,
    "args": {
       "External id": 849,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278955542, "dur": 47,
    "args": {
       "External id": 848,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278955500, "dur": 92,
    "args": {
       "External id": 847,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278955686, "dur": 3,
    "args": {
       "External id": 851,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278955741,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 774638080, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278955735, "dur": 57,
    "args": {
       "External id": 852,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278955885, "dur": 2,
    "args": {
       "External id": 854,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278955843, "dur": 46,
    "args": {
       "External id": 853,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278955643, "dur": 249,
    "args": {
       "External id": 850,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278955937, "dur": 24,
    "args": {
       "External id": 855,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278955458, "dur": 505,
    "args": {
       "External id": 846,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278955972,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": -75497472, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956182,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278956173, "dur": 16,
    "args": {
       "External id": 859,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278956129, "dur": 63,
    "args": {
       "External id": 858,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956287,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 4718592, "Total Allocated": 722733568, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278956279, "dur": 14,
    "args": {
       "External id": 861,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278956237, "dur": 58,
    "args": {
       "External id": 860,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278956082, "dur": 238,
    "args": {
       "External id": 857,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956323,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -4718592, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278956038, "dur": 289,
    "args": {
       "External id": 856,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956332,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956338,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745369784320, "Bytes": -18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956342,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956346,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": -18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956356,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": -18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956511,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": 18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278956506, "dur": 11,
    "args": {
       "External id": 864,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956563,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 642529792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278956560, "dur": 9,
    "args": {
       "External id": 865,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956621,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 642542080, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278956617, "dur": 10,
    "args": {
       "External id": 866,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278956698, "dur": 2,
    "args": {
       "External id": 867,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278956742, "dur": 1,
    "args": {
       "External id": 868,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278956463, "dur": 285,
    "args": {
       "External id": 863,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956751,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 642529792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278956756,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278956423, "dur": 336,
    "args": {
       "External id": 862,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278956952, "dur": 2,
    "args": {
       "External id": 872,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278956909, "dur": 50,
    "args": {
       "External id": 871,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278956866, "dur": 97,
    "args": {
       "External id": 870,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957050, "dur": 3,
    "args": {
       "External id": 874,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278957105,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278957099, "dur": 64,
    "args": {
       "External id": 875,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957255, "dur": 1,
    "args": {
       "External id": 877,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957213, "dur": 46,
    "args": {
       "External id": 876,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278957007, "dur": 255,
    "args": {
       "External id": 873,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278957306, "dur": 26,
    "args": {
       "External id": 878,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278956824, "dur": 511,
    "args": {
       "External id": 869,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957382, "dur": 4,
    "args": {
       "External id": 879,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278957468, "dur": 2,
    "args": {
       "External id": 881,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278957428, "dur": 45,
    "args": {
       "External id": 880,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278957673, "dur": 1,
    "args": {
       "External id": 885,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278957628, "dur": 51,
    "args": {
       "External id": 884,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278957575, "dur": 107,
    "args": {
       "External id": 883,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957770, "dur": 2,
    "args": {
       "External id": 887,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278957827,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278957821, "dur": 63,
    "args": {
       "External id": 888,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957982, "dur": 1,
    "args": {
       "External id": 890,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278957937, "dur": 49,
    "args": {
       "External id": 889,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278957728, "dur": 261,
    "args": {
       "External id": 886,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278958033, "dur": 25,
    "args": {
       "External id": 891,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278957529, "dur": 534,
    "args": {
       "External id": 882,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278958109, "dur": 4,
    "args": {
       "External id": 892,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278958198, "dur": 2,
    "args": {
       "External id": 894,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278958156, "dur": 47,
    "args": {
       "External id": 893,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278958394, "dur": 2,
    "args": {
       "External id": 898,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278958350, "dur": 48,
    "args": {
       "External id": 897,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278958305, "dur": 98,
    "args": {
       "External id": 896,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278958492, "dur": 2,
    "args": {
       "External id": 900,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278958548,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278958542, "dur": 64,
    "args": {
       "External id": 901,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278958706, "dur": 2,
    "args": {
       "External id": 903,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278958661, "dur": 49,
    "args": {
       "External id": 902,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278958448, "dur": 265,
    "args": {
       "External id": 899,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278958759, "dur": 24,
    "args": {
       "External id": 904,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278958262, "dur": 524,
    "args": {
       "External id": 895,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278958832, "dur": 4,
    "args": {
       "External id": 905,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278958931, "dur": 1,
    "args": {
       "External id": 907,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278958879, "dur": 56,
    "args": {
       "External id": 906,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278959020, "dur": 2,
    "args": {
       "External id": 909,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278958979, "dur": 45,
    "args": {
       "External id": 908,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278959152, "dur": 2,
    "args": {
       "External id": 912,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278959112, "dur": 45,
    "args": {
       "External id": 911,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278959322,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278959316, "dur": 14,
    "args": {
       "External id": 916,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278959277, "dur": 56,
    "args": {
       "External id": 915,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278959375, "dur": 28,
    "args": {
       "External id": 917,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278959236, "dur": 170,
    "args": {
       "External id": 914,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278959492, "dur": 2,
    "args": {
       "External id": 919,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278959452, "dur": 44,
    "args": {
       "External id": 918,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278959196, "dur": 302,
    "args": {
       "External id": 913,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278959580, "dur": 1,
    "args": {
       "External id": 921,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278959539, "dur": 45,
    "args": {
       "External id": 920,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278959756,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 736889344, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278959751, "dur": 12,
    "args": {
       "External id": 925,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278959711, "dur": 57,
    "args": {
       "External id": 924,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278959810, "dur": 24,
    "args": {
       "External id": 926,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278959670, "dur": 166,
    "args": {
       "External id": 923,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278959918, "dur": 1,
    "args": {
       "External id": 928,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278959878, "dur": 43,
    "args": {
       "External id": 927,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278959630, "dur": 293,
    "args": {
       "External id": 922,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960012,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 3538944, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278960008, "dur": 11,
    "args": {
       "External id": 930,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278959965, "dur": 78,
    "args": {
       "External id": 929,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278960124, "dur": 2,
    "args": {
       "External id": 932,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278960087, "dur": 44,
    "args": {
       "External id": 931,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960134,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960139,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278959070, "dur": 1073,
    "args": {
       "External id": 910,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960158,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736203494208, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960216,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745306214400, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 38976, "tid": 38976,
    "ts": 1638154278960207, "dur": 34,
    "args": {
       "External id": 933,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960247,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736203494208, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960253,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278960352, "dur": 2,
    "args": {
       "External id": 935,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278960310, "dur": 47,
    "args": {
       "External id": 934,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278960438, "dur": 1,
    "args": {
       "External id": 937,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 38976, "tid": 38976,
    "ts": 1638154278960397, "dur": 45,
    "args": {
       "External id": 936,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960497,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736203516608, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960508,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": 512, "Total Allocated": 702680064, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960515,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94736203516608, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 38976, "tid": 38976,
    "ts": 1638154278960494, "dur": 44,
    "args": {
       "External id": 938,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278960679, "dur": 1,
    "args": {
       "External id": 941,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278960637, "dur": 49,
    "args": {
       "External id": 940,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278960767, "dur": 1,
    "args": {
       "External id": 943,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278960727, "dur": 44,
    "args": {
       "External id": 942,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278960898,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745309753344, "Bytes": 3538944, "Total Allocated": 706219008, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278960893, "dur": 12,
    "args": {
       "External id": 946,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278960852, "dur": 55,
    "args": {
       "External id": 945,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278960950, "dur": 29,
    "args": {
       "External id": 947,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278960812, "dur": 169,
    "args": {
       "External id": 944,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278961105, "dur": 2,
    "args": {
       "External id": 950,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278961066, "dur": 43,
    "args": {
       "External id": 949,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 38976, "tid": 38976,
    "ts": 1638154278961025, "dur": 109,
    "args": {
       "External id": 948,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 38976, "tid": 38976,
    "ts": 1638154278960589, "dur": 548,
    "args": {
       "External id": 939,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961143,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": -512, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961148,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745306214400, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961248,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745313292288, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278961242, "dur": 33,
    "args": {
       "External id": 952,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278961201, "dur": 76,
    "args": {
       "External id": 951,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961282,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745309753344, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961505,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745316831232, "Bytes": 3538944, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278961496, "dur": 15,
    "args": {
       "External id": 956,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278961450, "dur": 66,
    "args": {
       "External id": 955,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961622,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": 884736, "Total Allocated": 707103232, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278961614, "dur": 14,
    "args": {
       "External id": 958,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278961563, "dur": 68,
    "args": {
       "External id": 957,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278961400, "dur": 257,
    "args": {
       "External id": 954,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961660,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": -884736, "Total Allocated": 706218496, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278961352, "dur": 312,
    "args": {
       "External id": 953,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278961670,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745313292288, "Bytes": -3538944, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278961800, "dur": 2,
    "args": {
       "External id": 961,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278961759, "dur": 49,
    "args": {
       "External id": 960,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 38976, "tid": 38976,
    "ts": 1638154278961892, "dur": 4,
    "args": {
       "External id": 963,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278961849, "dur": 49,
    "args": {
       "External id": 962,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278961979, "dur": 2,
    "args": {
       "External id": 965,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 38976, "tid": 38976,
    "ts": 1638154278961939, "dur": 45,
    "args": {
       "External id": 964,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278962151,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278962147, "dur": 11,
    "args": {
       "External id": 969,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278962107, "dur": 53,
    "args": {
       "External id": 968,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278962203, "dur": 27,
    "args": {
       "External id": 970,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278962062, "dur": 171,
    "args": {
       "External id": 967,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278962316, "dur": 2,
    "args": {
       "External id": 972,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278962276, "dur": 44,
    "args": {
       "External id": 971,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 38976, "tid": 38976,
    "ts": 1638154278962022, "dur": 300,
    "args": {
       "External id": 966,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278962411,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278962407, "dur": 13,
    "args": {
       "External id": 974,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 38976, "tid": 38976,
    "ts": 1638154278962364, "dur": 80,
    "args": {
       "External id": 973,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278962526, "dur": 1,
    "args": {
       "External id": 976,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278962486, "dur": 43,
    "args": {
       "External id": 975,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278962533,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278961716, "dur": 824,
    "args": {
       "External id": 959,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278962634, "dur": 2,
    "args": {
       "External id": 978,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278962583, "dur": 56,
    "args": {
       "External id": 977,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278962808,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278962804, "dur": 10,
    "args": {
       "External id": 982,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278962764, "dur": 52,
    "args": {
       "External id": 981,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 38976, "tid": 38976,
    "ts": 1638154278962858, "dur": 25,
    "args": {
       "External id": 983,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 38976, "tid": 38976,
    "ts": 1638154278962724, "dur": 162,
    "args": {
       "External id": 980,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 38976, "tid": 38976,
    "ts": 1638154278962684, "dur": 203,
    "args": {
       "External id": 979,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278962936, "dur": 3,
    "args": {
       "External id": 984,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278962946,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278963142, "dur": 2,
    "args": {
       "External id": 988,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278963098, "dur": 50,
    "args": {
       "External id": 987,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278963054, "dur": 97,
    "args": {
       "External id": 986,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278963243, "dur": 2,
    "args": {
       "External id": 990,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963300,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": 18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278963293, "dur": 84,
    "args": {
       "External id": 991,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278963476, "dur": 2,
    "args": {
       "External id": 993,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278963432, "dur": 51,
    "args": {
       "External id": 992,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278963195, "dur": 291,
    "args": {
       "External id": 989,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278963531, "dur": 26,
    "args": {
       "External id": 994,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278963011, "dur": 549,
    "args": {
       "External id": 985,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963785,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": 18874368, "Total Allocated": 759302656, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278963775, "dur": 18,
    "args": {
       "External id": 998,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278963725, "dur": 74,
    "args": {
       "External id": 997,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963896,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": 4718592, "Total Allocated": 764021248, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278963888, "dur": 14,
    "args": {
       "External id": 1000,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278963844, "dur": 62,
    "args": {
       "External id": 999,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278963677, "dur": 254,
    "args": {
       "External id": 996,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963934,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745302675456, "Bytes": -4718592, "Total Allocated": 759302656, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278963632, "dur": 307,
    "args": {
       "External id": 995,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963944,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745283801088, "Bytes": -18874368, "Total Allocated": 740428288, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963950,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749260001280, "Bytes": -18874368, "Total Allocated": 721553920, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963955,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 702679552, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963960,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": -18874368, "Total Allocated": 683805184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963965,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -18874368, "Total Allocated": 664930816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278963969,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745316831232, "Bytes": -3538944, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964025,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745369784320, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 38976, "tid": 38976,
    "ts": 1638154278964018, "dur": 33,
    "args": {
       "External id": 1001,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964058,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964219,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": 18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278964215, "dur": 10,
    "args": {
       "External id": 1004,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964273,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 680278528, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278964269, "dur": 10,
    "args": {
       "External id": 1005,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964326,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 680290816, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278964322, "dur": 9,
    "args": {
       "External id": 1006,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278964404, "dur": 2,
    "args": {
       "External id": 1007,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278964449, "dur": 2,
    "args": {
       "External id": 1008,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278964170, "dur": 286,
    "args": {
       "External id": 1003,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964459,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 680278528, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964463,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278964127, "dur": 339,
    "args": {
       "External id": 1002,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278964674, "dur": 2,
    "args": {
       "External id": 1012,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278964629, "dur": 50,
    "args": {
       "External id": 1011,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278964577, "dur": 105,
    "args": {
       "External id": 1010,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278964772, "dur": 3,
    "args": {
       "External id": 1014,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278964831,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": 75497472, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278964825, "dur": 47,
    "args": {
       "External id": 1015,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278964967, "dur": 2,
    "args": {
       "External id": 1017,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278964923, "dur": 48,
    "args": {
       "External id": 1016,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278964728, "dur": 246,
    "args": {
       "External id": 1013,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278965021, "dur": 25,
    "args": {
       "External id": 1018,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278964533, "dur": 516,
    "args": {
       "External id": 1009,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278965112,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": 75497472, "Total Allocated": 831261184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 38976, "tid": 38976,
    "ts": 1638154278965106, "dur": 30,
    "args": {
       "External id": 1019,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278965142,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744814039040, "Bytes": -75497472, "Total Allocated": 755763712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278965338, "dur": 2,
    "args": {
       "External id": 1023,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278965289, "dur": 53,
    "args": {
       "External id": 1022,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278965245, "dur": 101,
    "args": {
       "External id": 1021,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278965440, "dur": 3,
    "args": {
       "External id": 1025,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278965496,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": 18874368, "Total Allocated": 774638080, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278965490, "dur": 57,
    "args": {
       "External id": 1026,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278965652, "dur": 2,
    "args": {
       "External id": 1028,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278965600, "dur": 57,
    "args": {
       "External id": 1027,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278965391, "dur": 269,
    "args": {
       "External id": 1024,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 38976, "tid": 38976,
    "ts": 1638154278965706, "dur": 25,
    "args": {
       "External id": 1029,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278965201, "dur": 533,
    "args": {
       "External id": 1020,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278965740,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139744889536512, "Bytes": -75497472, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278965956,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": 18874368, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278965946, "dur": 17,
    "args": {
       "External id": 1033,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278965901, "dur": 67,
    "args": {
       "External id": 1032,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966066,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": 4718592, "Total Allocated": 722733568, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278966058, "dur": 14,
    "args": {
       "External id": 1035,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 38976, "tid": 38976,
    "ts": 1638154278966014, "dur": 60,
    "args": {
       "External id": 1034,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278965852, "dur": 247,
    "args": {
       "External id": 1031,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966102,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749239029760, "Bytes": -4718592, "Total Allocated": 718014976, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 38976, "tid": 38976,
    "ts": 1638154278965807, "dur": 299,
    "args": {
       "External id": 1030,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966111,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745791311872, "Bytes": -18874368, "Total Allocated": 699140608, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966117,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745369784320, "Bytes": -18874368, "Total Allocated": 680266240, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966122,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": -18874368, "Total Allocated": 661391872, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966126,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745350909952, "Bytes": -18874368, "Total Allocated": 642517504, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966133,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139749142560768, "Bytes": -18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966138,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745522876416, "Bytes": -18874368, "Total Allocated": 604768768, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966278,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": 18874368, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278966274, "dur": 10,
    "args": {
       "External id": 1038,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966328,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": 12288, "Total Allocated": 623655424, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278966324, "dur": 9,
    "args": {
       "External id": 1039,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966374,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": 12288, "Total Allocated": 623667712, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 38976, "tid": 38976,
    "ts": 1638154278966371, "dur": 8,
    "args": {
       "External id": 1040,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278966447, "dur": 2,
    "args": {
       "External id": 1041,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278966486, "dur": 2,
    "args": {
       "External id": 1042,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278966236, "dur": 256,
    "args": {
       "External id": 1037,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966495,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333220352, "Bytes": -12288, "Total Allocated": 623655424, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966500,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333232640, "Bytes": -12288, "Total Allocated": 623643136, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 38976, "tid": 38976,
    "ts": 1638154278966199, "dur": 304,
    "args": {
       "External id": 1036,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966508,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748282728448, "Bytes": -18874368, "Total Allocated": 604768768, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 38976, "tid": 38976,
    "ts": 1638154278966672, "dur": 1,
    "args": {
       "External id": 1046,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 38976, "tid": 38976,
    "ts": 1638154278966636, "dur": 40,
    "args": {
       "External id": 1045,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 38976, "tid": 38976,
    "ts": 1638154278966594, "dur": 85,
    "args": {
       "External id": 1044,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278966753, "dur": 3,
    "args": {
       "External id": 1048,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966799,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333412352, "Bytes": 122880, "Total Allocated": 604891648, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 38976, "tid": 38976,
    "ts": 1638154278966793, "dur": 45,
    "args": {
       "External id": 1049,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278966916, "dur": 1,
    "args": {
       "External id": 1051,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 38976, "tid": 38976,
    "ts": 1638154278966880, "dur": 39,
    "args": {
       "External id": 1050,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 38976, "tid": 38976,
    "ts": 1638154278966717, "dur": 205,
    "args": {
       "External id": 1047,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 38976, "tid": 38976,
    "ts": 1638154278966561, "dur": 363,
    "args": {
       "External id": 1043,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278966930,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745455767552, "Bytes": -18874368, "Total Allocated": 586017280, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278966969, "dur": 2,
    "args": {
       "External id": 1052,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 38976, "tid": 38976,
    "ts": 1638154278967006, "dur": 2,
    "args": {
       "External id": 1053,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 38976, "tid": 38976,
    "ts": 1638154278967126, "dur": 1,
    "args": {
       "External id": 1056,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967170,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": 122880, "Total Allocated": 586140160, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278967163, "dur": 34,
    "args": {
       "External id": 1057,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 38976, "tid": 38976,
    "ts": 1638154278967093, "dur": 107,
    "args": {
       "External id": 1055,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967326,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248000, "Bytes": 512, "Total Allocated": 586140672, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967333,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248512, "Bytes": 512, "Total Allocated": 586141184, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 38976, "tid": 38976,
    "ts": 1638154278967373, "dur": 1,
    "args": {
       "External id": 1061,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 38976, "tid": 38976,
    "ts": 1638154278967412, "dur": 1,
    "args": {
       "External id": 1062,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 38976, "tid": 38976,
    "ts": 1638154278967320, "dur": 116,
    "args": {
       "External id": 1060,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967439,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333248512, "Bytes": -512, "Total Allocated": 586140672, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 38976, "tid": 38976,
    "ts": 1638154278967287, "dur": 156,
    "args": {
       "External id": 1059,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 38976, "tid": 38976,
    "ts": 1638154278967250, "dur": 195,
    "args": {
       "External id": 1058,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967448,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333658112, "Bytes": -122880, "Total Allocated": 586017792, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 38976, "tid": 38976,
    "ts": 1638154278967055, "dur": 396,
    "args": {
       "External id": 1054,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967457,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139745388658688, "Bytes": -18874368, "Total Allocated": 567143424, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 38976, "tid": 38976,
    "ts": 1638154278924200, "dur": 43462,
    "args": {
       "External id": 313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 567
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 38976, "tid": 38976,
    "ts": 1638154278967721, "dur": 1,
    "args": {
       "External id": 1063,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[113369088], [28342272]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967796,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333535232, "Bytes": -122880, "Total Allocated": 567020544, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 38976, "tid": 38976,
    "ts": 1638154278967877,
    "args": {
      "Device Type": 1, "Device Id": 1, "Addr": 139748333247488, "Bytes": -512, "Total Allocated": 567020032, "Total Reserved": 1497366528
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#6", "pid": 38976, "tid": 38976,
    "ts": 1638154278911422, "dur": 80547,
    "args": {
       "External id": 4,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278912461, "dur": 6,
    "args": {
      "cbid": 138, "correlation": 6832,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 38976, "tid": 38976,
    "ts": 1638154278912468, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 6833,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278912472, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 6834,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 38976, "tid": 38976,
    "ts": 1638154278912474, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 6835,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 1, "tid": 7,
    "ts": 1638154278912865, "dur": 2,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 6854, "external id": 14,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.462686567164178
    }
  },
  {
    "ph": "f", "id": 6854, "pid": 1, "tid": 7, "ts": 1638154278912865,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278912836, "dur": 26,
    "args": {
      "cbid": 41, "correlation": 6854,
      "external id": 14, "external ts": 1638154278912826
    }
  },
  {
    "ph": "s", "id": 6854, "pid": 38976, "tid": 38976, "ts": 1638154278912836,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 38976, "tid": 38976,
    "ts": 1638154278912862, "dur": 9,
    "args": {
      "cbid": 131, "correlation": 6855,
      "external id": 14, "external ts": 1638154278912826
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 1, "tid": 7,
    "ts": 1638154278913038, "dur": 2,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 6867, "external id": 18,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.636363636363637
    }
  },
  {
    "ph": "f", "id": 6867, "pid": 1, "tid": 7, "ts": 1638154278913038,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278913017, "dur": 17,
    "args": {
      "cbid": 41, "correlation": 6867,
      "external id": 18, "external ts": 1638154278913012
    }
  },
  {
    "ph": "s", "id": 6867, "pid": 38976, "tid": 38976, "ts": 1638154278913017,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 38976, "tid": 38976,
    "ts": 1638154278913035, "dur": 7,
    "args": {
      "cbid": 131, "correlation": 6868,
      "external id": 18, "external ts": 1638154278913012
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 38976, "tid": 38976,
    "ts": 1638154278913096, "dur": 4,
    "args": {
      "cbid": 165, "correlation": 6872,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 38976, "tid": 573044480,
    "ts": 1638154278913626, "dur": 9,
    "args": {
      "cbid": 151, "correlation": 6876,
      "external id": 0, "external ts": 1638154278967877
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 38976, "tid": 573044480,
    "ts": 1638154278913737, "dur": 2,
    "args": {
      "cbid": 151, "correlation": 6882,
      "external id": 0, "external ts": 1638154278967877
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278914143, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 6890,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278914148, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 6893,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 38976, "tid": 38976,
    "ts": 1638154278914155, "dur": 1,
    "args": {
      "cbid": 147, "correlation": 6896,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 38976, "tid": 38976,
    "ts": 1638154278914159, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 6899,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 1, "tid": 7,
    "ts": 1638154278924452, "dur": 2,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 6908, "external id": 317,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.727272727272727
    }
  },
  {
    "ph": "f", "id": 6908, "pid": 1, "tid": 7, "ts": 1638154278924452,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278924432, "dur": 18,
    "args": {
      "cbid": 41, "correlation": 6908,
      "external id": 317, "external ts": 1638154278924423
    }
  },
  {
    "ph": "s", "id": 6908, "pid": 38976, "tid": 38976, "ts": 1638154278924432,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 1, "tid": 7,
    "ts": 1638154278924616, "dur": 2,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 6914, "external id": 321,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.727272727272727
    }
  },
  {
    "ph": "f", "id": 6914, "pid": 1, "tid": 7, "ts": 1638154278924616,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278924597, "dur": 17,
    "args": {
      "cbid": 41, "correlation": 6914,
      "external id": 321, "external ts": 1638154278924592
    }
  },
  {
    "ph": "s", "id": 6914, "pid": 38976, "tid": 38976, "ts": 1638154278924597,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 1, "tid": 7,
    "ts": 1638154278924971, "dur": 63,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6927, "external id": 325,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 6927, "pid": 1, "tid": 7, "ts": 1638154278924971,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278924944, "dur": 27,
    "args": {
      "cbid": 211, "correlation": 6927,
      "external id": 325, "external ts": 1638154278924834
    }
  },
  {
    "ph": "s", "id": 6927, "pid": 38976, "tid": 38976, "ts": 1638154278924944,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278925268, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6935, "external id": 333,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 6935, "pid": 1, "tid": 7, "ts": 1638154278925268,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278925250, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 6935,
      "external id": 333, "external ts": 1638154278925227
    }
  },
  {
    "ph": "s", "id": 6935, "pid": 38976, "tid": 38976, "ts": 1638154278925250,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278925587, "dur": 83,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6957, "external id": 335,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 6957, "pid": 1, "tid": 7, "ts": 1638154278925587,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278925571, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 6957,
      "external id": 335, "external ts": 1638154278925380
    }
  },
  {
    "ph": "s", "id": 6957, "pid": 38976, "tid": 38976, "ts": 1638154278925571,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278925934, "dur": 114,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6971, "external id": 341,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 6971, "pid": 1, "tid": 7, "ts": 1638154278925934,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278925919, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 6971,
      "external id": 341, "external ts": 1638154278925743
    }
  },
  {
    "ph": "s", "id": 6971, "pid": 38976, "tid": 38976, "ts": 1638154278925919,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278926051, "dur": 67,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6973, "external id": 341,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 6973, "pid": 1, "tid": 7, "ts": 1638154278926051,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278925934, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 6973,
      "external id": 341, "external ts": 1638154278925743
    }
  },
  {
    "ph": "s", "id": 6973, "pid": 38976, "tid": 38976, "ts": 1638154278925934,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278926466, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 6980,
      "external id": 353, "external ts": 1638154278926442
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278926471, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 6981,
      "external id": 353, "external ts": 1638154278926442
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278926491, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 6982, "external id": 353,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.0
    }
  },
  {
    "ph": "f", "id": 6982, "pid": 1, "tid": 7, "ts": 1638154278926491,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278926477, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 6982,
      "external id": 353, "external ts": 1638154278926442
    }
  },
  {
    "ph": "s", "id": 6982, "pid": 38976, "tid": 38976, "ts": 1638154278926477,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278926489, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 6983,
      "external id": 353, "external ts": 1638154278926442
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278926510, "dur": 1165,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6984, "external id": 353,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 6984, "pid": 1, "tid": 7, "ts": 1638154278926510,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278926495, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 6984,
      "external id": 353, "external ts": 1638154278926442
    }
  },
  {
    "ph": "s", "id": 6984, "pid": 38976, "tid": 38976, "ts": 1638154278926495,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278926512, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 6986,
      "external id": 353, "external ts": 1638154278926442
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278927677, "dur": 75,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 6990, "external id": 356,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 6990, "pid": 1, "tid": 7, "ts": 1638154278927677,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278926702, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 6990,
      "external id": 356, "external ts": 1638154278926689
    }
  },
  {
    "ph": "s", "id": 6990, "pid": 38976, "tid": 38976, "ts": 1638154278926702,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278927231, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 6997,
      "external id": 366, "external ts": 1638154278927207
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278927235, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 6998,
      "external id": 366, "external ts": 1638154278927207
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278927755, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 6999, "external id": 366,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.945945945945946
    }
  },
  {
    "ph": "f", "id": 6999, "pid": 1, "tid": 7, "ts": 1638154278927755,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278927239, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 6999,
      "external id": 366, "external ts": 1638154278927207
    }
  },
  {
    "ph": "s", "id": 6999, "pid": 38976, "tid": 38976, "ts": 1638154278927239,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278927249, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7000,
      "external id": 366, "external ts": 1638154278927207
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278927757, "dur": 1163,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7001, "external id": 366,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7001, "pid": 1, "tid": 7, "ts": 1638154278927757,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278927254, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7001,
      "external id": 366, "external ts": 1638154278927207
    }
  },
  {
    "ph": "s", "id": 7001, "pid": 38976, "tid": 38976, "ts": 1638154278927254,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278927269, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7003,
      "external id": 366, "external ts": 1638154278927207
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278928922, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7007, "external id": 369,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7007, "pid": 1, "tid": 7, "ts": 1638154278928922,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278927440, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7007,
      "external id": 369, "external ts": 1638154278927429
    }
  },
  {
    "ph": "s", "id": 7007, "pid": 38976, "tid": 38976, "ts": 1638154278927440,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278927975, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7014,
      "external id": 379, "external ts": 1638154278927952
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278927979, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7015,
      "external id": 379, "external ts": 1638154278927952
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278928998, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7016, "external id": 379,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.0
    }
  },
  {
    "ph": "f", "id": 7016, "pid": 1, "tid": 7, "ts": 1638154278928998,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278927983, "dur": 19,
    "args": {
      "cbid": 51, "correlation": 7016,
      "external id": 379, "external ts": 1638154278927952
    }
  },
  {
    "ph": "s", "id": 7016, "pid": 38976, "tid": 38976, "ts": 1638154278927983,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278928003, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7017,
      "external id": 379, "external ts": 1638154278927952
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278929000, "dur": 1161,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7018, "external id": 379,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7018, "pid": 1, "tid": 7, "ts": 1638154278929000,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278928009, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7018,
      "external id": 379, "external ts": 1638154278927952
    }
  },
  {
    "ph": "s", "id": 7018, "pid": 38976, "tid": 38976, "ts": 1638154278928009,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278928024, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7020,
      "external id": 379, "external ts": 1638154278927952
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278930163, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7024, "external id": 382,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7024, "pid": 1, "tid": 7, "ts": 1638154278930163,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278928191, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7024,
      "external id": 382, "external ts": 1638154278928181
    }
  },
  {
    "ph": "s", "id": 7024, "pid": 38976, "tid": 38976, "ts": 1638154278928191,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278930239, "dur": 75,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7032, "external id": 395,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7032, "pid": 1, "tid": 7, "ts": 1638154278930239,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278928834, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 7032,
      "external id": 395, "external ts": 1638154278928824
    }
  },
  {
    "ph": "s", "id": 7032, "pid": 38976, "tid": 38976, "ts": 1638154278928834,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278930316, "dur": 72,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7041, "external id": 404,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7041, "pid": 1, "tid": 7, "ts": 1638154278930316,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278929264, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7041,
      "external id": 404, "external ts": 1638154278929256
    }
  },
  {
    "ph": "s", "id": 7041, "pid": 38976, "tid": 38976, "ts": 1638154278929264,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278930390, "dur": 242,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7051, "external id": 407,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7051, "pid": 1, "tid": 7, "ts": 1638154278930390,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278929486, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7051,
      "external id": 407, "external ts": 1638154278929415
    }
  },
  {
    "ph": "s", "id": 7051, "pid": 38976, "tid": 38976, "ts": 1638154278929486,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278930634, "dur": 9,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7057, "external id": 411,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7057, "pid": 1, "tid": 7, "ts": 1638154278930634,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278929697, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7057,
      "external id": 411, "external ts": 1638154278929677
    }
  },
  {
    "ph": "s", "id": 7057, "pid": 38976, "tid": 38976, "ts": 1638154278929697,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278930645, "dur": 1,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7065, "external id": 416,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 7065, "pid": 1, "tid": 7, "ts": 1638154278930645,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278930000, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7065,
      "external id": 416, "external ts": 1638154278929972
    }
  },
  {
    "ph": "s", "id": 7065, "pid": 38976, "tid": 38976, "ts": 1638154278930000,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 1, "tid": 7,
    "ts": 1638154278930649, "dur": 8,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7072, "external id": 425,
      "bytes": 3538944, "memory bandwidth (GB/s)": 433.6941176470588
    }
  },
  {
    "ph": "f", "id": 7072, "pid": 1, "tid": 7, "ts": 1638154278930649,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278930434, "dur": 21,
    "args": {
      "cbid": 41, "correlation": 7072,
      "external id": 425, "external ts": 1638154278930428
    }
  },
  {
    "ph": "s", "id": 7072, "pid": 38976, "tid": 38976, "ts": 1638154278930434,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278930659, "dur": 10,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7077, "external id": 426,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7077, "pid": 1, "tid": 7, "ts": 1638154278930659,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278930612, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7077,
      "external id": 426, "external ts": 1638154278930508
    }
  },
  {
    "ph": "s", "id": 7077, "pid": 38976, "tid": 38976, "ts": 1638154278930612,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 1, "tid": 7,
    "ts": 1638154278930778, "dur": 18,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7084, "external id": 430,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7084, "pid": 1, "tid": 7, "ts": 1638154278930778,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278930764, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7084,
      "external id": 430, "external ts": 1638154278930749
    }
  },
  {
    "ph": "s", "id": 7084, "pid": 38976, "tid": 38976, "ts": 1638154278930764,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278931152, "dur": 12,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7106, "external id": 432,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7106, "pid": 1, "tid": 7, "ts": 1638154278931152,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278931137, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7106,
      "external id": 432, "external ts": 1638154278930906
    }
  },
  {
    "ph": "s", "id": 7106, "pid": 38976, "tid": 38976, "ts": 1638154278931137,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278931740, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7114, "external id": 448,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7114, "pid": 1, "tid": 7, "ts": 1638154278931740,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278931725, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7114,
      "external id": 448, "external ts": 1638154278931715
    }
  },
  {
    "ph": "s", "id": 7114, "pid": 38976, "tid": 38976, "ts": 1638154278931725,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278931953, "dur": 239,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7124, "external id": 451,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7124, "pid": 1, "tid": 7, "ts": 1638154278931953,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278931939, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7124,
      "external id": 451, "external ts": 1638154278931876
    }
  },
  {
    "ph": "s", "id": 7124, "pid": 38976, "tid": 38976, "ts": 1638154278931939,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278932388, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7133, "external id": 461,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7133, "pid": 1, "tid": 7, "ts": 1638154278932388,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278932374, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7133,
      "external id": 461, "external ts": 1638154278932366
    }
  },
  {
    "ph": "s", "id": 7133, "pid": 38976, "tid": 38976, "ts": 1638154278932374,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278932982, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7142,
      "external id": 469, "external ts": 1638154278932958
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278932988, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 7143,
      "external id": 469, "external ts": 1638154278932958
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278933008, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7144, "external id": 469,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.7142857142857142
    }
  },
  {
    "ph": "f", "id": 7144, "pid": 1, "tid": 7, "ts": 1638154278933008,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278932994, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 7144,
      "external id": 469, "external ts": 1638154278932958
    }
  },
  {
    "ph": "s", "id": 7144, "pid": 38976, "tid": 38976, "ts": 1638154278932994,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278933005, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7145,
      "external id": 469, "external ts": 1638154278932958
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278933028, "dur": 1166,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7146, "external id": 469,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7146, "pid": 1, "tid": 7, "ts": 1638154278933028,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278933012, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7146,
      "external id": 469, "external ts": 1638154278932958
    }
  },
  {
    "ph": "s", "id": 7146, "pid": 38976, "tid": 38976, "ts": 1638154278933012,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278933029, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7148,
      "external id": 469, "external ts": 1638154278932958
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278934196, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7152, "external id": 472,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7152, "pid": 1, "tid": 7, "ts": 1638154278934196,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278933192, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7152,
      "external id": 472, "external ts": 1638154278933180
    }
  },
  {
    "ph": "s", "id": 7152, "pid": 38976, "tid": 38976, "ts": 1638154278933192,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278934272, "dur": 83,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7174, "external id": 474,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7174, "pid": 1, "tid": 7, "ts": 1638154278934272,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278933540, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7174,
      "external id": 474, "external ts": 1638154278933318
    }
  },
  {
    "ph": "s", "id": 7174, "pid": 38976, "tid": 38976, "ts": 1638154278933540,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 1, "tid": 7,
    "ts": 1638154278934358, "dur": 104,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7180, "external id": 479,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7180, "pid": 1, "tid": 7, "ts": 1638154278934358,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278933680, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7180,
      "external id": 479, "external ts": 1638154278933663
    }
  },
  {
    "ph": "s", "id": 7180, "pid": 38976, "tid": 38976, "ts": 1638154278933680,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278934464, "dur": 106,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7194, "external id": 481,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7194, "pid": 1, "tid": 7, "ts": 1638154278934464,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278933972, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7194,
      "external id": 481, "external ts": 1638154278933809
    }
  },
  {
    "ph": "s", "id": 7194, "pid": 38976, "tid": 38976, "ts": 1638154278933972,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278934572, "dur": 67,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7196, "external id": 481,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7196, "pid": 1, "tid": 7, "ts": 1638154278934572,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278933986, "dur": 8,
    "args": {
      "cbid": 211, "correlation": 7196,
      "external id": 481, "external ts": 1638154278933809
    }
  },
  {
    "ph": "s", "id": 7196, "pid": 38976, "tid": 38976, "ts": 1638154278933986,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278934476, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7203,
      "external id": 493, "external ts": 1638154278934455
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278934479, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7204,
      "external id": 493, "external ts": 1638154278934455
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278934642, "dur": 4308,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7205, "external id": 493,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7205, "pid": 1, "tid": 7, "ts": 1638154278934642,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278934485, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7205,
      "external id": 493, "external ts": 1638154278934455
    }
  },
  {
    "ph": "s", "id": 7205, "pid": 38976, "tid": 38976, "ts": 1638154278934485,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278938952, "dur": 284,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7210, "external id": 496,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7210, "pid": 1, "tid": 7, "ts": 1638154278938952,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278934674, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7210,
      "external id": 496, "external ts": 1638154278934664
    }
  },
  {
    "ph": "s", "id": 7210, "pid": 38976, "tid": 38976, "ts": 1638154278934674,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278939238, "dur": 282,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7216, "external id": 497,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7216, "pid": 1, "tid": 7, "ts": 1638154278939238,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278934771, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7216,
      "external id": 497, "external ts": 1638154278934755
    }
  },
  {
    "ph": "s", "id": 7216, "pid": 38976, "tid": 38976, "ts": 1638154278934771,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278935152, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7223,
      "external id": 504, "external ts": 1638154278935134
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278935157, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 7224,
      "external id": 504, "external ts": 1638154278935134
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278939523, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7225, "external id": 504,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.5806451612903226
    }
  },
  {
    "ph": "f", "id": 7225, "pid": 1, "tid": 7, "ts": 1638154278939523,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278935163, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 7225,
      "external id": 504, "external ts": 1638154278935134
    }
  },
  {
    "ph": "s", "id": 7225, "pid": 38976, "tid": 38976, "ts": 1638154278935163,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278939526, "dur": 4350,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7226, "external id": 504,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7226, "pid": 1, "tid": 7, "ts": 1638154278939526,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278935174, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7226,
      "external id": 504, "external ts": 1638154278935134
    }
  },
  {
    "ph": "s", "id": 7226, "pid": 38976, "tid": 38976, "ts": 1638154278935174,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278935188, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7228,
      "external id": 504, "external ts": 1638154278935134
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278943879, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7232, "external id": 507,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7232, "pid": 1, "tid": 7, "ts": 1638154278943879,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278935356, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7232,
      "external id": 507, "external ts": 1638154278935347
    }
  },
  {
    "ph": "s", "id": 7232, "pid": 38976, "tid": 38976, "ts": 1638154278935356,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278943955, "dur": 83,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7254, "external id": 509,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7254, "pid": 1, "tid": 7, "ts": 1638154278943955,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278935731, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7254,
      "external id": 509, "external ts": 1638154278935490
    }
  },
  {
    "ph": "s", "id": 7254, "pid": 38976, "tid": 38976, "ts": 1638154278935731,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278944040, "dur": 112,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7268, "external id": 515,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7268, "pid": 1, "tid": 7, "ts": 1638154278944040,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278936067, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7268,
      "external id": 515, "external ts": 1638154278935898
    }
  },
  {
    "ph": "s", "id": 7268, "pid": 38976, "tid": 38976, "ts": 1638154278936067,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278944155, "dur": 67,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7270, "external id": 515,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7270, "pid": 1, "tid": 7, "ts": 1638154278944155,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278936081, "dur": 8,
    "args": {
      "cbid": 211, "correlation": 7270,
      "external id": 515, "external ts": 1638154278935898
    }
  },
  {
    "ph": "s", "id": 7270, "pid": 38976, "tid": 38976, "ts": 1638154278936081,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278936578, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7277,
      "external id": 527, "external ts": 1638154278936558
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278936583, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 7278,
      "external id": 527, "external ts": 1638154278936558
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278944225, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7279, "external id": 527,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.2413793103448276
    }
  },
  {
    "ph": "f", "id": 7279, "pid": 1, "tid": 7, "ts": 1638154278944225,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278936588, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 7279,
      "external id": 527, "external ts": 1638154278936558
    }
  },
  {
    "ph": "s", "id": 7279, "pid": 38976, "tid": 38976, "ts": 1638154278936588,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278936598, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7280,
      "external id": 527, "external ts": 1638154278936558
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278944228, "dur": 1163,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7281, "external id": 527,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7281, "pid": 1, "tid": 7, "ts": 1638154278944228,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278936611, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7281,
      "external id": 527, "external ts": 1638154278936558
    }
  },
  {
    "ph": "s", "id": 7281, "pid": 38976, "tid": 38976, "ts": 1638154278936611,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278936626, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7283,
      "external id": 527, "external ts": 1638154278936558
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278945393, "dur": 75,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7287, "external id": 530,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7287, "pid": 1, "tid": 7, "ts": 1638154278945393,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278936793, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7287,
      "external id": 530, "external ts": 1638154278936782
    }
  },
  {
    "ph": "s", "id": 7287, "pid": 38976, "tid": 38976, "ts": 1638154278936793,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278937318, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7294,
      "external id": 540, "external ts": 1638154278937298
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278937322, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7295,
      "external id": 540, "external ts": 1638154278937298
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278945470, "dur": 0,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7296, "external id": 540,
      "bytes": 2304, "memory bandwidth (GB/s)": 6.545454545454546
    }
  },
  {
    "ph": "f", "id": 7296, "pid": 1, "tid": 7, "ts": 1638154278945470,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278937326, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 7296,
      "external id": 540, "external ts": 1638154278937298
    }
  },
  {
    "ph": "s", "id": 7296, "pid": 38976, "tid": 38976, "ts": 1638154278937326,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278937335, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7297,
      "external id": 540, "external ts": 1638154278937298
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278945472, "dur": 1165,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7298, "external id": 540,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7298, "pid": 1, "tid": 7, "ts": 1638154278945472,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278937341, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7298,
      "external id": 540, "external ts": 1638154278937298
    }
  },
  {
    "ph": "s", "id": 7298, "pid": 38976, "tid": 38976, "ts": 1638154278937341,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278937355, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7300,
      "external id": 540, "external ts": 1638154278937298
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278946639, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7304, "external id": 543,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7304, "pid": 1, "tid": 7, "ts": 1638154278946639,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278937527, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7304,
      "external id": 543, "external ts": 1638154278937517
    }
  },
  {
    "ph": "s", "id": 7304, "pid": 38976, "tid": 38976, "ts": 1638154278937527,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278938052, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7311,
      "external id": 553, "external ts": 1638154278938032
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278938056, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7312,
      "external id": 553, "external ts": 1638154278938032
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278946715, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7313, "external id": 553,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.945945945945946
    }
  },
  {
    "ph": "f", "id": 7313, "pid": 1, "tid": 7, "ts": 1638154278946715,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278938060, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 7313,
      "external id": 553, "external ts": 1638154278938032
    }
  },
  {
    "ph": "s", "id": 7313, "pid": 38976, "tid": 38976, "ts": 1638154278938060,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278938069, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7314,
      "external id": 553, "external ts": 1638154278938032
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278946717, "dur": 1164,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7315, "external id": 553,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7315, "pid": 1, "tid": 7, "ts": 1638154278946717,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278938074, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7315,
      "external id": 553, "external ts": 1638154278938032
    }
  },
  {
    "ph": "s", "id": 7315, "pid": 38976, "tid": 38976, "ts": 1638154278938074,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278938088, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7317,
      "external id": 553, "external ts": 1638154278938032
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278947884, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7321, "external id": 556,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7321, "pid": 1, "tid": 7, "ts": 1638154278947884,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278938256, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7321,
      "external id": 556, "external ts": 1638154278938246
    }
  },
  {
    "ph": "s", "id": 7321, "pid": 38976, "tid": 38976, "ts": 1638154278938256,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278947960, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7329, "external id": 569,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7329, "pid": 1, "tid": 7, "ts": 1638154278947960,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278938879, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7329,
      "external id": 569, "external ts": 1638154278938869
    }
  },
  {
    "ph": "s", "id": 7329, "pid": 38976, "tid": 38976, "ts": 1638154278938879,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278948037, "dur": 72,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7338, "external id": 578,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7338, "pid": 1, "tid": 7, "ts": 1638154278948037,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278939308, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7338,
      "external id": 578, "external ts": 1638154278939301
    }
  },
  {
    "ph": "s", "id": 7338, "pid": 38976, "tid": 38976, "ts": 1638154278939308,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278948110, "dur": 242,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7348, "external id": 581,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7348, "pid": 1, "tid": 7, "ts": 1638154278948110,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278939518, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7348,
      "external id": 581, "external ts": 1638154278939455
    }
  },
  {
    "ph": "s", "id": 7348, "pid": 38976, "tid": 38976, "ts": 1638154278939518,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278948355, "dur": 8,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7354, "external id": 585,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7354, "pid": 1, "tid": 7, "ts": 1638154278948355,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278939725, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7354,
      "external id": 585, "external ts": 1638154278939705
    }
  },
  {
    "ph": "s", "id": 7354, "pid": 38976, "tid": 38976, "ts": 1638154278939725,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278948366, "dur": 1,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7362, "external id": 590,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 7362, "pid": 1, "tid": 7, "ts": 1638154278948366,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278940023, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7362,
      "external id": 590, "external ts": 1638154278939990
    }
  },
  {
    "ph": "s", "id": 7362, "pid": 38976, "tid": 38976, "ts": 1638154278940023,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 1, "tid": 7,
    "ts": 1638154278948370, "dur": 8,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7369, "external id": 599,
      "bytes": 3538944, "memory bandwidth (GB/s)": 430.3190661478599
    }
  },
  {
    "ph": "f", "id": 7369, "pid": 1, "tid": 7, "ts": 1638154278948370,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278940456, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 7369,
      "external id": 599, "external ts": 1638154278940450
    }
  },
  {
    "ph": "s", "id": 7369, "pid": 38976, "tid": 38976, "ts": 1638154278940456,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278948380, "dur": 11,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7374, "external id": 600,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7374, "pid": 1, "tid": 7, "ts": 1638154278948380,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278940632, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7374,
      "external id": 600, "external ts": 1638154278940527
    }
  },
  {
    "ph": "s", "id": 7374, "pid": 38976, "tid": 38976, "ts": 1638154278940632,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 1, "tid": 7,
    "ts": 1638154278948393, "dur": 18,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7381, "external id": 604,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7381, "pid": 1, "tid": 7, "ts": 1638154278948393,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278940784, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7381,
      "external id": 604, "external ts": 1638154278940760
    }
  },
  {
    "ph": "s", "id": 7381, "pid": 38976, "tid": 38976, "ts": 1638154278940784,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278948413, "dur": 12,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7403, "external id": 606,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7403, "pid": 1, "tid": 7, "ts": 1638154278948413,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278941155, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7403,
      "external id": 606, "external ts": 1638154278940924
    }
  },
  {
    "ph": "s", "id": 7403, "pid": 38976, "tid": 38976, "ts": 1638154278941155,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278948427, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7411, "external id": 622,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7411, "pid": 1, "tid": 7, "ts": 1638154278948427,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278941733, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7411,
      "external id": 622, "external ts": 1638154278941723
    }
  },
  {
    "ph": "s", "id": 7411, "pid": 38976, "tid": 38976, "ts": 1638154278941733,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278948503, "dur": 238,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7421, "external id": 625,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7421, "pid": 1, "tid": 7, "ts": 1638154278948503,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278942076, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7421,
      "external id": 625, "external ts": 1638154278941987
    }
  },
  {
    "ph": "s", "id": 7421, "pid": 38976, "tid": 38976, "ts": 1638154278942076,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278948743, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7430, "external id": 635,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7430, "pid": 1, "tid": 7, "ts": 1638154278948743,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278942717, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7430,
      "external id": 635, "external ts": 1638154278942708
    }
  },
  {
    "ph": "s", "id": 7430, "pid": 38976, "tid": 38976, "ts": 1638154278942717,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 38976, "tid": 573044480,
    "ts": 1638154278943212, "dur": 7,
    "args": {
      "cbid": 151, "correlation": 7438,
      "external id": 0, "external ts": 1638154278967877
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 38976, "tid": 573044480,
    "ts": 1638154278943280, "dur": 2,
    "args": {
      "cbid": 151, "correlation": 7444,
      "external id": 0, "external ts": 1638154278967877
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278943327, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7451,
      "external id": 643, "external ts": 1638154278943302
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278943332, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 7452,
      "external id": 643, "external ts": 1638154278943302
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278948818, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7453, "external id": 643,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.8
    }
  },
  {
    "ph": "f", "id": 7453, "pid": 1, "tid": 7, "ts": 1638154278948818,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278943339, "dur": 21,
    "args": {
      "cbid": 51, "correlation": 7453,
      "external id": 643, "external ts": 1638154278943302
    }
  },
  {
    "ph": "s", "id": 7453, "pid": 38976, "tid": 38976, "ts": 1638154278943339,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278943361, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7454,
      "external id": 643, "external ts": 1638154278943302
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278948821, "dur": 1166,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7455, "external id": 643,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7455, "pid": 1, "tid": 7, "ts": 1638154278948821,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278943367, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7455,
      "external id": 643, "external ts": 1638154278943302
    }
  },
  {
    "ph": "s", "id": 7455, "pid": 38976, "tid": 38976, "ts": 1638154278943367,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278943384, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7457,
      "external id": 643, "external ts": 1638154278943302
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278949989, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7461, "external id": 646,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7461, "pid": 1, "tid": 7, "ts": 1638154278949989,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278943573, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7461,
      "external id": 646, "external ts": 1638154278943561
    }
  },
  {
    "ph": "s", "id": 7461, "pid": 38976, "tid": 38976, "ts": 1638154278943573,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278950065, "dur": 86,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7483, "external id": 648,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7483, "pid": 1, "tid": 7, "ts": 1638154278950065,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278943947, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7483,
      "external id": 648, "external ts": 1638154278943710
    }
  },
  {
    "ph": "s", "id": 7483, "pid": 38976, "tid": 38976, "ts": 1638154278943947,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 1, "tid": 7,
    "ts": 1638154278950153, "dur": 104,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7489, "external id": 653,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7489, "pid": 1, "tid": 7, "ts": 1638154278950153,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278944073, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7489,
      "external id": 653, "external ts": 1638154278944056
    }
  },
  {
    "ph": "s", "id": 7489, "pid": 38976, "tid": 38976, "ts": 1638154278944073,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278950260, "dur": 105,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7503, "external id": 655,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7503, "pid": 1, "tid": 7, "ts": 1638154278950260,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278944374, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7503,
      "external id": 655, "external ts": 1638154278944206
    }
  },
  {
    "ph": "s", "id": 7503, "pid": 38976, "tid": 38976, "ts": 1638154278944374,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278950367, "dur": 67,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7505, "external id": 655,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7505, "pid": 1, "tid": 7, "ts": 1638154278950367,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278944388, "dur": 8,
    "args": {
      "cbid": 211, "correlation": 7505,
      "external id": 655, "external ts": 1638154278944206
    }
  },
  {
    "ph": "s", "id": 7505, "pid": 38976, "tid": 38976, "ts": 1638154278944388,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278944901, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7512,
      "external id": 667, "external ts": 1638154278944877
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278944905, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7513,
      "external id": 667, "external ts": 1638154278944877
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278950437, "dur": 4310,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7514, "external id": 667,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7514, "pid": 1, "tid": 7, "ts": 1638154278950437,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278944910, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7514,
      "external id": 667, "external ts": 1638154278944877
    }
  },
  {
    "ph": "s", "id": 7514, "pid": 38976, "tid": 38976, "ts": 1638154278944910,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278954749, "dur": 284,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7519, "external id": 670,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7519, "pid": 1, "tid": 7, "ts": 1638154278954749,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278945086, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7519,
      "external id": 670, "external ts": 1638154278945075
    }
  },
  {
    "ph": "s", "id": 7519, "pid": 38976, "tid": 38976, "ts": 1638154278945086,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278955036, "dur": 283,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7525, "external id": 671,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7525, "pid": 1, "tid": 7, "ts": 1638154278955036,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278945180, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7525,
      "external id": 671, "external ts": 1638154278945164
    }
  },
  {
    "ph": "s", "id": 7525, "pid": 38976, "tid": 38976, "ts": 1638154278945180,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278945561, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7532,
      "external id": 678, "external ts": 1638154278945543
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278945566, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 7533,
      "external id": 678, "external ts": 1638154278945543
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278955321, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7534, "external id": 678,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.75
    }
  },
  {
    "ph": "f", "id": 7534, "pid": 1, "tid": 7, "ts": 1638154278955321,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278945570, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 7534,
      "external id": 678, "external ts": 1638154278945543
    }
  },
  {
    "ph": "s", "id": 7534, "pid": 38976, "tid": 38976, "ts": 1638154278945570,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278955324, "dur": 4369,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7535, "external id": 678,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7535, "pid": 1, "tid": 7, "ts": 1638154278955324,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278945581, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7535,
      "external id": 678, "external ts": 1638154278945543
    }
  },
  {
    "ph": "s", "id": 7535, "pid": 38976, "tid": 38976, "ts": 1638154278945581,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278945596, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7537,
      "external id": 678, "external ts": 1638154278945543
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278959695, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7541, "external id": 681,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7541, "pid": 1, "tid": 7, "ts": 1638154278959695,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278945769, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7541,
      "external id": 681, "external ts": 1638154278945759
    }
  },
  {
    "ph": "s", "id": 7541, "pid": 38976, "tid": 38976, "ts": 1638154278945769,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278959771, "dur": 87,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7563, "external id": 683,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7563, "pid": 1, "tid": 7, "ts": 1638154278959771,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278946140, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7563,
      "external id": 683, "external ts": 1638154278945908
    }
  },
  {
    "ph": "s", "id": 7563, "pid": 38976, "tid": 38976, "ts": 1638154278946140,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278959860, "dur": 113,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7577, "external id": 689,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7577, "pid": 1, "tid": 7, "ts": 1638154278959860,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278946479, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7577,
      "external id": 689, "external ts": 1638154278946301
    }
  },
  {
    "ph": "s", "id": 7577, "pid": 38976, "tid": 38976, "ts": 1638154278946479,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278959976, "dur": 67,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7579, "external id": 689,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7579, "pid": 1, "tid": 7, "ts": 1638154278959976,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278946493, "dur": 8,
    "args": {
      "cbid": 211, "correlation": 7579,
      "external id": 689, "external ts": 1638154278946301
    }
  },
  {
    "ph": "s", "id": 7579, "pid": 38976, "tid": 38976, "ts": 1638154278946493,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278946997, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7586,
      "external id": 701, "external ts": 1638154278946976
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278947001, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 7587,
      "external id": 701, "external ts": 1638154278946976
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278960047, "dur": 0,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7588, "external id": 701,
      "bytes": 2304, "memory bandwidth (GB/s)": 3.130434782608696
    }
  },
  {
    "ph": "f", "id": 7588, "pid": 1, "tid": 7, "ts": 1638154278960047,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278947006, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 7588,
      "external id": 701, "external ts": 1638154278946976
    }
  },
  {
    "ph": "s", "id": 7588, "pid": 38976, "tid": 38976, "ts": 1638154278947006,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278947016, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7589,
      "external id": 701, "external ts": 1638154278946976
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278960049, "dur": 1172,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7590, "external id": 701,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7590, "pid": 1, "tid": 7, "ts": 1638154278960049,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278947022, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7590,
      "external id": 701, "external ts": 1638154278946976
    }
  },
  {
    "ph": "s", "id": 7590, "pid": 38976, "tid": 38976, "ts": 1638154278947022,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278947037, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7592,
      "external id": 701, "external ts": 1638154278946976
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278961223, "dur": 75,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7596, "external id": 704,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7596, "pid": 1, "tid": 7, "ts": 1638154278961223,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278947206, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7596,
      "external id": 704, "external ts": 1638154278947195
    }
  },
  {
    "ph": "s", "id": 7596, "pid": 38976, "tid": 38976, "ts": 1638154278947206,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278947741, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7603,
      "external id": 714, "external ts": 1638154278947719
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278947745, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7604,
      "external id": 714, "external ts": 1638154278947719
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278961301, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7605, "external id": 714,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.7142857142857142
    }
  },
  {
    "ph": "f", "id": 7605, "pid": 1, "tid": 7, "ts": 1638154278961301,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278947749, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 7605,
      "external id": 714, "external ts": 1638154278947719
    }
  },
  {
    "ph": "s", "id": 7605, "pid": 38976, "tid": 38976, "ts": 1638154278947749,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278947759, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7606,
      "external id": 714, "external ts": 1638154278947719
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278961303, "dur": 1171,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7607, "external id": 714,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7607, "pid": 1, "tid": 7, "ts": 1638154278961303,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278947764, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7607,
      "external id": 714, "external ts": 1638154278947719
    }
  },
  {
    "ph": "s", "id": 7607, "pid": 38976, "tid": 38976, "ts": 1638154278947764,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278947778, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7609,
      "external id": 714, "external ts": 1638154278947719
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278962477, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7613, "external id": 717,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7613, "pid": 1, "tid": 7, "ts": 1638154278962477,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278947943, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7613,
      "external id": 717, "external ts": 1638154278947933
    }
  },
  {
    "ph": "s", "id": 7613, "pid": 38976, "tid": 38976, "ts": 1638154278947943,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278948467, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7620,
      "external id": 727, "external ts": 1638154278948448
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278948471, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7621,
      "external id": 727, "external ts": 1638154278948448
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278962554, "dur": 0,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7622, "external id": 727,
      "bytes": 2304, "memory bandwidth (GB/s)": 3.272727272727273
    }
  },
  {
    "ph": "f", "id": 7622, "pid": 1, "tid": 7, "ts": 1638154278962554,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278948475, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 7622,
      "external id": 727, "external ts": 1638154278948448
    }
  },
  {
    "ph": "s", "id": 7622, "pid": 38976, "tid": 38976, "ts": 1638154278948475,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278948483, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7623,
      "external id": 727, "external ts": 1638154278948448
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278962556, "dur": 1169,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7624, "external id": 727,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7624, "pid": 1, "tid": 7, "ts": 1638154278962556,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278948488, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7624,
      "external id": 727, "external ts": 1638154278948448
    }
  },
  {
    "ph": "s", "id": 7624, "pid": 38976, "tid": 38976, "ts": 1638154278948488,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278948502, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7626,
      "external id": 727, "external ts": 1638154278948448
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278963727, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7630, "external id": 730,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7630, "pid": 1, "tid": 7, "ts": 1638154278963727,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278948691, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7630,
      "external id": 730, "external ts": 1638154278948681
    }
  },
  {
    "ph": "s", "id": 7630, "pid": 38976, "tid": 38976, "ts": 1638154278948691,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278963803, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7638, "external id": 743,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7638, "pid": 1, "tid": 7, "ts": 1638154278963803,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278949302, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7638,
      "external id": 743, "external ts": 1638154278949292
    }
  },
  {
    "ph": "s", "id": 7638, "pid": 38976, "tid": 38976, "ts": 1638154278949302,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278963879, "dur": 71,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7647, "external id": 752,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7647, "pid": 1, "tid": 7, "ts": 1638154278963879,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278949736, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7647,
      "external id": 752, "external ts": 1638154278949729
    }
  },
  {
    "ph": "s", "id": 7647, "pid": 38976, "tid": 38976, "ts": 1638154278949736,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278963953, "dur": 243,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7657, "external id": 755,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7657, "pid": 1, "tid": 7, "ts": 1638154278963953,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278949947, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7657,
      "external id": 755, "external ts": 1638154278949884
    }
  },
  {
    "ph": "s", "id": 7657, "pid": 38976, "tid": 38976, "ts": 1638154278949947,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278964198, "dur": 9,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7663, "external id": 759,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7663, "pid": 1, "tid": 7, "ts": 1638154278964198,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278950147, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7663,
      "external id": 759, "external ts": 1638154278950128
    }
  },
  {
    "ph": "s", "id": 7663, "pid": 38976, "tid": 38976, "ts": 1638154278950147,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278964209, "dur": 1,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7671, "external id": 764,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 7671, "pid": 1, "tid": 7, "ts": 1638154278964209,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278950437, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7671,
      "external id": 764, "external ts": 1638154278950409
    }
  },
  {
    "ph": "s", "id": 7671, "pid": 38976, "tid": 38976, "ts": 1638154278950437,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 1, "tid": 7,
    "ts": 1638154278964213, "dur": 8,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7678, "external id": 773,
      "bytes": 3538944, "memory bandwidth (GB/s)": 403.6204379562044
    }
  },
  {
    "ph": "f", "id": 7678, "pid": 1, "tid": 7, "ts": 1638154278964213,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278950879, "dur": 21,
    "args": {
      "cbid": 41, "correlation": 7678,
      "external id": 773, "external ts": 1638154278950873
    }
  },
  {
    "ph": "s", "id": 7678, "pid": 38976, "tid": 38976, "ts": 1638154278950879,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278964223, "dur": 11,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7683, "external id": 774,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7683, "pid": 1, "tid": 7, "ts": 1638154278964223,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278951045, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7683,
      "external id": 774, "external ts": 1638154278950952
    }
  },
  {
    "ph": "s", "id": 7683, "pid": 38976, "tid": 38976, "ts": 1638154278951045,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 1, "tid": 7,
    "ts": 1638154278964236, "dur": 17,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7690, "external id": 778,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7690, "pid": 1, "tid": 7, "ts": 1638154278964236,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278951187, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7690,
      "external id": 778, "external ts": 1638154278951170
    }
  },
  {
    "ph": "s", "id": 7690, "pid": 38976, "tid": 38976, "ts": 1638154278951187,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278964256, "dur": 12,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7712, "external id": 780,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7712, "pid": 1, "tid": 7, "ts": 1638154278964256,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278951568, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7712,
      "external id": 780, "external ts": 1638154278951326
    }
  },
  {
    "ph": "s", "id": 7712, "pid": 38976, "tid": 38976, "ts": 1638154278951568,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278964270, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7720, "external id": 796,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7720, "pid": 1, "tid": 7, "ts": 1638154278964270,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278952139, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7720,
      "external id": 796, "external ts": 1638154278952129
    }
  },
  {
    "ph": "s", "id": 7720, "pid": 38976, "tid": 38976, "ts": 1638154278952139,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278964347, "dur": 239,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7730, "external id": 799,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7730, "pid": 1, "tid": 7, "ts": 1638154278964347,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278952364, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7730,
      "external id": 799, "external ts": 1638154278952293
    }
  },
  {
    "ph": "s", "id": 7730, "pid": 38976, "tid": 38976, "ts": 1638154278952364,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278964588, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7739, "external id": 809,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7739, "pid": 1, "tid": 7, "ts": 1638154278964588,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278952801, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7739,
      "external id": 809, "external ts": 1638154278952793
    }
  },
  {
    "ph": "s", "id": 7739, "pid": 38976, "tid": 38976, "ts": 1638154278952801,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278953256, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7748,
      "external id": 817, "external ts": 1638154278953235
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278953261, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 7749,
      "external id": 817, "external ts": 1638154278953235
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278964664, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7750, "external id": 817,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.8461538461538463
    }
  },
  {
    "ph": "f", "id": 7750, "pid": 1, "tid": 7, "ts": 1638154278964664,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278953266, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 7750,
      "external id": 817, "external ts": 1638154278953235
    }
  },
  {
    "ph": "s", "id": 7750, "pid": 38976, "tid": 38976, "ts": 1638154278953266,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278953276, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7751,
      "external id": 817, "external ts": 1638154278953235
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278964666, "dur": 1173,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7752, "external id": 817,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7752, "pid": 1, "tid": 7, "ts": 1638154278964666,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278953282, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7752,
      "external id": 817, "external ts": 1638154278953235
    }
  },
  {
    "ph": "s", "id": 7752, "pid": 38976, "tid": 38976, "ts": 1638154278953282,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278953297, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7754,
      "external id": 817, "external ts": 1638154278953235
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278965841, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7758, "external id": 820,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7758, "pid": 1, "tid": 7, "ts": 1638154278965841,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278953464, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7758,
      "external id": 820, "external ts": 1638154278953453
    }
  },
  {
    "ph": "s", "id": 7758, "pid": 38976, "tid": 38976, "ts": 1638154278953464,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278965917, "dur": 87,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7780, "external id": 822,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7780, "pid": 1, "tid": 7, "ts": 1638154278965917,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278953836, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7780,
      "external id": 822, "external ts": 1638154278953592
    }
  },
  {
    "ph": "s", "id": 7780, "pid": 38976, "tid": 38976, "ts": 1638154278953836,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 1, "tid": 7,
    "ts": 1638154278966007, "dur": 104,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7786, "external id": 827,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7786, "pid": 1, "tid": 7, "ts": 1638154278966007,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278953955, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7786,
      "external id": 827, "external ts": 1638154278953939
    }
  },
  {
    "ph": "s", "id": 7786, "pid": 38976, "tid": 38976, "ts": 1638154278953955,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278966113, "dur": 106,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7800, "external id": 829,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7800, "pid": 1, "tid": 7, "ts": 1638154278966113,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278954253, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7800,
      "external id": 829, "external ts": 1638154278954086
    }
  },
  {
    "ph": "s", "id": 7800, "pid": 38976, "tid": 38976, "ts": 1638154278954253,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278966221, "dur": 68,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7802, "external id": 829,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7802, "pid": 1, "tid": 7, "ts": 1638154278966221,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278954267, "dur": 8,
    "args": {
      "cbid": 211, "correlation": 7802,
      "external id": 829, "external ts": 1638154278954086
    }
  },
  {
    "ph": "s", "id": 7802, "pid": 38976, "tid": 38976, "ts": 1638154278954267,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278955101, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7809,
      "external id": 841, "external ts": 1638154278955078
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278955105, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7810,
      "external id": 841, "external ts": 1638154278955078
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278966292, "dur": 4339,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7811, "external id": 841,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7811, "pid": 1, "tid": 7, "ts": 1638154278966292,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278955111, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 7811,
      "external id": 841, "external ts": 1638154278955078
    }
  },
  {
    "ph": "s", "id": 7811, "pid": 38976, "tid": 38976, "ts": 1638154278955111,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278970633, "dur": 283,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7816, "external id": 844,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7816, "pid": 1, "tid": 7, "ts": 1638154278970633,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278955289, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7816,
      "external id": 844, "external ts": 1638154278955277
    }
  },
  {
    "ph": "s", "id": 7816, "pid": 38976, "tid": 38976, "ts": 1638154278955289,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278970919, "dur": 284,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7822, "external id": 845,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7822, "pid": 1, "tid": 7, "ts": 1638154278970919,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278955382, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7822,
      "external id": 845, "external ts": 1638154278955366
    }
  },
  {
    "ph": "s", "id": 7822, "pid": 38976, "tid": 38976, "ts": 1638154278955382,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278955754, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7829,
      "external id": 852, "external ts": 1638154278955735
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278955758, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 7830,
      "external id": 852, "external ts": 1638154278955735
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278971205, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7831, "external id": 852,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.8181818181818182
    }
  },
  {
    "ph": "f", "id": 7831, "pid": 1, "tid": 7, "ts": 1638154278971205,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278955763, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 7831,
      "external id": 852, "external ts": 1638154278955735
    }
  },
  {
    "ph": "s", "id": 7831, "pid": 38976, "tid": 38976, "ts": 1638154278955763,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278971207, "dur": 4372,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7832, "external id": 852,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7832, "pid": 1, "tid": 7, "ts": 1638154278971207,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278955775, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7832,
      "external id": 852, "external ts": 1638154278955735
    }
  },
  {
    "ph": "s", "id": 7832, "pid": 38976, "tid": 38976, "ts": 1638154278955775,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278955788, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7834,
      "external id": 852, "external ts": 1638154278955735
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278975582, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7838, "external id": 855,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7838, "pid": 1, "tid": 7, "ts": 1638154278975582,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278955947, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7838,
      "external id": 855, "external ts": 1638154278955937
    }
  },
  {
    "ph": "s", "id": 7838, "pid": 38976, "tid": 38976, "ts": 1638154278955947,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278975658, "dur": 83,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7860, "external id": 857,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7860, "pid": 1, "tid": 7, "ts": 1638154278975658,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278956303, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7860,
      "external id": 857, "external ts": 1638154278956082
    }
  },
  {
    "ph": "s", "id": 7860, "pid": 38976, "tid": 38976, "ts": 1638154278956303,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278975743, "dur": 113,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7874, "external id": 863,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7874, "pid": 1, "tid": 7, "ts": 1638154278975743,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278956631, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7874,
      "external id": 863, "external ts": 1638154278956463
    }
  },
  {
    "ph": "s", "id": 7874, "pid": 38976, "tid": 38976, "ts": 1638154278956631,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278975859, "dur": 68,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7876, "external id": 863,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7876, "pid": 1, "tid": 7, "ts": 1638154278975859,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278956645, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 7876,
      "external id": 863, "external ts": 1638154278956463
    }
  },
  {
    "ph": "s", "id": 7876, "pid": 38976, "tid": 38976, "ts": 1638154278956645,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278957119, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 7883,
      "external id": 875, "external ts": 1638154278957099
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278957124, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 7884,
      "external id": 875, "external ts": 1638154278957099
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278975929, "dur": 0,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7885, "external id": 875,
      "bytes": 2304, "memory bandwidth (GB/s)": 8.0
    }
  },
  {
    "ph": "f", "id": 7885, "pid": 1, "tid": 7, "ts": 1638154278975929,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278957129, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 7885,
      "external id": 875, "external ts": 1638154278957099
    }
  },
  {
    "ph": "s", "id": 7885, "pid": 38976, "tid": 38976, "ts": 1638154278957129,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278957138, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7886,
      "external id": 875, "external ts": 1638154278957099
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278975932, "dur": 1170,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7887, "external id": 875,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7887, "pid": 1, "tid": 7, "ts": 1638154278975932,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278957144, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7887,
      "external id": 875, "external ts": 1638154278957099
    }
  },
  {
    "ph": "s", "id": 7887, "pid": 38976, "tid": 38976, "ts": 1638154278957144,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278957159, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7889,
      "external id": 875, "external ts": 1638154278957099
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278977105, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7893, "external id": 878,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7893, "pid": 1, "tid": 7, "ts": 1638154278977105,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278957318, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7893,
      "external id": 878, "external ts": 1638154278957306
    }
  },
  {
    "ph": "s", "id": 7893, "pid": 38976, "tid": 38976, "ts": 1638154278957318,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278957843, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7900,
      "external id": 888, "external ts": 1638154278957821
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278957847, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7901,
      "external id": 888, "external ts": 1638154278957821
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278977182, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7902, "external id": 888,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.25
    }
  },
  {
    "ph": "f", "id": 7902, "pid": 1, "tid": 7, "ts": 1638154278977182,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278957851, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 7902,
      "external id": 888, "external ts": 1638154278957821
    }
  },
  {
    "ph": "s", "id": 7902, "pid": 38976, "tid": 38976, "ts": 1638154278957851,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278957860, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7903,
      "external id": 888, "external ts": 1638154278957821
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278977185, "dur": 1169,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7904, "external id": 888,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7904, "pid": 1, "tid": 7, "ts": 1638154278977185,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278957866, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7904,
      "external id": 888, "external ts": 1638154278957821
    }
  },
  {
    "ph": "s", "id": 7904, "pid": 38976, "tid": 38976, "ts": 1638154278957866,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278957880, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7906,
      "external id": 888, "external ts": 1638154278957821
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278978357, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7910, "external id": 891,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7910, "pid": 1, "tid": 7, "ts": 1638154278978357,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278958043, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7910,
      "external id": 891, "external ts": 1638154278958033
    }
  },
  {
    "ph": "s", "id": 7910, "pid": 38976, "tid": 38976, "ts": 1638154278958043,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278958561, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7917,
      "external id": 901, "external ts": 1638154278958542
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278958565, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 7918,
      "external id": 901, "external ts": 1638154278958542
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278978434, "dur": 0,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7919, "external id": 901,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.769230769230769
    }
  },
  {
    "ph": "f", "id": 7919, "pid": 1, "tid": 7, "ts": 1638154278978434,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278958569, "dur": 8,
    "args": {
      "cbid": 51, "correlation": 7919,
      "external id": 901, "external ts": 1638154278958542
    }
  },
  {
    "ph": "s", "id": 7919, "pid": 38976, "tid": 38976, "ts": 1638154278958569,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278958577, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 7920,
      "external id": 901, "external ts": 1638154278958542
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278978436, "dur": 1171,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7921, "external id": 901,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 7921, "pid": 1, "tid": 7, "ts": 1638154278978436,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278958582, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7921,
      "external id": 901, "external ts": 1638154278958542
    }
  },
  {
    "ph": "s", "id": 7921, "pid": 38976, "tid": 38976, "ts": 1638154278958582,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278958596, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 7923,
      "external id": 901, "external ts": 1638154278958542
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278979610, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7927, "external id": 904,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7927, "pid": 1, "tid": 7, "ts": 1638154278979610,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278958769, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7927,
      "external id": 904, "external ts": 1638154278958759
    }
  },
  {
    "ph": "s", "id": 7927, "pid": 38976, "tid": 38976, "ts": 1638154278958769,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278979686, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7935, "external id": 917,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7935, "pid": 1, "tid": 7, "ts": 1638154278979686,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278959385, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 7935,
      "external id": 917, "external ts": 1638154278959375
    }
  },
  {
    "ph": "s", "id": 7935, "pid": 38976, "tid": 38976, "ts": 1638154278959385,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278979762, "dur": 72,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7944, "external id": 926,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7944, "pid": 1, "tid": 7, "ts": 1638154278979762,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278959818, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7944,
      "external id": 926, "external ts": 1638154278959810
    }
  },
  {
    "ph": "s", "id": 7944, "pid": 38976, "tid": 38976, "ts": 1638154278959818,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278979837, "dur": 243,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7954, "external id": 929,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7954, "pid": 1, "tid": 7, "ts": 1638154278979837,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278960028, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7954,
      "external id": 929, "external ts": 1638154278959965
    }
  },
  {
    "ph": "s", "id": 7954, "pid": 38976, "tid": 38976, "ts": 1638154278960028,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278980081, "dur": 9,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7960, "external id": 933,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7960, "pid": 1, "tid": 7, "ts": 1638154278980081,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278960225, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 7960,
      "external id": 933, "external ts": 1638154278960207
    }
  },
  {
    "ph": "s", "id": 7960, "pid": 38976, "tid": 38976, "ts": 1638154278960225,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278980093, "dur": 1,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7968, "external id": 938,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 7968, "pid": 1, "tid": 7, "ts": 1638154278980093,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278960522, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7968,
      "external id": 938, "external ts": 1638154278960494
    }
  },
  {
    "ph": "s", "id": 7968, "pid": 38976, "tid": 38976, "ts": 1638154278960522,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 1, "tid": 7,
    "ts": 1638154278980097, "dur": 8,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 7975, "external id": 947,
      "bytes": 3538944, "memory bandwidth (GB/s)": 425.40497655968267
    }
  },
  {
    "ph": "f", "id": 7975, "pid": 1, "tid": 7, "ts": 1638154278980097,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278960955, "dur": 20,
    "args": {
      "cbid": 41, "correlation": 7975,
      "external id": 947, "external ts": 1638154278960950
    }
  },
  {
    "ph": "s", "id": 7975, "pid": 38976, "tid": 38976, "ts": 1638154278960955,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278980107, "dur": 10,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7980, "external id": 948,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7980, "pid": 1, "tid": 7, "ts": 1638154278980107,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278961118, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 7980,
      "external id": 948, "external ts": 1638154278961025
    }
  },
  {
    "ph": "s", "id": 7980, "pid": 38976, "tid": 38976, "ts": 1638154278961118,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 1, "tid": 7,
    "ts": 1638154278980120, "dur": 17,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 7987, "external id": 952,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 7987, "pid": 1, "tid": 7, "ts": 1638154278980120,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278961259, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 7987,
      "external id": 952, "external ts": 1638154278961242
    }
  },
  {
    "ph": "s", "id": 7987, "pid": 38976, "tid": 38976, "ts": 1638154278961259,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278980140, "dur": 12,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8009, "external id": 954,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8009, "pid": 1, "tid": 7, "ts": 1638154278980140,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278961640, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 8009,
      "external id": 954, "external ts": 1638154278961400
    }
  },
  {
    "ph": "s", "id": 8009, "pid": 38976, "tid": 38976, "ts": 1638154278961640,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278980154, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8017, "external id": 970,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8017, "pid": 1, "tid": 7, "ts": 1638154278980154,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278962212, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 8017,
      "external id": 970, "external ts": 1638154278962203
    }
  },
  {
    "ph": "s", "id": 8017, "pid": 38976, "tid": 38976, "ts": 1638154278962212,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 1, "tid": 7,
    "ts": 1638154278980231, "dur": 239,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8027, "external id": 973,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8027, "pid": 1, "tid": 7, "ts": 1638154278980231,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278962429, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 8027,
      "external id": 973, "external ts": 1638154278962364
    }
  },
  {
    "ph": "s", "id": 8027, "pid": 38976, "tid": 38976, "ts": 1638154278962429,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278980472, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8036, "external id": 983,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8036, "pid": 1, "tid": 7, "ts": 1638154278980472,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278962866, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 8036,
      "external id": 983, "external ts": 1638154278962858
    }
  },
  {
    "ph": "s", "id": 8036, "pid": 38976, "tid": 38976, "ts": 1638154278962866,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278963314, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 8045,
      "external id": 991, "external ts": 1638154278963293
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278963319, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 8046,
      "external id": 991, "external ts": 1638154278963293
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278980548, "dur": 0,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 8047, "external id": 991,
      "bytes": 2304, "memory bandwidth (GB/s)": 9.0
    }
  },
  {
    "ph": "f", "id": 8047, "pid": 1, "tid": 7, "ts": 1638154278980548,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278963325, "dur": 25,
    "args": {
      "cbid": 51, "correlation": 8047,
      "external id": 991, "external ts": 1638154278963293
    }
  },
  {
    "ph": "s", "id": 8047, "pid": 38976, "tid": 38976, "ts": 1638154278963325,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278963350, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 8048,
      "external id": 991, "external ts": 1638154278963293
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 1, "tid": 7,
    "ts": 1638154278980550, "dur": 1171,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8049, "external id": 991,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 8049, "pid": 1, "tid": 7, "ts": 1638154278980550,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278963356, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 8049,
      "external id": 991, "external ts": 1638154278963293
    }
  },
  {
    "ph": "s", "id": 8049, "pid": 38976, "tid": 38976, "ts": 1638154278963356,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278963372, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 8051,
      "external id": 991, "external ts": 1638154278963293
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278981723, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8055, "external id": 994,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8055, "pid": 1, "tid": 7, "ts": 1638154278981723,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278963542, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 8055,
      "external id": 994, "external ts": 1638154278963531
    }
  },
  {
    "ph": "s", "id": 8055, "pid": 38976, "tid": 38976, "ts": 1638154278963542,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278981799, "dur": 86,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8077, "external id": 996,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8077, "pid": 1, "tid": 7, "ts": 1638154278981799,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278963915, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 8077,
      "external id": 996, "external ts": 1638154278963677
    }
  },
  {
    "ph": "s", "id": 8077, "pid": 38976, "tid": 38976, "ts": 1638154278963915,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 1, "tid": 7,
    "ts": 1638154278981888, "dur": 105,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8083, "external id": 1001,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8083, "pid": 1, "tid": 7, "ts": 1638154278981888,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278964037, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 8083,
      "external id": 1001, "external ts": 1638154278964018
    }
  },
  {
    "ph": "s", "id": 8083, "pid": 38976, "tid": 38976, "ts": 1638154278964037,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278981995, "dur": 106,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8097, "external id": 1003,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8097, "pid": 1, "tid": 7, "ts": 1638154278981995,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278964335, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 8097,
      "external id": 1003, "external ts": 1638154278964170
    }
  },
  {
    "ph": "s", "id": 8097, "pid": 38976, "tid": 38976, "ts": 1638154278964335,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278982104, "dur": 68,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8099, "external id": 1003,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8099, "pid": 1, "tid": 7, "ts": 1638154278982104,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278964349, "dur": 9,
    "args": {
      "cbid": 211, "correlation": 8099,
      "external id": 1003, "external ts": 1638154278964170
    }
  },
  {
    "ph": "s", "id": 8099, "pid": 38976, "tid": 38976, "ts": 1638154278964349,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278964845, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 8106,
      "external id": 1015, "external ts": 1638154278964825
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278964849, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 8107,
      "external id": 1015, "external ts": 1638154278964825
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278982173, "dur": 4336,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8108, "external id": 1015,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 8108, "pid": 1, "tid": 7, "ts": 1638154278982173,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278964854, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 8108,
      "external id": 1015, "external ts": 1638154278964825
    }
  },
  {
    "ph": "s", "id": 8108, "pid": 38976, "tid": 38976, "ts": 1638154278964854,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278986511, "dur": 283,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8113, "external id": 1018,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8113, "pid": 1, "tid": 7, "ts": 1638154278986511,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278965031, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 8113,
      "external id": 1018, "external ts": 1638154278965021
    }
  },
  {
    "ph": "s", "id": 8113, "pid": 38976, "tid": 38976, "ts": 1638154278965031,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 1, "tid": 7,
    "ts": 1638154278986797, "dur": 284,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8119, "external id": 1019,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8119, "pid": 1, "tid": 7, "ts": 1638154278986797,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278965121, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 8119,
      "external id": 1019, "external ts": 1638154278965106
    }
  },
  {
    "ph": "s", "id": 8119, "pid": 38976, "tid": 38976, "ts": 1638154278965121,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278965508, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 8126,
      "external id": 1026, "external ts": 1638154278965490
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278965513, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 8127,
      "external id": 1026, "external ts": 1638154278965490
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 1, "tid": 7,
    "ts": 1638154278987083, "dur": 1,
    "args": {
      "device": 1, "context": 1,
      "stream": 7, "correlation": 8128, "external id": 1026,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.6923076923076923
    }
  },
  {
    "ph": "f", "id": 8128, "pid": 1, "tid": 7, "ts": 1638154278987083,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 38976, "tid": 38976,
    "ts": 1638154278965518, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 8128,
      "external id": 1026, "external ts": 1638154278965490
    }
  },
  {
    "ph": "s", "id": 8128, "pid": 38976, "tid": 38976, "ts": 1638154278965518,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 1, "tid": 7,
    "ts": 1638154278987086, "dur": 4340,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8129, "external id": 1026,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 8129, "pid": 1, "tid": 7, "ts": 1638154278987086,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278965529, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 8129,
      "external id": 1026, "external ts": 1638154278965490
    }
  },
  {
    "ph": "s", "id": 8129, "pid": 38976, "tid": 38976, "ts": 1638154278965529,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278965543, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 8131,
      "external id": 1026, "external ts": 1638154278965490
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 1, "tid": 7,
    "ts": 1638154278991428, "dur": 74,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8135, "external id": 1029,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8135, "pid": 1, "tid": 7, "ts": 1638154278991428,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278965716, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 8135,
      "external id": 1029, "external ts": 1638154278965706
    }
  },
  {
    "ph": "s", "id": 8135, "pid": 38976, "tid": 38976, "ts": 1638154278965716,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 1, "tid": 7,
    "ts": 1638154278991505, "dur": 87,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8157, "external id": 1031,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8157, "pid": 1, "tid": 7, "ts": 1638154278991505,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278966083, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 8157,
      "external id": 1031, "external ts": 1638154278965852
    }
  },
  {
    "ph": "s", "id": 8157, "pid": 38976, "tid": 38976, "ts": 1638154278966083,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278991594, "dur": 113,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8171, "external id": 1037,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8171, "pid": 1, "tid": 7, "ts": 1638154278991594,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278966384, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 8171,
      "external id": 1037, "external ts": 1638154278966236
    }
  },
  {
    "ph": "s", "id": 8171, "pid": 38976, "tid": 38976, "ts": 1638154278966384,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 1, "tid": 7,
    "ts": 1638154278991709, "dur": 67,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8173, "external id": 1037,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 8173, "pid": 1, "tid": 7, "ts": 1638154278991709,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278966398, "dur": 8,
    "args": {
      "cbid": 211, "correlation": 8173,
      "external id": 1037, "external ts": 1638154278966236
    }
  },
  {
    "ph": "s", "id": 8173, "pid": 38976, "tid": 38976, "ts": 1638154278966398,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278966813, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 8180,
      "external id": 1049, "external ts": 1638154278966793
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 1, "tid": 7,
    "ts": 1638154278991779, "dur": 73,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8181, "external id": 1049,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 8181, "pid": 1, "tid": 7, "ts": 1638154278991779,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278966819, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 8181,
      "external id": 1049, "external ts": 1638154278966793
    }
  },
  {
    "ph": "s", "id": 8181, "pid": 38976, "tid": 38976, "ts": 1638154278966819,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 1, "tid": 7,
    "ts": 1638154278991854, "dur": 2,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8188, "external id": 1057,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 8188, "pid": 1, "tid": 7, "ts": 1638154278991854,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278967179, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 8188,
      "external id": 1057, "external ts": 1638154278967163
    }
  },
  {
    "ph": "s", "id": 8188, "pid": 38976, "tid": 38976, "ts": 1638154278967179,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 1, "tid": 7,
    "ts": 1638154278991859, "dur": 49,
    "args": {
      "queued": 0, "device": 1, "context": 1,
      "stream": 7, "correlation": 8195, "external id": 1060,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 8195, "pid": 1, "tid": 7, "ts": 1638154278991859,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 38976, "tid": 38976,
    "ts": 1638154278967418, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 8195,
      "external id": 1060, "external ts": 1638154278967320
    }
  },
  {
    "ph": "s", "id": 8195, "pid": 38976, "tid": 38976, "ts": 1638154278967418,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278967812, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 8200,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278967815, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 8201,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 38976, "tid": 38976,
    "ts": 1638154278967820, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 8203,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 38976, "tid": 38976,
    "ts": 1638154278967827, "dur": 0,
    "args": {
      "cbid": 134, "correlation": 8207,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 38976, "tid": 38976,
    "ts": 1638154278967828, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 8208,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 38976, "tid": 38976,
    "ts": 1638154278967908, "dur": 24005,
    "args": {
      "cbid": 165, "correlation": 8212,
      "external id": 4, "external ts": 1638154278911422
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 38976, "tid": 38976,
    "ts": 1638154278992019, "dur": 6,
    "args": {
      "cbid": 165, "correlation": 8215,
      "external id": 0, "external ts": 1638154278967877
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 38976, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 38976, "tid": 0,
    "args": {
      "labels": "CPU"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 38976, "tid": 0,
    "args": {
      "sort_index": 38976
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 0, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 0, "tid": 0,
    "args": {
      "labels": "GPU 0"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 0, "tid": 0,
    "args": {
      "sort_index": 16777216
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 1, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 1, "tid": 0,
    "args": {
      "labels": "GPU 1"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 1, "tid": 0,
    "args": {
      "sort_index": 16777217
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 2, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 2, "tid": 0,
    "args": {
      "labels": "GPU 2"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 2, "tid": 0,
    "args": {
      "sort_index": 16777218
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 3, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 3, "tid": 0,
    "args": {
      "labels": "GPU 3"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 3, "tid": 0,
    "args": {
      "sort_index": 16777219
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 4, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 4, "tid": 0,
    "args": {
      "labels": "GPU 4"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 4, "tid": 0,
    "args": {
      "sort_index": 16777220
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 5, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 5, "tid": 0,
    "args": {
      "labels": "GPU 5"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 5, "tid": 0,
    "args": {
      "sort_index": 16777221
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 6, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 6, "tid": 0,
    "args": {
      "labels": "GPU 6"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 6, "tid": 0,
    "args": {
      "sort_index": 16777222
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154278910909, "pid": 7, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154278910909, "pid": 7, "tid": 0,
    "args": {
      "labels": "GPU 7"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 7, "tid": 0,
    "args": {
      "sort_index": 16777223
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638154278910909, "pid": 1, "tid": 7,
    "args": {
      "name": "stream 7"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 1, "tid": 7,
    "args": {
      "sort_index": 7
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638154278910909, "pid": 38976, "tid": 38976,
    "args": {
      "name": "thread 38976 (python)"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638154278910909, "pid": 38976, "tid": 38976,
    "args": {
      "sort_index": 38976
    }
  },
  {
    "ph": "X", "cat": "Trace", "ts": 1638154278910909, "dur": 81124,
    "pid": "Spans", "tid": "PyTorch Profiler",
    "name": "PyTorch Profiler (0)",
    "args": {
      "Op count": 0
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154278910909,
    "pid": "Spans", "tid": 0,
    "args": {
      "sort_index": 536870912
    }
  },
  {
    "name": "Iteration Start: PyTorch Profiler", "ph": "i", "s": "g",
    "pid": "Traces", "tid": "Trace PyTorch Profiler", "ts": 1638154278910909
  },
  {
    "name": "Record Window End", "ph": "i", "s": "g",
    "pid": "", "tid": "", "ts": 1638154279001187
  }
]}