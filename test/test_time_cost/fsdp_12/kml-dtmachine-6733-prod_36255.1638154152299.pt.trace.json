
{
  "schemaVersion": 1,
  "distributedInfo": {"backend": "nccl", "rank": 0, "world_size": 4},
  "deviceProperties": [
    {
      "id": 0, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 1, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 2, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 3, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    }
  ],
  "traceEvents": [
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165542,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94380828739776, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152165535, "dur": 37,
    "args": {
       "External id": 2,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 36255, "tid": 36255,
    "ts": 1638154152165617, "dur": 1,
    "args": {
       "External id": 3,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 36255, "tid": 36255,
    "ts": 1638154152165498, "dur": 125,
    "args": {
       "External id": 1,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165693,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776879744, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152165691, "dur": 10,
    "args": {
       "External id": 5,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165704,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776879744, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165711,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94380828739776, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165785,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776917504, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152165783, "dur": 10,
    "args": {
       "External id": 7,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 36255, "tid": 36255,
    "ts": 1638154152165822, "dur": 1,
    "args": {
       "External id": 8,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 36255, "tid": 36255,
    "ts": 1638154152165756, "dur": 69,
    "args": {
       "External id": 6,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165885,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776885120, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152165884, "dur": 5,
    "args": {
       "External id": 10,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165892,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776885120, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152165898,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776917504, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 36255, "tid": 36255,
    "ts": 1638154152165858, "dur": 247,
    "args": {
       "External id": 9,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152166245,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141251072, "Bytes": -24576, "Total Allocated": 283679232, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152166253,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141275648, "Bytes": -24576, "Total Allocated": 283654656, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152166383,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141251072, "Bytes": 24576, "Total Allocated": 283679232, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152166370, "dur": 21,
    "args": {
       "External id": 13,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152166419, "dur": 44,
    "args": {
       "External id": 14,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 36255, "tid": 36255,
    "ts": 1638154152166342, "dur": 124,
    "args": {
       "External id": 12,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152166314, "dur": 154,
    "args": {
       "External id": 11,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152166551,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141275648, "Bytes": 24576, "Total Allocated": 283703808, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152166541, "dur": 18,
    "args": {
       "External id": 17,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152166582, "dur": 40,
    "args": {
       "External id": 18,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 36255, "tid": 36255,
    "ts": 1638154152166519, "dur": 105,
    "args": {
       "External id": 16,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152166496, "dur": 130,
    "args": {
       "External id": 15,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152167036, "dur": 1,
    "args": {
       "External id": 19,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152167076, "dur": 1,
    "args": {
       "External id": 20,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152167201, "dur": 0,
    "args": {
       "External id": 21,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152167234, "dur": 0,
    "args": {
       "External id": 22,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 36255, "tid": 36255,
    "ts": 1638154152167469, "dur": 1,
    "args": {
       "External id": 23,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[14176512], [56706048]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152167555, "dur": 2,
    "args": {
       "External id": 25,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152167520, "dur": 42,
    "args": {
       "External id": 24,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152167610, "dur": 6,
    "args": {
       "External id": 26,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 36255, "tid": 36255,
    "ts": 1638154152167652, "dur": 0,
    "args": {
       "External id": 27,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [56706048]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152167878, "dur": 2,
    "args": {
       "External id": 31,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152167840, "dur": 43,
    "args": {
       "External id": 30,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152167802, "dur": 83,
    "args": {
       "External id": 29,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152167996, "dur": 1,
    "args": {
       "External id": 34,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152167959, "dur": 40,
    "args": {
       "External id": 33,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152167925, "dur": 76,
    "args": {
       "External id": 32,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168108, "dur": 1,
    "args": {
       "External id": 37,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168072, "dur": 39,
    "args": {
       "External id": 36,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168039, "dur": 74,
    "args": {
       "External id": 35,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168221, "dur": 0,
    "args": {
       "External id": 40,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168186, "dur": 40,
    "args": {
       "External id": 39,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168150, "dur": 78,
    "args": {
       "External id": 38,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168338, "dur": 0,
    "args": {
       "External id": 43,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168303, "dur": 38,
    "args": {
       "External id": 42,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168265, "dur": 77,
    "args": {
       "External id": 41,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168456, "dur": 1,
    "args": {
       "External id": 46,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168420, "dur": 40,
    "args": {
       "External id": 45,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168384, "dur": 77,
    "args": {
       "External id": 44,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168568, "dur": 1,
    "args": {
       "External id": 49,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168532, "dur": 39,
    "args": {
       "External id": 48,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168496, "dur": 77,
    "args": {
       "External id": 47,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168702, "dur": 1,
    "args": {
       "External id": 52,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168665, "dur": 40,
    "args": {
       "External id": 51,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168625, "dur": 82,
    "args": {
       "External id": 50,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168813, "dur": 1,
    "args": {
       "External id": 55,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168777, "dur": 39,
    "args": {
       "External id": 54,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168744, "dur": 74,
    "args": {
       "External id": 53,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152168950, "dur": 1,
    "args": {
       "External id": 58,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152168916, "dur": 38,
    "args": {
       "External id": 57,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168881, "dur": 74,
    "args": {
       "External id": 56,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169061, "dur": 3,
    "args": {
       "External id": 61,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169027, "dur": 39,
    "args": {
       "External id": 60,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152168990, "dur": 78,
    "args": {
       "External id": 59,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169182, "dur": 1,
    "args": {
       "External id": 64,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169139, "dur": 46,
    "args": {
       "External id": 63,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169103, "dur": 84,
    "args": {
       "External id": 62,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169296, "dur": 1,
    "args": {
       "External id": 67,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169260, "dur": 39,
    "args": {
       "External id": 66,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169222, "dur": 82,
    "args": {
       "External id": 65,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169411, "dur": 1,
    "args": {
       "External id": 70,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169375, "dur": 39,
    "args": {
       "External id": 69,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169341, "dur": 75,
    "args": {
       "External id": 68,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169523, "dur": 0,
    "args": {
       "External id": 73,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169487, "dur": 39,
    "args": {
       "External id": 72,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169453, "dur": 75,
    "args": {
       "External id": 71,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169642, "dur": 1,
    "args": {
       "External id": 76,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169607, "dur": 38,
    "args": {
       "External id": 75,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169564, "dur": 83,
    "args": {
       "External id": 74,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169754, "dur": 0,
    "args": {
       "External id": 79,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169720, "dur": 39,
    "args": {
       "External id": 78,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169684, "dur": 77,
    "args": {
       "External id": 77,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169872, "dur": 1,
    "args": {
       "External id": 82,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169836, "dur": 40,
    "args": {
       "External id": 81,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169795, "dur": 86,
    "args": {
       "External id": 80,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152169988, "dur": 0,
    "args": {
       "External id": 85,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152169952, "dur": 39,
    "args": {
       "External id": 84,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152169916, "dur": 76,
    "args": {
       "External id": 83,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170099, "dur": 1,
    "args": {
       "External id": 88,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170063, "dur": 40,
    "args": {
       "External id": 87,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170029, "dur": 75,
    "args": {
       "External id": 86,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170210, "dur": 1,
    "args": {
       "External id": 91,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170174, "dur": 40,
    "args": {
       "External id": 90,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170141, "dur": 74,
    "args": {
       "External id": 89,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170322, "dur": 1,
    "args": {
       "External id": 94,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170289, "dur": 36,
    "args": {
       "External id": 93,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170252, "dur": 75,
    "args": {
       "External id": 92,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170434, "dur": 3,
    "args": {
       "External id": 97,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170400, "dur": 41,
    "args": {
       "External id": 96,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170364, "dur": 79,
    "args": {
       "External id": 95,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170550, "dur": 1,
    "args": {
       "External id": 100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170513, "dur": 40,
    "args": {
       "External id": 99,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170478, "dur": 77,
    "args": {
       "External id": 98,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170676, "dur": 1,
    "args": {
       "External id": 103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170634, "dur": 45,
    "args": {
       "External id": 102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170590, "dur": 91,
    "args": {
       "External id": 101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170788, "dur": 0,
    "args": {
       "External id": 106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170751, "dur": 40,
    "args": {
       "External id": 105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170718, "dur": 74,
    "args": {
       "External id": 104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152170899, "dur": 1,
    "args": {
       "External id": 109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170863, "dur": 39,
    "args": {
       "External id": 108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170830, "dur": 74,
    "args": {
       "External id": 107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171011, "dur": 1,
    "args": {
       "External id": 112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152170977, "dur": 37,
    "args": {
       "External id": 111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152170941, "dur": 75,
    "args": {
       "External id": 110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171125, "dur": 1,
    "args": {
       "External id": 115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171089, "dur": 39,
    "args": {
       "External id": 114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171053, "dur": 77,
    "args": {
       "External id": 113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171236, "dur": 1,
    "args": {
       "External id": 118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171200, "dur": 39,
    "args": {
       "External id": 117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171164, "dur": 77,
    "args": {
       "External id": 116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171349, "dur": 1,
    "args": {
       "External id": 121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171313, "dur": 81,
    "args": {
       "External id": 120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171276, "dur": 120,
    "args": {
       "External id": 119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171502, "dur": 1,
    "args": {
       "External id": 124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171468, "dur": 37,
    "args": {
       "External id": 123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171433, "dur": 74,
    "args": {
       "External id": 122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171618, "dur": 1,
    "args": {
       "External id": 127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171577, "dur": 44,
    "args": {
       "External id": 126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171542, "dur": 81,
    "args": {
       "External id": 125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171731, "dur": 1,
    "args": {
       "External id": 130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171695, "dur": 39,
    "args": {
       "External id": 129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171661, "dur": 75,
    "args": {
       "External id": 128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171847, "dur": 1,
    "args": {
       "External id": 133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171811, "dur": 39,
    "args": {
       "External id": 132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171773, "dur": 79,
    "args": {
       "External id": 131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152171960, "dur": 1,
    "args": {
       "External id": 136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152171923, "dur": 40,
    "args": {
       "External id": 135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171887, "dur": 78,
    "args": {
       "External id": 134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152172079, "dur": 1,
    "args": {
       "External id": 139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152172035, "dur": 47,
    "args": {
       "External id": 138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 36255, "tid": 36255,
    "ts": 1638154152171999, "dur": 85,
    "args": {
       "External id": 137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 36255, "tid": 36255,
    "ts": 1638154152167758, "dur": 4361,
    "args": {
       "External id": 28,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172174, "dur": 8,
    "args": {
       "External id": 140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 274
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172230, "dur": 4,
    "args": {
       "External id": 141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172274, "dur": 5,
    "args": {
       "External id": 142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 276
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172320, "dur": 4,
    "args": {
       "External id": 143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 277
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172364, "dur": 4,
    "args": {
       "External id": 144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 278
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172406, "dur": 4,
    "args": {
       "External id": 145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 279
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172451, "dur": 4,
    "args": {
       "External id": 146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 280
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172495, "dur": 4,
    "args": {
       "External id": 147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 281
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172539, "dur": 4,
    "args": {
       "External id": 148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 282
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172581, "dur": 6,
    "args": {
       "External id": 149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 283
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172632, "dur": 4,
    "args": {
       "External id": 150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 284
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172677, "dur": 4,
    "args": {
       "External id": 151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 285
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172720, "dur": 4,
    "args": {
       "External id": 152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 286
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172766, "dur": 4,
    "args": {
       "External id": 153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 287
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172810, "dur": 4,
    "args": {
       "External id": 154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 288
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172853, "dur": 7,
    "args": {
       "External id": 155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 289
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172897, "dur": 6,
    "args": {
       "External id": 156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 290
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172940, "dur": 4,
    "args": {
       "External id": 157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 291
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152172983, "dur": 4,
    "args": {
       "External id": 158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 292
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173027, "dur": 3,
    "args": {
       "External id": 159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 293
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173070, "dur": 4,
    "args": {
       "External id": 160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 294
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173111, "dur": 8,
    "args": {
       "External id": 161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 295
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173156, "dur": 6,
    "args": {
       "External id": 162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 296
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173199, "dur": 3,
    "args": {
       "External id": 163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 297
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173241, "dur": 4,
    "args": {
       "External id": 164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 298
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173284, "dur": 4,
    "args": {
       "External id": 165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 299
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173328, "dur": 4,
    "args": {
       "External id": 166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 300
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173370, "dur": 9,
    "args": {
       "External id": 167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 301
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173418, "dur": 6,
    "args": {
       "External id": 168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 302
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173462, "dur": 4,
    "args": {
       "External id": 169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 303
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173516, "dur": 4,
    "args": {
       "External id": 170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 304
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173559, "dur": 4,
    "args": {
       "External id": 171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 305
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173609, "dur": 5,
    "args": {
       "External id": 172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 306
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173655, "dur": 4,
    "args": {
       "External id": 173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 307
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173696, "dur": 6,
    "args": {
       "External id": 174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 308
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173739, "dur": 6,
    "args": {
       "External id": 175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 309
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152173813, "dur": 5,
    "args": {
       "External id": 176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 310
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152174029, "dur": 3,
    "args": {
       "External id": 177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152174099, "dur": 1,
    "args": {
       "External id": 178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 311
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 36255, "tid": 36255,
    "ts": 1638154152174179, "dur": 1,
    "args": {
       "External id": 180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 36255, "tid": 36255,
    "ts": 1638154152174149, "dur": 33,
    "args": {
       "External id": 179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 311
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152174248,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94380828710144, "Bytes": 5056, "Total Allocated": 5056, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152174280,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382776919744, "Bytes": 816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152174500, "dur": 11,
    "args": {
       "External id": 184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152174560, "dur": 34,
    "args": {
       "External id": 185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 36255, "tid": 36255,
    "ts": 1638154152174460, "dur": 138,
    "args": {
       "External id": 183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152174369, "dur": 231,
    "args": {
       "External id": 182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152174815, "dur": 7,
    "args": {
       "External id": 188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152174866, "dur": 22,
    "args": {
       "External id": 189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 36255, "tid": 36255,
    "ts": 1638154152174765, "dur": 126,
    "args": {
       "External id": 187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152174686, "dur": 207,
    "args": {
       "External id": 186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 36255, "tid": 36255,
    "ts": 1638154152175288, "dur": 2,
    "args": {
       "External id": 192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152175239, "dur": 54,
    "args": {
       "External id": 191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152175435, "dur": 7,
    "args": {
       "External id": 194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152175517,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143977562112, "Bytes": 18874368, "Total Allocated": 302578176, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 36255, "tid": 36255,
    "ts": 1638154152175509, "dur": 17,
    "args": {
       "External id": 195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 36255, "tid": 36255,
    "ts": 1638154152175383, "dur": 182,
    "args": {
       "External id": 193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152175666, "dur": 3,
    "args": {
       "External id": 196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 36255, "tid": 36255,
    "ts": 1638154152175175, "dur": 501,
    "args": {
       "External id": 190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152175794, "dur": 1,
    "args": {
       "External id": 198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152175756, "dur": 44,
    "args": {
       "External id": 197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152175877, "dur": 1,
    "args": {
       "External id": 200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152175839, "dur": 42,
    "args": {
       "External id": 199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176063,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": 18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 36255, "tid": 36255,
    "ts": 1638154152176051, "dur": 52,
    "args": {
       "External id": 201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176491,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144095002624, "Bytes": 18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152176478, "dur": 22,
    "args": {
       "External id": 205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152176432, "dur": 72,
    "args": {
       "External id": 204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176609,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": 4718592, "Total Allocated": 345045504, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152176591, "dur": 26,
    "args": {
       "External id": 207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152176548, "dur": 71,
    "args": {
       "External id": 206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152176249, "dur": 406,
    "args": {
       "External id": 203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176664,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": -4718592, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152176194, "dur": 476,
    "args": {
       "External id": 202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176678,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": -18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176892,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": 18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152176886, "dur": 13,
    "args": {
       "External id": 210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152176957,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": 12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152176953, "dur": 13,
    "args": {
       "External id": 211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152177022,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": 12288, "Total Allocated": 340351488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152177018, "dur": 10,
    "args": {
       "External id": 212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152177119, "dur": 3,
    "args": {
       "External id": 213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152177174, "dur": 1,
    "args": {
       "External id": 214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152176832, "dur": 349,
    "args": {
       "External id": 209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152177185,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": -12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152177190,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": -12288, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152176777, "dur": 417,
    "args": {
       "External id": 208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152177458, "dur": 2,
    "args": {
       "External id": 218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152177404, "dur": 59,
    "args": {
       "External id": 217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152177346, "dur": 121,
    "args": {
       "External id": 216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152177577, "dur": 4,
    "args": {
       "External id": 220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152177662,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": 18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152177654, "dur": 86,
    "args": {
       "External id": 221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152177862, "dur": 2,
    "args": {
       "External id": 223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152177809, "dur": 58,
    "args": {
       "External id": 222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152177522, "dur": 349,
    "args": {
       "External id": 219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152177930, "dur": 34,
    "args": {
       "External id": 224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152177283, "dur": 684,
    "args": {
       "External id": 215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152178028, "dur": 4,
    "args": {
       "External id": 225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152178133, "dur": 4,
    "args": {
       "External id": 227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152178086, "dur": 55,
    "args": {
       "External id": 226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152178370, "dur": 1,
    "args": {
       "External id": 231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152178317, "dur": 57,
    "args": {
       "External id": 230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152178264, "dur": 113,
    "args": {
       "External id": 229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152178481, "dur": 3,
    "args": {
       "External id": 233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152178549,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152178540, "dur": 85,
    "args": {
       "External id": 234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152178845, "dur": 2,
    "args": {
       "External id": 236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152178793, "dur": 56,
    "args": {
       "External id": 235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152178428, "dur": 425,
    "args": {
       "External id": 232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152178905, "dur": 34,
    "args": {
       "External id": 237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152178211, "dur": 731,
    "args": {
       "External id": 228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152178998, "dur": 5,
    "args": {
       "External id": 238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152179099, "dur": 2,
    "args": {
       "External id": 240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152179052, "dur": 52,
    "args": {
       "External id": 239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152179323, "dur": 2,
    "args": {
       "External id": 244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152179273, "dur": 54,
    "args": {
       "External id": 243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152179222, "dur": 108,
    "args": {
       "External id": 242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152179432, "dur": 3,
    "args": {
       "External id": 246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152179501,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152179493, "dur": 77,
    "args": {
       "External id": 247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152179696, "dur": 3,
    "args": {
       "External id": 249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152179643, "dur": 58,
    "args": {
       "External id": 248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152179382, "dur": 323,
    "args": {
       "External id": 245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152179760, "dur": 33,
    "args": {
       "External id": 250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152179173, "dur": 623,
    "args": {
       "External id": 241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152179851, "dur": 4,
    "args": {
       "External id": 251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152179956, "dur": 2,
    "args": {
       "External id": 253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152179907, "dur": 54,
    "args": {
       "External id": 252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152180063, "dur": 1,
    "args": {
       "External id": 255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152180012, "dur": 55,
    "args": {
       "External id": 254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152180221, "dur": 1,
    "args": {
       "External id": 258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152180173, "dur": 55,
    "args": {
       "External id": 257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152180427,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": 18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152180420, "dur": 17,
    "args": {
       "External id": 262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152180372, "dur": 71,
    "args": {
       "External id": 261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152180494, "dur": 33,
    "args": {
       "External id": 263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152180324, "dur": 207,
    "args": {
       "External id": 260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152180636, "dur": 2,
    "args": {
       "External id": 265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152180582, "dur": 59,
    "args": {
       "External id": 264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152180274, "dur": 369,
    "args": {
       "External id": 259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152180741, "dur": 1,
    "args": {
       "External id": 267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152180693, "dur": 53,
    "args": {
       "External id": 266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152180939,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": 18874368, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152180934, "dur": 14,
    "args": {
       "External id": 271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152180888, "dur": 62,
    "args": {
       "External id": 270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152181000, "dur": 28,
    "args": {
       "External id": 272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152180839, "dur": 192,
    "args": {
       "External id": 269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152181138, "dur": 1,
    "args": {
       "External id": 274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152181090, "dur": 54,
    "args": {
       "External id": 273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152180792, "dur": 354,
    "args": {
       "External id": 268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181252,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": 3538944, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152181247, "dur": 15,
    "args": {
       "External id": 276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 36255, "tid": 36255,
    "ts": 1638154152181198, "dur": 94,
    "args": {
       "External id": 275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152181388, "dur": 2,
    "args": {
       "External id": 278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152181341, "dur": 52,
    "args": {
       "External id": 277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181397,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181405,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": -18874368, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152180118, "dur": 1291,
    "args": {
       "External id": 256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181426,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382777946560, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181495,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": 3538944, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 36255, "tid": 36255,
    "ts": 1638154152181484, "dur": 42,
    "args": {
       "External id": 279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181532,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382777946560, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181542,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152181672, "dur": 2,
    "args": {
       "External id": 281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152181622, "dur": 57,
    "args": {
       "External id": 280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152181780, "dur": 1,
    "args": {
       "External id": 283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152181725, "dur": 59,
    "args": {
       "External id": 282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181850,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382777969216, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181866,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141327872, "Bytes": 512, "Total Allocated": 400489472, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152181874,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382777969216, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 36255, "tid": 36255,
    "ts": 1638154152181847, "dur": 56,
    "args": {
       "External id": 284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152182065, "dur": 1,
    "args": {
       "External id": 287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152182015, "dur": 55,
    "args": {
       "External id": 286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152182168, "dur": 1,
    "args": {
       "External id": 289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152182119, "dur": 53,
    "args": {
       "External id": 288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152182324,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": 3538944, "Total Allocated": 404028416, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152182319, "dur": 13,
    "args": {
       "External id": 292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152182271, "dur": 66,
    "args": {
       "External id": 291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152182387, "dur": 34,
    "args": {
       "External id": 293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152182221, "dur": 203,
    "args": {
       "External id": 290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152182575, "dur": 2,
    "args": {
       "External id": 296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152182528, "dur": 51,
    "args": {
       "External id": 295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 36255, "tid": 36255,
    "ts": 1638154152182477, "dur": 139,
    "args": {
       "External id": 294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 36255, "tid": 36255,
    "ts": 1638154152181966, "dur": 654,
    "args": {
       "External id": 285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152182626,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141327872, "Bytes": -512, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152182633,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152182761,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": 3538944, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 36255, "tid": 36255,
    "ts": 1638154152182754, "dur": 37,
    "args": {
       "External id": 298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 36255, "tid": 36255,
    "ts": 1638154152182702, "dur": 92,
    "args": {
       "External id": 297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152182799,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152183060,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": 3538944, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152183049, "dur": 27,
    "args": {
       "External id": 302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152182995, "dur": 86,
    "args": {
       "External id": 301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152183199,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141577216, "Bytes": 884736, "Total Allocated": 404912640, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152183190, "dur": 16,
    "args": {
       "External id": 304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152183135, "dur": 74,
    "args": {
       "External id": 303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152182937, "dur": 303,
    "args": {
       "External id": 300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152183243,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141577216, "Bytes": -884736, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152182883, "dur": 366,
    "args": {
       "External id": 299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152183255,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152183408, "dur": 1,
    "args": {
       "External id": 307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152183359, "dur": 55,
    "args": {
       "External id": 306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 36255, "tid": 36255,
    "ts": 1638154152183512, "dur": 4,
    "args": {
       "External id": 309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152183463, "dur": 55,
    "args": {
       "External id": 308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152183624, "dur": 2,
    "args": {
       "External id": 311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152183569, "dur": 63,
    "args": {
       "External id": 310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152183826,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": 18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152183820, "dur": 14,
    "args": {
       "External id": 315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152183773, "dur": 64,
    "args": {
       "External id": 314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152183887, "dur": 33,
    "args": {
       "External id": 316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152183725, "dur": 198,
    "args": {
       "External id": 313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152184027, "dur": 3,
    "args": {
       "External id": 318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152183974, "dur": 58,
    "args": {
       "External id": 317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152183678, "dur": 357,
    "args": {
       "External id": 312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152184141,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152184136, "dur": 13,
    "args": {
       "External id": 320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 36255, "tid": 36255,
    "ts": 1638154152184085, "dur": 93,
    "args": {
       "External id": 319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152184275, "dur": 2,
    "args": {
       "External id": 322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152184227, "dur": 52,
    "args": {
       "External id": 321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152184283,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152183309, "dur": 986,
    "args": {
       "External id": 305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152184397, "dur": 2,
    "args": {
       "External id": 324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152184348, "dur": 55,
    "args": {
       "External id": 323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152184616,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152184611, "dur": 12,
    "args": {
       "External id": 328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152184556, "dur": 70,
    "args": {
       "External id": 327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152184677, "dur": 30,
    "args": {
       "External id": 329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152184509, "dur": 201,
    "args": {
       "External id": 326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 36255, "tid": 36255,
    "ts": 1638154152184462, "dur": 250,
    "args": {
       "External id": 325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152184766, "dur": 4,
    "args": {
       "External id": 330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152184775,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152185020, "dur": 1,
    "args": {
       "External id": 334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152184958, "dur": 66,
    "args": {
       "External id": 333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152184905, "dur": 123,
    "args": {
       "External id": 332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152185137, "dur": 3,
    "args": {
       "External id": 336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185205,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152185197, "dur": 80,
    "args": {
       "External id": 337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152185396, "dur": 2,
    "args": {
       "External id": 339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152185343, "dur": 58,
    "args": {
       "External id": 338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152185084, "dur": 320,
    "args": {
       "External id": 335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152185459, "dur": 32,
    "args": {
       "External id": 340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152184854, "dur": 640,
    "args": {
       "External id": 331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185756,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152185745, "dur": 20,
    "args": {
       "External id": 344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152185692, "dur": 77,
    "args": {
       "External id": 343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185884,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145262460928, "Bytes": 4718592, "Total Allocated": 461830656, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152185876, "dur": 15,
    "args": {
       "External id": 346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152185824, "dur": 70,
    "args": {
       "External id": 345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152185633, "dur": 295,
    "args": {
       "External id": 342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185932,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145262460928, "Bytes": -4718592, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152185572, "dur": 365,
    "args": {
       "External id": 341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185943,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185953,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185959,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": -18874368, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185964,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": -18874368, "Total Allocated": 381614592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185969,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": -18874368, "Total Allocated": 362740224, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152185974,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": -3538944, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186039,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 36255, "tid": 36255,
    "ts": 1638154152186030, "dur": 38,
    "args": {
       "External id": 347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186076,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145243586560, "Bytes": -18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186265,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152186260, "dur": 12,
    "args": {
       "External id": 350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186334,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": 12288, "Total Allocated": 378087936, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152186330, "dur": 11,
    "args": {
       "External id": 351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186399,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": 12288, "Total Allocated": 378100224, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152186395, "dur": 12,
    "args": {
       "External id": 352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152186503, "dur": 3,
    "args": {
       "External id": 353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152186555, "dur": 1,
    "args": {
       "External id": 354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152186206, "dur": 358,
    "args": {
       "External id": 349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186568,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": -12288, "Total Allocated": 378087936, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152186574,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": -12288, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152186158, "dur": 419,
    "args": {
       "External id": 348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152186822, "dur": 2,
    "args": {
       "External id": 358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152186769, "dur": 58,
    "args": {
       "External id": 357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152186715, "dur": 117,
    "args": {
       "External id": 356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152186939, "dur": 3,
    "args": {
       "External id": 360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152187015,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141393870848, "Bytes": 75497472, "Total Allocated": 453573120, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152187007, "dur": 57,
    "args": {
       "External id": 361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152187180, "dur": 2,
    "args": {
       "External id": 363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152187125, "dur": 60,
    "args": {
       "External id": 362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152186886, "dur": 302,
    "args": {
       "External id": 359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152187243, "dur": 31,
    "args": {
       "External id": 364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152186663, "dur": 614,
    "args": {
       "External id": 355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152187356,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141469368320, "Bytes": 75497472, "Total Allocated": 529070592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 36255, "tid": 36255,
    "ts": 1638154152187348, "dur": 38,
    "args": {
       "External id": 365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152187392,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141393870848, "Bytes": -75497472, "Total Allocated": 453573120, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152187627, "dur": 2,
    "args": {
       "External id": 369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152187564, "dur": 68,
    "args": {
       "External id": 368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152187511, "dur": 125,
    "args": {
       "External id": 367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152187744, "dur": 3,
    "args": {
       "External id": 371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152187811,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": 18874368, "Total Allocated": 472447488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152187804, "dur": 72,
    "args": {
       "External id": 372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152187991, "dur": 2,
    "args": {
       "External id": 374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152187938, "dur": 58,
    "args": {
       "External id": 373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152187691, "dur": 308,
    "args": {
       "External id": 370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152188053, "dur": 30,
    "args": {
       "External id": 375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152187459, "dur": 627,
    "args": {
       "External id": 366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188093,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141469368320, "Bytes": -75497472, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188350,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": 18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152188339, "dur": 19,
    "args": {
       "External id": 379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152188285, "dur": 77,
    "args": {
       "External id": 378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188478,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": 4718592, "Total Allocated": 420542976, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152188469, "dur": 16,
    "args": {
       "External id": 381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152188416, "dur": 72,
    "args": {
       "External id": 380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152188227, "dur": 292,
    "args": {
       "External id": 377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188528,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": -4718592, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152188173, "dur": 359,
    "args": {
       "External id": 376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188538,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": -18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188545,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": -18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188553,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": -18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188557,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": -18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188794,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": 18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152188789, "dur": 13,
    "args": {
       "External id": 384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188860,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": 12288, "Total Allocated": 359213568, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152188856, "dur": 10,
    "args": {
       "External id": 385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152188928,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": 12288, "Total Allocated": 359225856, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152188924, "dur": 10,
    "args": {
       "External id": 386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152189027, "dur": 3,
    "args": {
       "External id": 387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152189081, "dur": 1,
    "args": {
       "External id": 388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152188734, "dur": 359,
    "args": {
       "External id": 383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152189096,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": -12288, "Total Allocated": 359213568, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152189101,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": -12288, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152188681, "dur": 424,
    "args": {
       "External id": 382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152189350, "dur": 2,
    "args": {
       "External id": 392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152189298, "dur": 57,
    "args": {
       "External id": 391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152189244, "dur": 115,
    "args": {
       "External id": 390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152189466, "dur": 3,
    "args": {
       "External id": 394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152189534,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152189526, "dur": 88,
    "args": {
       "External id": 395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152189730, "dur": 2,
    "args": {
       "External id": 397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152189677, "dur": 58,
    "args": {
       "External id": 396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152189413, "dur": 326,
    "args": {
       "External id": 393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152189794, "dur": 33,
    "args": {
       "External id": 398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152189192, "dur": 641,
    "args": {
       "External id": 389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152189893, "dur": 4,
    "args": {
       "External id": 399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152189997, "dur": 2,
    "args": {
       "External id": 401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152189948, "dur": 55,
    "args": {
       "External id": 400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152190232, "dur": 1,
    "args": {
       "External id": 405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152190179, "dur": 57,
    "args": {
       "External id": 404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152190126, "dur": 113,
    "args": {
       "External id": 403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152190345, "dur": 2,
    "args": {
       "External id": 407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152190411,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152190404, "dur": 73,
    "args": {
       "External id": 408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152190592, "dur": 2,
    "args": {
       "External id": 410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152190539, "dur": 57,
    "args": {
       "External id": 409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152190292, "dur": 308,
    "args": {
       "External id": 406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152190663, "dur": 31,
    "args": {
       "External id": 411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152190074, "dur": 623,
    "args": {
       "External id": 402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152190757, "dur": 4,
    "args": {
       "External id": 412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152190862, "dur": 2,
    "args": {
       "External id": 414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152190813, "dur": 55,
    "args": {
       "External id": 413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152191096, "dur": 1,
    "args": {
       "External id": 418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152191043, "dur": 57,
    "args": {
       "External id": 417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152190990, "dur": 113,
    "args": {
       "External id": 416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152191207, "dur": 2,
    "args": {
       "External id": 420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152191284,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": 18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152191276, "dur": 76,
    "args": {
       "External id": 421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152191466, "dur": 2,
    "args": {
       "External id": 423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152191414, "dur": 57,
    "args": {
       "External id": 422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152191154, "dur": 320,
    "args": {
       "External id": 419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152191526, "dur": 29,
    "args": {
       "External id": 424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152190937, "dur": 621,
    "args": {
       "External id": 415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152191826, "dur": 5,
    "args": {
       "External id": 425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152191929, "dur": 2,
    "args": {
       "External id": 427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152191882, "dur": 53,
    "args": {
       "External id": 426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152192030, "dur": 2,
    "args": {
       "External id": 429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152191985, "dur": 50,
    "args": {
       "External id": 428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152192178, "dur": 1,
    "args": {
       "External id": 432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152192131, "dur": 51,
    "args": {
       "External id": 431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152192373,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": 18874368, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152192365, "dur": 18,
    "args": {
       "External id": 436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152192319, "dur": 67,
    "args": {
       "External id": 435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152192434, "dur": 40,
    "args": {
       "External id": 437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152192273, "dur": 203,
    "args": {
       "External id": 434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152192571, "dur": 2,
    "args": {
       "External id": 439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152192526, "dur": 50,
    "args": {
       "External id": 438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152192229, "dur": 353,
    "args": {
       "External id": 433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152192683, "dur": 2,
    "args": {
       "External id": 441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152192637, "dur": 52,
    "args": {
       "External id": 440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152192875,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": 18874368, "Total Allocated": 453573120, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152192869, "dur": 14,
    "args": {
       "External id": 445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152192825, "dur": 61,
    "args": {
       "External id": 444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152192933, "dur": 30,
    "args": {
       "External id": 446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152192780, "dur": 186,
    "args": {
       "External id": 443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152193058, "dur": 2,
    "args": {
       "External id": 448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152193013, "dur": 49,
    "args": {
       "External id": 447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152192735, "dur": 329,
    "args": {
       "External id": 442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193164,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145258921984, "Bytes": 3538944, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152193159, "dur": 12,
    "args": {
       "External id": 450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 36255, "tid": 36255,
    "ts": 1638154152193111, "dur": 89,
    "args": {
       "External id": 449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152193302, "dur": 2,
    "args": {
       "External id": 452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152193253, "dur": 54,
    "args": {
       "External id": 451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193310,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193315,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152192084, "dur": 1236,
    "args": {
       "External id": 430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193336,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382778817408, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193406,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145262460928, "Bytes": 3538944, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 36255, "tid": 36255,
    "ts": 1638154152193395, "dur": 41,
    "args": {
       "External id": 453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193442,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382778817408, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193450,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145258921984, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152193568, "dur": 2,
    "args": {
       "External id": 455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152193518, "dur": 56,
    "args": {
       "External id": 454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152193679, "dur": 1,
    "args": {
       "External id": 457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 36255, "tid": 36255,
    "ts": 1638154152193630, "dur": 54,
    "args": {
       "External id": 456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193748,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382778840512, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193763,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141327872, "Bytes": 512, "Total Allocated": 419363840, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152193771,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94382778840512, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 36255, "tid": 36255,
    "ts": 1638154152193744, "dur": 55,
    "args": {
       "External id": 458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152193961, "dur": 2,
    "args": {
       "External id": 461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152193912, "dur": 55,
    "args": {
       "External id": 460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152194066, "dur": 1,
    "args": {
       "External id": 463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152194016, "dur": 55,
    "args": {
       "External id": 462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152194218,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145265999872, "Bytes": 3538944, "Total Allocated": 422902784, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152194212, "dur": 14,
    "args": {
       "External id": 466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152194165, "dur": 67,
    "args": {
       "External id": 465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152194279, "dur": 35,
    "args": {
       "External id": 467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152194120, "dur": 197,
    "args": {
       "External id": 464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152194474, "dur": 2,
    "args": {
       "External id": 470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152194420, "dur": 61,
    "args": {
       "External id": 469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 36255, "tid": 36255,
    "ts": 1638154152194369, "dur": 140,
    "args": {
       "External id": 468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 36255, "tid": 36255,
    "ts": 1638154152193863, "dur": 650,
    "args": {
       "External id": 459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152194518,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141327872, "Bytes": -512, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152194525,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145262460928, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152194650,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145269538816, "Bytes": 3538944, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 36255, "tid": 36255,
    "ts": 1638154152194643, "dur": 37,
    "args": {
       "External id": 472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 36255, "tid": 36255,
    "ts": 1638154152194586, "dur": 97,
    "args": {
       "External id": 471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152194688,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145265999872, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152194952,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145273077760, "Bytes": 3538944, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152194941, "dur": 20,
    "args": {
       "External id": 476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152194886, "dur": 78,
    "args": {
       "External id": 475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152195080,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141577216, "Bytes": 884736, "Total Allocated": 423787008, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152195071, "dur": 16,
    "args": {
       "External id": 478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152195019, "dur": 71,
    "args": {
       "External id": 477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152194827, "dur": 297,
    "args": {
       "External id": 474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152195128,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141577216, "Bytes": -884736, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152194773, "dur": 360,
    "args": {
       "External id": 473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152195139,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145269538816, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152195294, "dur": 2,
    "args": {
       "External id": 481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152195245, "dur": 55,
    "args": {
       "External id": 480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 36255, "tid": 36255,
    "ts": 1638154152195398, "dur": 4,
    "args": {
       "External id": 483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152195349, "dur": 55,
    "args": {
       "External id": 482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152195499, "dur": 1,
    "args": {
       "External id": 485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 36255, "tid": 36255,
    "ts": 1638154152195451, "dur": 52,
    "args": {
       "External id": 484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152195714,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152195708, "dur": 14,
    "args": {
       "External id": 489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152195661, "dur": 64,
    "args": {
       "External id": 488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152195775, "dur": 33,
    "args": {
       "External id": 490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152195612, "dur": 202,
    "args": {
       "External id": 487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152195913, "dur": 2,
    "args": {
       "External id": 492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152195865, "dur": 53,
    "args": {
       "External id": 491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 36255, "tid": 36255,
    "ts": 1638154152195552, "dur": 368,
    "args": {
       "External id": 486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152196023,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152196018, "dur": 12,
    "args": {
       "External id": 494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 36255, "tid": 36255,
    "ts": 1638154152195967, "dur": 92,
    "args": {
       "External id": 493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152196160, "dur": 2,
    "args": {
       "External id": 496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152196113, "dur": 52,
    "args": {
       "External id": 495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152196168,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152195195, "dur": 979,
    "args": {
       "External id": 479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152196276, "dur": 2,
    "args": {
       "External id": 498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152196228, "dur": 53,
    "args": {
       "External id": 497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152196486,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152196481, "dur": 16,
    "args": {
       "External id": 502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152196433, "dur": 66,
    "args": {
       "External id": 501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 36255, "tid": 36255,
    "ts": 1638154152196549, "dur": 29,
    "args": {
       "External id": 503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 36255, "tid": 36255,
    "ts": 1638154152196379, "dur": 202,
    "args": {
       "External id": 500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 36255, "tid": 36255,
    "ts": 1638154152196335, "dur": 248,
    "args": {
       "External id": 499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152196646, "dur": 5,
    "args": {
       "External id": 504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152196656,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152196893, "dur": 1,
    "args": {
       "External id": 508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152196840, "dur": 57,
    "args": {
       "External id": 507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152196786, "dur": 115,
    "args": {
       "External id": 506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152197008, "dur": 3,
    "args": {
       "External id": 510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197076,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152197068, "dur": 81,
    "args": {
       "External id": 511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152197263, "dur": 2,
    "args": {
       "External id": 513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152197211, "dur": 60,
    "args": {
       "External id": 512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152196955, "dur": 319,
    "args": {
       "External id": 509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152197331, "dur": 32,
    "args": {
       "External id": 514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152196734, "dur": 632,
    "args": {
       "External id": 505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197627,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145277796352, "Bytes": 18874368, "Total Allocated": 475986432, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152197615, "dur": 21,
    "args": {
       "External id": 518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152197553, "dur": 87,
    "args": {
       "External id": 517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197757,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145258921984, "Bytes": 4718592, "Total Allocated": 480705024, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152197748, "dur": 16,
    "args": {
       "External id": 520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152197696, "dur": 71,
    "args": {
       "External id": 519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152197496, "dur": 302,
    "args": {
       "External id": 516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197802,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145258921984, "Bytes": -4718592, "Total Allocated": 475986432, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152197443, "dur": 364,
    "args": {
       "External id": 515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197813,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145240047616, "Bytes": -18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197819,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144038379520, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197829,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197835,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": -18874368, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197840,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": -18874368, "Total Allocated": 381614592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197845,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145273077760, "Bytes": -3538944, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197913,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145296670720, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 36255, "tid": 36255,
    "ts": 1638154152197904, "dur": 37,
    "args": {
       "External id": 521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152197948,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145277796352, "Bytes": -18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152198232,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145277796352, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152198227, "dur": 13,
    "args": {
       "External id": 524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152198301,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": 12288, "Total Allocated": 396962304, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152198296, "dur": 12,
    "args": {
       "External id": 525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152198364,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": 12288, "Total Allocated": 396974592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152198360, "dur": 10,
    "args": {
       "External id": 526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152198461, "dur": 3,
    "args": {
       "External id": 527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152198567, "dur": 1,
    "args": {
       "External id": 528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152198095, "dur": 480,
    "args": {
       "External id": 523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152198579,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": -12288, "Total Allocated": 396962304, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152198584,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": -12288, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152198040, "dur": 548,
    "args": {
       "External id": 522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152198942, "dur": 2,
    "args": {
       "External id": 532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152198888, "dur": 60,
    "args": {
       "External id": 531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152198781, "dur": 171,
    "args": {
       "External id": 530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152199193, "dur": 4,
    "args": {
       "External id": 534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152199268,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141393870848, "Bytes": 75497472, "Total Allocated": 472447488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152199259, "dur": 60,
    "args": {
       "External id": 535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152199474, "dur": 2,
    "args": {
       "External id": 537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152199386, "dur": 93,
    "args": {
       "External id": 536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152199036, "dur": 447,
    "args": {
       "External id": 533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152199560, "dur": 33,
    "args": {
       "External id": 538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152198728, "dur": 868,
    "args": {
       "External id": 529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152199737,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141469368320, "Bytes": 75497472, "Total Allocated": 547944960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 36255, "tid": 36255,
    "ts": 1638154152199727, "dur": 47,
    "args": {
       "External id": 539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152199781,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141393870848, "Bytes": -75497472, "Total Allocated": 472447488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152200142, "dur": 2,
    "args": {
       "External id": 543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152200084, "dur": 64,
    "args": {
       "External id": 542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152200028, "dur": 126,
    "args": {
       "External id": 541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152200361, "dur": 4,
    "args": {
       "External id": 545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152200432,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": 18874368, "Total Allocated": 491321856, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152200424, "dur": 73,
    "args": {
       "External id": 546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152200622, "dur": 2,
    "args": {
       "External id": 548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152200560, "dur": 67,
    "args": {
       "External id": 547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152200309, "dur": 322,
    "args": {
       "External id": 544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 36255, "tid": 36255,
    "ts": 1638154152200687, "dur": 31,
    "args": {
       "External id": 549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152199975, "dur": 749,
    "args": {
       "External id": 540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152200733,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140141469368320, "Bytes": -75497472, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152200991,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": 18874368, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152200979, "dur": 23,
    "args": {
       "External id": 553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152200923, "dur": 82,
    "args": {
       "External id": 552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201130,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": 4718592, "Total Allocated": 439417344, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152201120, "dur": 17,
    "args": {
       "External id": 555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 36255, "tid": 36255,
    "ts": 1638154152201062, "dur": 78,
    "args": {
       "External id": 554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152200865, "dur": 306,
    "args": {
       "External id": 551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201175,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144019505152, "Bytes": -4718592, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 36255, "tid": 36255,
    "ts": 1638154152200812, "dur": 368,
    "args": {
       "External id": 550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201186,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": -18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201192,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145296670720, "Bytes": -18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201201,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144076128256, "Bytes": -18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201206,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145277796352, "Bytes": -18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201211,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144057253888, "Bytes": -18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201217,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144095002624, "Bytes": -18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201389,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": 18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152201384, "dur": 13,
    "args": {
       "External id": 558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201447,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": 12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152201442, "dur": 11,
    "args": {
       "External id": 559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201502,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": 12288, "Total Allocated": 340351488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 36255, "tid": 36255,
    "ts": 1638154152201498, "dur": 10,
    "args": {
       "External id": 560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152201590, "dur": 2,
    "args": {
       "External id": 561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152201645, "dur": 2,
    "args": {
       "External id": 562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152201337, "dur": 316,
    "args": {
       "External id": 557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201656,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141300224, "Bytes": -12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201662,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141312512, "Bytes": -12288, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 36255, "tid": 36255,
    "ts": 1638154152201296, "dur": 372,
    "args": {
       "External id": 556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152201675,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140145219076096, "Bytes": -18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 36255, "tid": 36255,
    "ts": 1638154152201865, "dur": 2,
    "args": {
       "External id": 566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 36255, "tid": 36255,
    "ts": 1638154152201820, "dur": 50,
    "args": {
       "External id": 565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 36255, "tid": 36255,
    "ts": 1638154152201778, "dur": 96,
    "args": {
       "External id": 564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152201957, "dur": 4,
    "args": {
       "External id": 568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202015,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141331456, "Bytes": 122880, "Total Allocated": 321575424, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 36255, "tid": 36255,
    "ts": 1638154152202007, "dur": 50,
    "args": {
       "External id": 569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152202150, "dur": 2,
    "args": {
       "External id": 571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 36255, "tid": 36255,
    "ts": 1638154152202108, "dur": 46,
    "args": {
       "External id": 570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 36255, "tid": 36255,
    "ts": 1638154152201917, "dur": 241,
    "args": {
       "External id": 567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 36255, "tid": 36255,
    "ts": 1638154152201738, "dur": 422,
    "args": {
       "External id": 563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202167,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143998533632, "Bytes": -18874368, "Total Allocated": 302701056, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152202213, "dur": 3,
    "args": {
       "External id": 572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 36255, "tid": 36255,
    "ts": 1638154152202259, "dur": 3,
    "args": {
       "External id": 573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 36255, "tid": 36255,
    "ts": 1638154152202398, "dur": 0,
    "args": {
       "External id": 576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202447,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141577216, "Bytes": 122880, "Total Allocated": 302823936, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 36255, "tid": 36255,
    "ts": 1638154152202441, "dur": 38,
    "args": {
       "External id": 577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 36255, "tid": 36255,
    "ts": 1638154152202358, "dur": 124,
    "args": {
       "External id": 575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202625,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141327872, "Bytes": 512, "Total Allocated": 302824448, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202634,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141328384, "Bytes": 512, "Total Allocated": 302824960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 36255, "tid": 36255,
    "ts": 1638154152202680, "dur": 1,
    "args": {
       "External id": 581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 36255, "tid": 36255,
    "ts": 1638154152202721, "dur": 0,
    "args": {
       "External id": 582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 36255, "tid": 36255,
    "ts": 1638154152202619, "dur": 127,
    "args": {
       "External id": 580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202750,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141328384, "Bytes": -512, "Total Allocated": 302824448, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 36255, "tid": 36255,
    "ts": 1638154152202570, "dur": 185,
    "args": {
       "External id": 579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 36255, "tid": 36255,
    "ts": 1638154152202532, "dur": 225,
    "args": {
       "External id": 578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202760,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141577216, "Bytes": -122880, "Total Allocated": 302701568, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 36255, "tid": 36255,
    "ts": 1638154152202315, "dur": 453,
    "args": {
       "External id": 574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152202776,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140143977562112, "Bytes": -18874368, "Total Allocated": 283827200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 36255, "tid": 36255,
    "ts": 1638154152174217, "dur": 28707,
    "args": {
       "External id": 181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 311
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 36255, "tid": 36255,
    "ts": 1638154152202986, "dur": 1,
    "args": {
       "External id": 583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [14176512]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152203054,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141454336, "Bytes": -122880, "Total Allocated": 283704320, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 36255, "tid": 36255,
    "ts": 1638154152203137,
    "args": {
      "Device Type": 1, "Device Id": 0, "Addr": 140144141327360, "Bytes": -512, "Total Allocated": 283703808, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#6", "pid": 36255, "tid": 36255,
    "ts": 1638154152165665, "dur": 45365,
    "args": {
       "External id": 4,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152166208, "dur": 6,
    "args": {
      "cbid": 138, "correlation": 3862,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 36255, "tid": 36255,
    "ts": 1638154152166215, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3863,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152166219, "dur": 1,
    "args": {
      "cbid": 138, "correlation": 3864,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 36255, "tid": 36255,
    "ts": 1638154152166221, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3865,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638154152166454, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3884, "external id": 14,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.815384615384616
    }
  },
  {
    "ph": "f", "id": 3884, "pid": 0, "tid": 7, "ts": 1638154152166454,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152166429, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 3884,
      "external id": 14, "external ts": 1638154152166419
    }
  },
  {
    "ph": "s", "id": 3884, "pid": 36255, "tid": 36255, "ts": 1638154152166429,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 36255, "tid": 36255,
    "ts": 1638154152166452, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3885,
      "external id": 14, "external ts": 1638154152166419
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 0, "tid": 7,
    "ts": 1638154152166614, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3897, "external id": 18,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.815384615384616
    }
  },
  {
    "ph": "f", "id": 3897, "pid": 0, "tid": 7, "ts": 1638154152166614,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152166587, "dur": 23,
    "args": {
      "cbid": 41, "correlation": 3897,
      "external id": 18, "external ts": 1638154152166582
    }
  },
  {
    "ph": "s", "id": 3897, "pid": 36255, "tid": 36255, "ts": 1638154152166587,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 36255, "tid": 36255,
    "ts": 1638154152166612, "dur": 7,
    "args": {
      "cbid": 131, "correlation": 3898,
      "external id": 18, "external ts": 1638154152166582
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 36255, "tid": 36255,
    "ts": 1638154152166893, "dur": 6,
    "args": {
      "cbid": 165, "correlation": 3902,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152167380, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 3908,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152167386, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 3911,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 36255, "tid": 36255,
    "ts": 1638154152167393, "dur": 2,
    "args": {
      "cbid": 147, "correlation": 3914,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 36255, "tid": 36255,
    "ts": 1638154152167399, "dur": 1,
    "args": {
      "cbid": 136, "correlation": 3917,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638154152174591, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3926, "external id": 185,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.827586206896552
    }
  },
  {
    "ph": "f", "id": 3926, "pid": 0, "tid": 7, "ts": 1638154152174591,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152174570, "dur": 20,
    "args": {
      "cbid": 41, "correlation": 3926,
      "external id": 185, "external ts": 1638154152174560
    }
  },
  {
    "ph": "s", "id": 3926, "pid": 36255, "tid": 36255, "ts": 1638154152174570,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 0, "tid": 7,
    "ts": 1638154152174887, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 3932, "external id": 189,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.827586206896552
    }
  },
  {
    "ph": "f", "id": 3932, "pid": 0, "tid": 7, "ts": 1638154152174887,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152174873, "dur": 12,
    "args": {
      "cbid": 41, "correlation": 3932,
      "external id": 189, "external ts": 1638154152174866
    }
  },
  {
    "ph": "s", "id": 3932, "pid": 36255, "tid": 36255, "ts": 1638154152174873,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 0, "tid": 7,
    "ts": 1638154152175561, "dur": 62,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3945, "external id": 193,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3945, "pid": 0, "tid": 7, "ts": 1638154152175561,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152175536, "dur": 26,
    "args": {
      "cbid": 211, "correlation": 3945,
      "external id": 193, "external ts": 1638154152175383
    }
  },
  {
    "ph": "s", "id": 3945, "pid": 36255, "tid": 36255, "ts": 1638154152175536,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 36255, "tid": 369096448,
    "ts": 1638154152176088, "dur": 8,
    "args": {
      "cbid": 151, "correlation": 3957,
      "external id": 0, "external ts": 1638154152203137
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152176099, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3954, "external id": 201,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3954, "pid": 0, "tid": 7, "ts": 1638154152176099,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152176078, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 3954,
      "external id": 201, "external ts": 1638154152176051
    }
  },
  {
    "ph": "s", "id": 3954, "pid": 36255, "tid": 36255, "ts": 1638154152176078,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 36255, "tid": 369096448,
    "ts": 1638154152176182, "dur": 3,
    "args": {
      "cbid": 151, "correlation": 3965,
      "external id": 0, "external ts": 1638154152203137
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152176652, "dur": 87,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 3987, "external id": 203,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3987, "pid": 0, "tid": 7, "ts": 1638154152176652,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152176631, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 3987,
      "external id": 203, "external ts": 1638154152176249
    }
  },
  {
    "ph": "s", "id": 3987, "pid": 36255, "tid": 36255, "ts": 1638154152176631,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152177051, "dur": 112,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4001, "external id": 209,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4001, "pid": 0, "tid": 7, "ts": 1638154152177051,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152177034, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4001,
      "external id": 209, "external ts": 1638154152176832
    }
  },
  {
    "ph": "s", "id": 4001, "pid": 36255, "tid": 36255, "ts": 1638154152177034,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152177166, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4003, "external id": 209,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4003, "pid": 0, "tid": 7, "ts": 1638154152177166,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152177052, "dur": 12,
    "args": {
      "cbid": 211, "correlation": 4003,
      "external id": 209, "external ts": 1638154152176832
    }
  },
  {
    "ph": "s", "id": 4003, "pid": 36255, "tid": 36255, "ts": 1638154152177052,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152177681, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4010,
      "external id": 221, "external ts": 1638154152177654
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152177687, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 4011,
      "external id": 221, "external ts": 1638154152177654
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152177708, "dur": 2,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4012, "external id": 221,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1428571428571428
    }
  },
  {
    "ph": "f", "id": 4012, "pid": 0, "tid": 7, "ts": 1638154152177708,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152177694, "dur": 12,
    "args": {
      "cbid": 51, "correlation": 4012,
      "external id": 221, "external ts": 1638154152177654
    }
  },
  {
    "ph": "s", "id": 4012, "pid": 36255, "tid": 36255, "ts": 1638154152177694,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152177707, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4013,
      "external id": 221, "external ts": 1638154152177654
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152177732, "dur": 1153,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4014, "external id": 221,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4014, "pid": 0, "tid": 7, "ts": 1638154152177732,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152177715, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4014,
      "external id": 221, "external ts": 1638154152177654
    }
  },
  {
    "ph": "s", "id": 4014, "pid": 36255, "tid": 36255, "ts": 1638154152177715,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152177735, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4016,
      "external id": 221, "external ts": 1638154152177654
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152178888, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4020, "external id": 224,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4020, "pid": 0, "tid": 7, "ts": 1638154152178888,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152177945, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4020,
      "external id": 224, "external ts": 1638154152177930
    }
  },
  {
    "ph": "s", "id": 4020, "pid": 36255, "tid": 36255, "ts": 1638154152177945,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152178565, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4027,
      "external id": 234, "external ts": 1638154152178540
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152178569, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4028,
      "external id": 234, "external ts": 1638154152178540
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152178965, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4029, "external id": 234,
      "bytes": 2304, "memory bandwidth (GB/s)": 3.4285714285714284
    }
  },
  {
    "ph": "f", "id": 4029, "pid": 0, "tid": 7, "ts": 1638154152178965,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152178574, "dur": 12,
    "args": {
      "cbid": 51, "correlation": 4029,
      "external id": 234, "external ts": 1638154152178540
    }
  },
  {
    "ph": "s", "id": 4029, "pid": 36255, "tid": 36255, "ts": 1638154152178574,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152178587, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4030,
      "external id": 234, "external ts": 1638154152178540
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152178968, "dur": 1148,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4031, "external id": 234,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4031, "pid": 0, "tid": 7, "ts": 1638154152178968,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152178594, "dur": 23,
    "args": {
      "cbid": 211, "correlation": 4031,
      "external id": 234, "external ts": 1638154152178540
    }
  },
  {
    "ph": "s", "id": 4031, "pid": 36255, "tid": 36255, "ts": 1638154152178594,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152178620, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4033,
      "external id": 234, "external ts": 1638154152178540
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152180119, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4037, "external id": 237,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4037, "pid": 0, "tid": 7, "ts": 1638154152180119,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152178919, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4037,
      "external id": 237, "external ts": 1638154152178905
    }
  },
  {
    "ph": "s", "id": 4037, "pid": 36255, "tid": 36255, "ts": 1638154152178919,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152179519, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4044,
      "external id": 247, "external ts": 1638154152179493
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152179524, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4045,
      "external id": 247, "external ts": 1638154152179493
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152180196, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4046, "external id": 247,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.4827586206896552
    }
  },
  {
    "ph": "f", "id": 4046, "pid": 0, "tid": 7, "ts": 1638154152180196,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152179529, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4046,
      "external id": 247, "external ts": 1638154152179493
    }
  },
  {
    "ph": "s", "id": 4046, "pid": 36255, "tid": 36255, "ts": 1638154152179529,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152179540, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4047,
      "external id": 247, "external ts": 1638154152179493
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152180199, "dur": 1147,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4048, "external id": 247,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4048, "pid": 0, "tid": 7, "ts": 1638154152180199,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152179546, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4048,
      "external id": 247, "external ts": 1638154152179493
    }
  },
  {
    "ph": "s", "id": 4048, "pid": 36255, "tid": 36255, "ts": 1638154152179546,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152179565, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4050,
      "external id": 247, "external ts": 1638154152179493
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152181347, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4054, "external id": 250,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4054, "pid": 0, "tid": 7, "ts": 1638154152181347,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152179773, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4054,
      "external id": 250, "external ts": 1638154152179760
    }
  },
  {
    "ph": "s", "id": 4054, "pid": 36255, "tid": 36255, "ts": 1638154152179773,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152181424, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4062, "external id": 263,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4062, "pid": 0, "tid": 7, "ts": 1638154152181424,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152180506, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4062,
      "external id": 263, "external ts": 1638154152180494
    }
  },
  {
    "ph": "s", "id": 4062, "pid": 36255, "tid": 36255, "ts": 1638154152180506,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152181501, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4071, "external id": 272,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4071, "pid": 0, "tid": 7, "ts": 1638154152181501,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152181009, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4071,
      "external id": 272, "external ts": 1638154152181000
    }
  },
  {
    "ph": "s", "id": 4071, "pid": 36255, "tid": 36255, "ts": 1638154152181009,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638154152181575, "dur": 238,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4081, "external id": 275,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4081, "pid": 0, "tid": 7, "ts": 1638154152181575,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152181273, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4081,
      "external id": 275, "external ts": 1638154152181198
    }
  },
  {
    "ph": "s", "id": 4081, "pid": 36255, "tid": 36255, "ts": 1638154152181273,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638154152181815, "dur": 9,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4087, "external id": 279,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4087, "pid": 0, "tid": 7, "ts": 1638154152181815,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152181506, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4087,
      "external id": 279, "external ts": 1638154152181484
    }
  },
  {
    "ph": "s", "id": 4087, "pid": 36255, "tid": 36255, "ts": 1638154152181506,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638154152181900, "dur": 0,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4095, "external id": 284,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4095, "pid": 0, "tid": 7, "ts": 1638154152181900,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152181882, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4095,
      "external id": 284, "external ts": 1638154152181847
    }
  },
  {
    "ph": "s", "id": 4095, "pid": 36255, "tid": 36255, "ts": 1638154152181882,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638154152182417, "dur": 9,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4102, "external id": 293,
      "bytes": 3538944, "memory bandwidth (GB/s)": 386.68531468531467
    }
  },
  {
    "ph": "f", "id": 4102, "pid": 0, "tid": 7, "ts": 1638154152182417,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152182393, "dur": 23,
    "args": {
      "cbid": 41, "correlation": 4102,
      "external id": 293, "external ts": 1638154152182387
    }
  },
  {
    "ph": "s", "id": 4102, "pid": 36255, "tid": 36255, "ts": 1638154152182393,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152182611, "dur": 11,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4107, "external id": 294,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4107, "pid": 0, "tid": 7, "ts": 1638154152182611,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152182589, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4107,
      "external id": 294, "external ts": 1638154152182477
    }
  },
  {
    "ph": "s", "id": 4107, "pid": 36255, "tid": 36255, "ts": 1638154152182589,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638154152182788, "dur": 16,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4114, "external id": 298,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4114, "pid": 0, "tid": 7, "ts": 1638154152182788,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152182772, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4114,
      "external id": 298, "external ts": 1638154152182754
    }
  },
  {
    "ph": "s", "id": 4114, "pid": 36255, "tid": 36255, "ts": 1638154152182772,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152183236, "dur": 12,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4136, "external id": 300,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4136, "pid": 0, "tid": 7, "ts": 1638154152183236,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152183220, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4136,
      "external id": 300, "external ts": 1638154152182937
    }
  },
  {
    "ph": "s", "id": 4136, "pid": 36255, "tid": 36255, "ts": 1638154152183220,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152183916, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4144, "external id": 316,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4144, "pid": 0, "tid": 7, "ts": 1638154152183916,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152183898, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4144,
      "external id": 316, "external ts": 1638154152183887
    }
  },
  {
    "ph": "s", "id": 4144, "pid": 36255, "tid": 36255, "ts": 1638154152183898,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638154152184175, "dur": 223,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4154, "external id": 319,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4154, "pid": 0, "tid": 7, "ts": 1638154152184175,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152184160, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4154,
      "external id": 319, "external ts": 1638154152184085
    }
  },
  {
    "ph": "s", "id": 4154, "pid": 36255, "tid": 36255, "ts": 1638154152184160,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152184703, "dur": 72,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4163, "external id": 329,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4163, "pid": 0, "tid": 7, "ts": 1638154152184703,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152184687, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4163,
      "external id": 329, "external ts": 1638154152184677
    }
  },
  {
    "ph": "s", "id": 4163, "pid": 36255, "tid": 36255, "ts": 1638154152184687,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152185222, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4172,
      "external id": 337, "external ts": 1638154152185197
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152185227, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4173,
      "external id": 337, "external ts": 1638154152185197
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152185249, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4174, "external id": 337,
      "bytes": 2304, "memory bandwidth (GB/s)": 5.538461538461538
    }
  },
  {
    "ph": "f", "id": 4174, "pid": 0, "tid": 7, "ts": 1638154152185249,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152185234, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 4174,
      "external id": 337, "external ts": 1638154152185197
    }
  },
  {
    "ph": "s", "id": 4174, "pid": 36255, "tid": 36255, "ts": 1638154152185234,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152185246, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4175,
      "external id": 337, "external ts": 1638154152185197
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152185270, "dur": 1075,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4176, "external id": 337,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4176, "pid": 0, "tid": 7, "ts": 1638154152185270,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152185254, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4176,
      "external id": 337, "external ts": 1638154152185197
    }
  },
  {
    "ph": "s", "id": 4176, "pid": 36255, "tid": 36255, "ts": 1638154152185254,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152185272, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4178,
      "external id": 337, "external ts": 1638154152185197
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152186346, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4182, "external id": 340,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4182, "pid": 0, "tid": 7, "ts": 1638154152186346,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152185472, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4182,
      "external id": 340, "external ts": 1638154152185459
    }
  },
  {
    "ph": "s", "id": 4182, "pid": 36255, "tid": 36255, "ts": 1638154152185472,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152186422, "dur": 85,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4204, "external id": 342,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4204, "pid": 0, "tid": 7, "ts": 1638154152186422,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152185908, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4204,
      "external id": 342, "external ts": 1638154152185633
    }
  },
  {
    "ph": "s", "id": 4204, "pid": 36255, "tid": 36255, "ts": 1638154152185908,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638154152186509, "dur": 105,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4210, "external id": 347,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4210, "pid": 0, "tid": 7, "ts": 1638154152186509,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152186049, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4210,
      "external id": 347, "external ts": 1638154152186030
    }
  },
  {
    "ph": "s", "id": 4210, "pid": 36255, "tid": 36255, "ts": 1638154152186049,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152186617, "dur": 96,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4224, "external id": 349,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4224, "pid": 0, "tid": 7, "ts": 1638154152186617,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152186413, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4224,
      "external id": 349, "external ts": 1638154152186206
    }
  },
  {
    "ph": "s", "id": 4224, "pid": 36255, "tid": 36255, "ts": 1638154152186413,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152186716, "dur": 69,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4226, "external id": 349,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4226, "pid": 0, "tid": 7, "ts": 1638154152186716,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152186429, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 4226,
      "external id": 349, "external ts": 1638154152186206
    }
  },
  {
    "ph": "s", "id": 4226, "pid": 36255, "tid": 36255, "ts": 1638154152186429,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152187032, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4233,
      "external id": 361, "external ts": 1638154152187007
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152187036, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4234,
      "external id": 361, "external ts": 1638154152187007
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638154152187061, "dur": 3965,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4235, "external id": 361,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4235, "pid": 0, "tid": 7, "ts": 1638154152187061,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152187043, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4235,
      "external id": 361, "external ts": 1638154152187007
    }
  },
  {
    "ph": "s", "id": 4235, "pid": 36255, "tid": 36255, "ts": 1638154152187043,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152191029, "dur": 286,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4240, "external id": 364,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4240, "pid": 0, "tid": 7, "ts": 1638154152191029,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152187256, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4240,
      "external id": 364, "external ts": 1638154152187243
    }
  },
  {
    "ph": "s", "id": 4240, "pid": 36255, "tid": 36255, "ts": 1638154152187256,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638154152191317, "dur": 284,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4246, "external id": 365,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4246, "pid": 0, "tid": 7, "ts": 1638154152191317,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152187366, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4246,
      "external id": 365, "external ts": 1638154152187348
    }
  },
  {
    "ph": "s", "id": 4246, "pid": 36255, "tid": 36255, "ts": 1638154152187366,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152187828, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4253,
      "external id": 372, "external ts": 1638154152187804
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152187833, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4254,
      "external id": 372, "external ts": 1638154152187804
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152191605, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4255, "external id": 372,
      "bytes": 1152, "memory bandwidth (GB/s)": 1.2413793103448276
    }
  },
  {
    "ph": "f", "id": 4255, "pid": 0, "tid": 7, "ts": 1638154152191605,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152187840, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 4255,
      "external id": 372, "external ts": 1638154152187804
    }
  },
  {
    "ph": "s", "id": 4255, "pid": 36255, "tid": 36255, "ts": 1638154152187840,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638154152191608, "dur": 3995,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4256, "external id": 372,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4256, "pid": 0, "tid": 7, "ts": 1638154152191608,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152187853, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4256,
      "external id": 372, "external ts": 1638154152187804
    }
  },
  {
    "ph": "s", "id": 4256, "pid": 36255, "tid": 36255, "ts": 1638154152187853,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152187871, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4258,
      "external id": 372, "external ts": 1638154152187804
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152195606, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4262, "external id": 375,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4262, "pid": 0, "tid": 7, "ts": 1638154152195606,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152188065, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4262,
      "external id": 375, "external ts": 1638154152188053
    }
  },
  {
    "ph": "s", "id": 4262, "pid": 36255, "tid": 36255, "ts": 1638154152188065,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152195682, "dur": 84,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4284, "external id": 377,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4284, "pid": 0, "tid": 7, "ts": 1638154152195682,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152188499, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4284,
      "external id": 377, "external ts": 1638154152188227
    }
  },
  {
    "ph": "s", "id": 4284, "pid": 36255, "tid": 36255, "ts": 1638154152188499,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152195768, "dur": 104,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4298, "external id": 383,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4298, "pid": 0, "tid": 7, "ts": 1638154152195768,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152188941, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4298,
      "external id": 383, "external ts": 1638154152188734
    }
  },
  {
    "ph": "s", "id": 4298, "pid": 36255, "tid": 36255, "ts": 1638154152188941,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152195874, "dur": 67,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4300, "external id": 383,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4300, "pid": 0, "tid": 7, "ts": 1638154152195874,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152188961, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 4300,
      "external id": 383, "external ts": 1638154152188734
    }
  },
  {
    "ph": "s", "id": 4300, "pid": 36255, "tid": 36255, "ts": 1638154152188961,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152189551, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4307,
      "external id": 395, "external ts": 1638154152189526
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152189556, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4308,
      "external id": 395, "external ts": 1638154152189526
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152195944, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4309, "external id": 395,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1612903225806452
    }
  },
  {
    "ph": "f", "id": 4309, "pid": 0, "tid": 7, "ts": 1638154152195944,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152189563, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 4309,
      "external id": 395, "external ts": 1638154152189526
    }
  },
  {
    "ph": "s", "id": 4309, "pid": 36255, "tid": 36255, "ts": 1638154152189563,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152189575, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4310,
      "external id": 395, "external ts": 1638154152189526
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152195947, "dur": 1073,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4311, "external id": 395,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4311, "pid": 0, "tid": 7, "ts": 1638154152195947,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152189582, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4311,
      "external id": 395, "external ts": 1638154152189526
    }
  },
  {
    "ph": "s", "id": 4311, "pid": 36255, "tid": 36255, "ts": 1638154152189582,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152189608, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4313,
      "external id": 395, "external ts": 1638154152189526
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152197022, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4317, "external id": 398,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4317, "pid": 0, "tid": 7, "ts": 1638154152197022,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152189808, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4317,
      "external id": 398, "external ts": 1638154152189794
    }
  },
  {
    "ph": "s", "id": 4317, "pid": 36255, "tid": 36255, "ts": 1638154152189808,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152190428, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4324,
      "external id": 408, "external ts": 1638154152190404
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152190432, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4325,
      "external id": 408, "external ts": 1638154152190404
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152197099, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4326, "external id": 408,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.1612903225806452
    }
  },
  {
    "ph": "f", "id": 4326, "pid": 0, "tid": 7, "ts": 1638154152197099,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152190437, "dur": 10,
    "args": {
      "cbid": 51, "correlation": 4326,
      "external id": 408, "external ts": 1638154152190404
    }
  },
  {
    "ph": "s", "id": 4326, "pid": 36255, "tid": 36255, "ts": 1638154152190437,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152190448, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4327,
      "external id": 408, "external ts": 1638154152190404
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152197102, "dur": 1072,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4328, "external id": 408,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4328, "pid": 0, "tid": 7, "ts": 1638154152197102,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152190455, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4328,
      "external id": 408, "external ts": 1638154152190404
    }
  },
  {
    "ph": "s", "id": 4328, "pid": 36255, "tid": 36255, "ts": 1638154152190455,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152190472, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4330,
      "external id": 408, "external ts": 1638154152190404
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152198177, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4334, "external id": 411,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4334, "pid": 0, "tid": 7, "ts": 1638154152198177,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152190675, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4334,
      "external id": 411, "external ts": 1638154152190663
    }
  },
  {
    "ph": "s", "id": 4334, "pid": 36255, "tid": 36255, "ts": 1638154152190675,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152191303, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4341,
      "external id": 421, "external ts": 1638154152191276
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152191308, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4342,
      "external id": 421, "external ts": 1638154152191276
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152198254, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4343, "external id": 421,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.1176470588235294
    }
  },
  {
    "ph": "f", "id": 4343, "pid": 0, "tid": 7, "ts": 1638154152198254,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152191313, "dur": 9,
    "args": {
      "cbid": 51, "correlation": 4343,
      "external id": 421, "external ts": 1638154152191276
    }
  },
  {
    "ph": "s", "id": 4343, "pid": 36255, "tid": 36255, "ts": 1638154152191313,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152191323, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4344,
      "external id": 421, "external ts": 1638154152191276
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152198256, "dur": 1071,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4345, "external id": 421,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4345, "pid": 0, "tid": 7, "ts": 1638154152198256,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152191329, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4345,
      "external id": 421, "external ts": 1638154152191276
    }
  },
  {
    "ph": "s", "id": 4345, "pid": 36255, "tid": 36255, "ts": 1638154152191329,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152191347, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4347,
      "external id": 421, "external ts": 1638154152191276
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152199329, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4351, "external id": 424,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4351, "pid": 0, "tid": 7, "ts": 1638154152199329,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152191538, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4351,
      "external id": 424, "external ts": 1638154152191526
    }
  },
  {
    "ph": "s", "id": 4351, "pid": 36255, "tid": 36255, "ts": 1638154152191538,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152199406, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4359, "external id": 437,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4359, "pid": 0, "tid": 7, "ts": 1638154152199406,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152192447, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4359,
      "external id": 437, "external ts": 1638154152192434
    }
  },
  {
    "ph": "s", "id": 4359, "pid": 36255, "tid": 36255, "ts": 1638154152192447,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152199482, "dur": 71,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4368, "external id": 446,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4368, "pid": 0, "tid": 7, "ts": 1638154152199482,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152192942, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4368,
      "external id": 446, "external ts": 1638154152192933
    }
  },
  {
    "ph": "s", "id": 4368, "pid": 36255, "tid": 36255, "ts": 1638154152192942,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638154152199555, "dur": 224,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4378, "external id": 449,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4378, "pid": 0, "tid": 7, "ts": 1638154152199555,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152193182, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4378,
      "external id": 449, "external ts": 1638154152193111
    }
  },
  {
    "ph": "s", "id": 4378, "pid": 36255, "tid": 36255, "ts": 1638154152193182,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638154152199782, "dur": 9,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4384, "external id": 453,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4384, "pid": 0, "tid": 7, "ts": 1638154152199782,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152193417, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4384,
      "external id": 453, "external ts": 1638154152193395
    }
  },
  {
    "ph": "s", "id": 4384, "pid": 36255, "tid": 36255, "ts": 1638154152193417,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638154152199793, "dur": 1,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4392, "external id": 458,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4392, "pid": 0, "tid": 7, "ts": 1638154152199793,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152193779, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4392,
      "external id": 458, "external ts": 1638154152193744
    }
  },
  {
    "ph": "s", "id": 4392, "pid": 36255, "tid": 36255, "ts": 1638154152193779,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 0, "tid": 7,
    "ts": 1638154152199797, "dur": 7,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4399, "external id": 467,
      "bytes": 3538944, "memory bandwidth (GB/s)": 462.72803347280336
    }
  },
  {
    "ph": "f", "id": 4399, "pid": 0, "tid": 7, "ts": 1638154152199797,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152194286, "dur": 24,
    "args": {
      "cbid": 41, "correlation": 4399,
      "external id": 467, "external ts": 1638154152194279
    }
  },
  {
    "ph": "s", "id": 4399, "pid": 36255, "tid": 36255, "ts": 1638154152194286,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152199806, "dur": 10,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4404, "external id": 468,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4404, "pid": 0, "tid": 7, "ts": 1638154152199806,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152194490, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4404,
      "external id": 468, "external ts": 1638154152194369
    }
  },
  {
    "ph": "s", "id": 4404, "pid": 36255, "tid": 36255, "ts": 1638154152194490,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638154152199819, "dur": 16,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4411, "external id": 472,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4411, "pid": 0, "tid": 7, "ts": 1638154152199819,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152194661, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4411,
      "external id": 472, "external ts": 1638154152194643
    }
  },
  {
    "ph": "s", "id": 4411, "pid": 36255, "tid": 36255, "ts": 1638154152194661,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152199837, "dur": 12,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4433, "external id": 474,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4433, "pid": 0, "tid": 7, "ts": 1638154152199837,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152195103, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4433,
      "external id": 474, "external ts": 1638154152194827
    }
  },
  {
    "ph": "s", "id": 4433, "pid": 36255, "tid": 36255, "ts": 1638154152195103,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152199851, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4441, "external id": 490,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4441, "pid": 0, "tid": 7, "ts": 1638154152199851,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152195787, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4441,
      "external id": 490, "external ts": 1638154152195775
    }
  },
  {
    "ph": "s", "id": 4441, "pid": 36255, "tid": 36255, "ts": 1638154152195787,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 0, "tid": 7,
    "ts": 1638154152199927, "dur": 223,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4451, "external id": 493,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4451, "pid": 0, "tid": 7, "ts": 1638154152199927,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152196041, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4451,
      "external id": 493, "external ts": 1638154152195967
    }
  },
  {
    "ph": "s", "id": 4451, "pid": 36255, "tid": 36255, "ts": 1638154152196041,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152200152, "dur": 73,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4460, "external id": 503,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4460, "pid": 0, "tid": 7, "ts": 1638154152200152,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152196558, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4460,
      "external id": 503, "external ts": 1638154152196549
    }
  },
  {
    "ph": "s", "id": 4460, "pid": 36255, "tid": 36255, "ts": 1638154152196558,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152197093, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4469,
      "external id": 511, "external ts": 1638154152197068
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152197099, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4470,
      "external id": 511, "external ts": 1638154152197068
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152200228, "dur": 1,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4471, "external id": 511,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.057142857142857
    }
  },
  {
    "ph": "f", "id": 4471, "pid": 0, "tid": 7, "ts": 1638154152200228,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152197105, "dur": 12,
    "args": {
      "cbid": 51, "correlation": 4471,
      "external id": 511, "external ts": 1638154152197068
    }
  },
  {
    "ph": "s", "id": 4471, "pid": 36255, "tid": 36255, "ts": 1638154152197105,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152197117, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4472,
      "external id": 511, "external ts": 1638154152197068
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 0, "tid": 7,
    "ts": 1638154152200230, "dur": 1072,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4473, "external id": 511,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4473, "pid": 0, "tid": 7, "ts": 1638154152200230,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152197125, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4473,
      "external id": 511, "external ts": 1638154152197068
    }
  },
  {
    "ph": "s", "id": 4473, "pid": 36255, "tid": 36255, "ts": 1638154152197125,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152197143, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4475,
      "external id": 511, "external ts": 1638154152197068
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152201305, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4479, "external id": 514,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4479, "pid": 0, "tid": 7, "ts": 1638154152201305,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152197344, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4479,
      "external id": 514, "external ts": 1638154152197331
    }
  },
  {
    "ph": "s", "id": 4479, "pid": 36255, "tid": 36255, "ts": 1638154152197344,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152201381, "dur": 83,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4501, "external id": 516,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4501, "pid": 0, "tid": 7, "ts": 1638154152201381,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152197778, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4501,
      "external id": 516, "external ts": 1638154152197496
    }
  },
  {
    "ph": "s", "id": 4501, "pid": 36255, "tid": 36255, "ts": 1638154152197778,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 0, "tid": 7,
    "ts": 1638154152201468, "dur": 105,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4507, "external id": 521,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4507, "pid": 0, "tid": 7, "ts": 1638154152201468,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152197924, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4507,
      "external id": 521, "external ts": 1638154152197904
    }
  },
  {
    "ph": "s", "id": 4507, "pid": 36255, "tid": 36255, "ts": 1638154152197924,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152201574, "dur": 97,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4521, "external id": 523,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4521, "pid": 0, "tid": 7, "ts": 1638154152201574,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152198376, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4521,
      "external id": 523, "external ts": 1638154152198095
    }
  },
  {
    "ph": "s", "id": 4521, "pid": 36255, "tid": 36255, "ts": 1638154152198376,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152201674, "dur": 67,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4523, "external id": 523,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4523, "pid": 0, "tid": 7, "ts": 1638154152201674,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152198394, "dur": 10,
    "args": {
      "cbid": 211, "correlation": 4523,
      "external id": 523, "external ts": 1638154152198095
    }
  },
  {
    "ph": "s", "id": 4523, "pid": 36255, "tid": 36255, "ts": 1638154152198394,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152199285, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4530,
      "external id": 535, "external ts": 1638154152199259
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152199290, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4531,
      "external id": 535, "external ts": 1638154152199259
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638154152201744, "dur": 3961,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4532, "external id": 535,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4532, "pid": 0, "tid": 7, "ts": 1638154152201744,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152199296, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4532,
      "external id": 535, "external ts": 1638154152199259
    }
  },
  {
    "ph": "s", "id": 4532, "pid": 36255, "tid": 36255, "ts": 1638154152199296,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152205708, "dur": 285,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4537, "external id": 538,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4537, "pid": 0, "tid": 7, "ts": 1638154152205708,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152199573, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4537,
      "external id": 538, "external ts": 1638154152199560
    }
  },
  {
    "ph": "s", "id": 4537, "pid": 36255, "tid": 36255, "ts": 1638154152199573,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 0, "tid": 7,
    "ts": 1638154152205995, "dur": 284,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4543, "external id": 539,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4543, "pid": 0, "tid": 7, "ts": 1638154152205995,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152199754, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4543,
      "external id": 539, "external ts": 1638154152199727
    }
  },
  {
    "ph": "s", "id": 4543, "pid": 36255, "tid": 36255, "ts": 1638154152199754,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 36255, "tid": 369096448,
    "ts": 1638154152199996, "dur": 8,
    "args": {
      "cbid": 151, "correlation": 4549,
      "external id": 0, "external ts": 1638154152203137
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 36255, "tid": 369096448,
    "ts": 1638154152200068, "dur": 3,
    "args": {
      "cbid": 151, "correlation": 4555,
      "external id": 0, "external ts": 1638154152203137
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152200448, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4562,
      "external id": 546, "external ts": 1638154152200424
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152200454, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4563,
      "external id": 546, "external ts": 1638154152200424
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 0, "tid": 7,
    "ts": 1638154152206284, "dur": 0,
    "args": {
      "device": 0, "context": 1,
      "stream": 7, "correlation": 4564, "external id": 546,
      "bytes": 1152, "memory bandwidth (GB/s)": 18.0
    }
  },
  {
    "ph": "f", "id": 4564, "pid": 0, "tid": 7, "ts": 1638154152206284,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 36255, "tid": 36255,
    "ts": 1638154152200460, "dur": 12,
    "args": {
      "cbid": 51, "correlation": 4564,
      "external id": 546, "external ts": 1638154152200424
    }
  },
  {
    "ph": "s", "id": 4564, "pid": 36255, "tid": 36255, "ts": 1638154152200460,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 0, "tid": 7,
    "ts": 1638154152206286, "dur": 4001,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4565, "external id": 546,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4565, "pid": 0, "tid": 7, "ts": 1638154152206286,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152200474, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4565,
      "external id": 546, "external ts": 1638154152200424
    }
  },
  {
    "ph": "s", "id": 4565, "pid": 36255, "tid": 36255, "ts": 1638154152200474,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152200492, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4567,
      "external id": 546, "external ts": 1638154152200424
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 0, "tid": 7,
    "ts": 1638154152210290, "dur": 74,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4571, "external id": 549,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4571, "pid": 0, "tid": 7, "ts": 1638154152210290,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152200700, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4571,
      "external id": 549, "external ts": 1638154152200687
    }
  },
  {
    "ph": "s", "id": 4571, "pid": 36255, "tid": 36255, "ts": 1638154152200700,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 0, "tid": 7,
    "ts": 1638154152210368, "dur": 86,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4593, "external id": 551,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4593, "pid": 0, "tid": 7, "ts": 1638154152210368,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152201151, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4593,
      "external id": 551, "external ts": 1638154152200865
    }
  },
  {
    "ph": "s", "id": 4593, "pid": 36255, "tid": 36255, "ts": 1638154152201151,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152210456, "dur": 104,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4607, "external id": 557,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4607, "pid": 0, "tid": 7, "ts": 1638154152210456,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152201514, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4607,
      "external id": 557, "external ts": 1638154152201337
    }
  },
  {
    "ph": "s", "id": 4607, "pid": 36255, "tid": 36255, "ts": 1638154152201514,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 0, "tid": 7,
    "ts": 1638154152210562, "dur": 68,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4609, "external id": 557,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4609, "pid": 0, "tid": 7, "ts": 1638154152210562,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152201532, "dur": 11,
    "args": {
      "cbid": 211, "correlation": 4609,
      "external id": 557, "external ts": 1638154152201337
    }
  },
  {
    "ph": "s", "id": 4609, "pid": 36255, "tid": 36255, "ts": 1638154152201532,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152202031, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4616,
      "external id": 569, "external ts": 1638154152202007
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 0, "tid": 7,
    "ts": 1638154152210633, "dur": 75,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4617, "external id": 569,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 4617, "pid": 0, "tid": 7, "ts": 1638154152210633,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152202036, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4617,
      "external id": 569, "external ts": 1638154152202007
    }
  },
  {
    "ph": "s", "id": 4617, "pid": 36255, "tid": 36255, "ts": 1638154152202036,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 0, "tid": 7,
    "ts": 1638154152210711, "dur": 2,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4624, "external id": 577,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 4624, "pid": 0, "tid": 7, "ts": 1638154152210711,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152202459, "dur": 16,
    "args": {
      "cbid": 211, "correlation": 4624,
      "external id": 577, "external ts": 1638154152202441
    }
  },
  {
    "ph": "s", "id": 4624, "pid": 36255, "tid": 36255, "ts": 1638154152202459,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 0, "tid": 7,
    "ts": 1638154152210716, "dur": 45,
    "args": {
      "queued": 0, "device": 0, "context": 1,
      "stream": 7, "correlation": 4631, "external id": 580,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4631, "pid": 0, "tid": 7, "ts": 1638154152210716,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 36255, "tid": 36255,
    "ts": 1638154152202727, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4631,
      "external id": 580, "external ts": 1638154152202619
    }
  },
  {
    "ph": "s", "id": 4631, "pid": 36255, "tid": 36255, "ts": 1638154152202727,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152203067, "dur": 2,
    "args": {
      "cbid": 134, "correlation": 4636,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152203070, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4637,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 36255, "tid": 36255,
    "ts": 1638154152203076, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4639,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 36255, "tid": 36255,
    "ts": 1638154152203084, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 4643,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 36255, "tid": 36255,
    "ts": 1638154152203086, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4644,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 36255, "tid": 36255,
    "ts": 1638154152203168, "dur": 7596,
    "args": {
      "cbid": 165, "correlation": 4648,
      "external id": 4, "external ts": 1638154152165665
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 36255, "tid": 36255,
    "ts": 1638154152211068, "dur": 5,
    "args": {
      "cbid": 165, "correlation": 4651,
      "external id": 0, "external ts": 1638154152203137
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 36255, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 36255, "tid": 0,
    "args": {
      "labels": "CPU"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 36255, "tid": 0,
    "args": {
      "sort_index": 36255
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 0, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 0, "tid": 0,
    "args": {
      "labels": "GPU 0"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 0, "tid": 0,
    "args": {
      "sort_index": 16777216
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 1, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 1, "tid": 0,
    "args": {
      "labels": "GPU 1"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 1, "tid": 0,
    "args": {
      "sort_index": 16777217
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 2, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 2, "tid": 0,
    "args": {
      "labels": "GPU 2"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 2, "tid": 0,
    "args": {
      "sort_index": 16777218
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 3, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 3, "tid": 0,
    "args": {
      "labels": "GPU 3"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 3, "tid": 0,
    "args": {
      "sort_index": 16777219
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 4, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 4, "tid": 0,
    "args": {
      "labels": "GPU 4"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 4, "tid": 0,
    "args": {
      "sort_index": 16777220
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 5, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 5, "tid": 0,
    "args": {
      "labels": "GPU 5"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 5, "tid": 0,
    "args": {
      "sort_index": 16777221
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 6, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 6, "tid": 0,
    "args": {
      "labels": "GPU 6"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 6, "tid": 0,
    "args": {
      "sort_index": 16777222
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154152165226, "pid": 7, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154152165226, "pid": 7, "tid": 0,
    "args": {
      "labels": "GPU 7"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 7, "tid": 0,
    "args": {
      "sort_index": 16777223
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638154152165226, "pid": 0, "tid": 7,
    "args": {
      "name": "stream 7"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 0, "tid": 7,
    "args": {
      "sort_index": 7
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638154152165226, "pid": 36255, "tid": 36255,
    "args": {
      "name": "thread 36255 (python)"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638154152165226, "pid": 36255, "tid": 36255,
    "args": {
      "sort_index": 36255
    }
  },
  {
    "ph": "X", "cat": "Trace", "ts": 1638154152165226, "dur": 45857,
    "pid": "Spans", "tid": "PyTorch Profiler",
    "name": "PyTorch Profiler (0)",
    "args": {
      "Op count": 0
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154152165226,
    "pid": "Spans", "tid": 0,
    "args": {
      "sort_index": 536870912
    }
  },
  {
    "name": "Iteration Start: PyTorch Profiler", "ph": "i", "s": "g",
    "pid": "Traces", "tid": "Trace PyTorch Profiler", "ts": 1638154152165226
  },
  {
    "name": "Record Window End", "ph": "i", "s": "g",
    "pid": "", "tid": "", "ts": 1638154152216988
  }
]}