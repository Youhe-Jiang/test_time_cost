
{
  "schemaVersion": 1,
  "distributedInfo": {"backend": "nccl", "rank": 3, "world_size": 4},
  "deviceProperties": [
    {
      "id": 0, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 1, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 2, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    },
    {
      "id": 3, "name": "GeForce RTX 2080 Ti", "totalGlobalMem": 11554717696,
      "computeMajor": 7, "computeMinor": 5,
      "maxThreadsPerBlock": 1024, "maxThreadsPerMultiprocessor": 1024,
      "regsPerBlock": 65536, "regsPerMultiprocessor": 65536, "warpSize": 32,
      "sharedMemPerBlock": 49152, "sharedMemPerMultiprocessor": 65536,
      "numSms": 68, "sharedMemPerBlockOptin": 65536
    }
  ],
  "traceEvents": [
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233175676,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94712015182080, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233175665, "dur": 60,
    "args": {
       "External id": 2,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 37628, "tid": 37628,
    "ts": 1638154233175796, "dur": 2,
    "args": {
       "External id": 3,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 37628, "tid": 37628,
    "ts": 1638154233175571, "dur": 234,
    "args": {
       "External id": 1,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(329): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176059,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132293184, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233176056, "dur": 15,
    "args": {
       "External id": 5,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176076,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132293184, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176092,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94712015182080, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176267,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132266368, "Bytes": 4, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233176265, "dur": 16,
    "args": {
       "External id": 7,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zero_", "pid": 37628, "tid": 37628,
    "ts": 1638154233176348, "dur": 2,
    "args": {
       "External id": 8,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::zeros", "pid": 37628, "tid": 37628,
    "ts": 1638154233176187, "dur": 166,
    "args": {
       "External id": 6,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(432): __init__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176536,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132301056, "Bytes": 16, "Total Allocated": 20, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233176534, "dur": 10,
    "args": {
       "External id": 10,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176548,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132301056, "Bytes": -16, "Total Allocated": 4, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233176598,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132266368, "Bytes": -4, "Total Allocated": 0, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "enumerate(DataLoader)#_MultiProcessingDataLoaderIter.__next__", "pid": 37628, "tid": 37628,
    "ts": 1638154233176487, "dur": 448,
    "args": {
       "External id": 9,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/utils/data/dataloader.py(518): __next__;/miniconda/lib/python3.8/site-packages/tqdm/std.py(1178): __iter__;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(166): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233177174,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545490432, "Bytes": -24576, "Total Allocated": 283679232, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233177186,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545515008, "Bytes": -24576, "Total Allocated": 283654656, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233177564,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545490432, "Bytes": 24576, "Total Allocated": 283679232, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233177544, "dur": 33,
    "args": {
       "External id": 13,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233177659, "dur": 69,
    "args": {
       "External id": 14,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 37628, "tid": 37628,
    "ts": 1638154233177494, "dur": 239,
    "args": {
       "External id": 12,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233177438, "dur": 298,
    "args": {
       "External id": 11,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(167): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233177867,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545515008, "Bytes": 24576, "Total Allocated": 283703808, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233177850, "dur": 30,
    "args": {
       "External id": 17,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233177920, "dur": 46,
    "args": {
       "External id": 18,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 37628, "tid": 37628,
    "ts": 1638154233177816, "dur": 153,
    "args": {
       "External id": 16,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233177781, "dur": 191,
    "args": {
       "External id": 15,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(168): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233178241, "dur": 2,
    "args": {
       "External id": 19,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233178314, "dur": 1,
    "args": {
       "External id": 20,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233178507, "dur": 1,
    "args": {
       "External id": 21,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(479): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233178561, "dur": 1,
    "args": {
       "External id": 22,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(481): _cast_buffers;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(961): _lazy_init;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1117): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 37628, "tid": 37628,
    "ts": 1638154233178963, "dur": 1,
    "args": {
       "External id": 23,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[14176512], [56706048]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1570): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233179108, "dur": 3,
    "args": {
       "External id": 25,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233179049, "dur": 70,
    "args": {
       "External id": 24,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233179197, "dur": 7,
    "args": {
       "External id": 26,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 37628, "tid": 37628,
    "ts": 1638154233179259, "dur": 1,
    "args": {
       "External id": 27,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [56706048]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1573): update_p_data;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1578): _rebuild_full_params;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1135): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233179635, "dur": 3,
    "args": {
       "External id": 31,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233179562, "dur": 80,
    "args": {
       "External id": 30,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233179498, "dur": 148,
    "args": {
       "External id": 29,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233179816, "dur": 2,
    "args": {
       "External id": 34,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233179759, "dur": 62,
    "args": {
       "External id": 33,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233179702, "dur": 122,
    "args": {
       "External id": 32,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233179992, "dur": 1,
    "args": {
       "External id": 37,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233179936, "dur": 61,
    "args": {
       "External id": 36,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233179882, "dur": 118,
    "args": {
       "External id": 35,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233180166, "dur": 1,
    "args": {
       "External id": 40,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233180110, "dur": 61,
    "args": {
       "External id": 39,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233180057, "dur": 117,
    "args": {
       "External id": 38,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233180341, "dur": 1,
    "args": {
       "External id": 43,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233180288, "dur": 58,
    "args": {
       "External id": 42,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233180231, "dur": 118,
    "args": {
       "External id": 41,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233180514, "dur": 2,
    "args": {
       "External id": 46,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233180462, "dur": 60,
    "args": {
       "External id": 45,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233180406, "dur": 119,
    "args": {
       "External id": 44,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233180709, "dur": 2,
    "args": {
       "External id": 49,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233180651, "dur": 63,
    "args": {
       "External id": 48,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233180579, "dur": 138,
    "args": {
       "External id": 47,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233180882, "dur": 2,
    "args": {
       "External id": 52,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233180827, "dur": 60,
    "args": {
       "External id": 51,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233180771, "dur": 119,
    "args": {
       "External id": 50,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233181055, "dur": 2,
    "args": {
       "External id": 55,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233181000, "dur": 61,
    "args": {
       "External id": 54,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233180944, "dur": 120,
    "args": {
       "External id": 53,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233181275, "dur": 1,
    "args": {
       "External id": 58,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233181221, "dur": 59,
    "args": {
       "External id": 57,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233181167, "dur": 116,
    "args": {
       "External id": 56,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233181449, "dur": 1,
    "args": {
       "External id": 61,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233181395, "dur": 58,
    "args": {
       "External id": 60,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233181338, "dur": 118,
    "args": {
       "External id": 59,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233181631, "dur": 6,
    "args": {
       "External id": 64,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233181570, "dur": 71,
    "args": {
       "External id": 63,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233181514, "dur": 130,
    "args": {
       "External id": 62,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233181811, "dur": 1,
    "args": {
       "External id": 67,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233181755, "dur": 61,
    "args": {
       "External id": 66,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233181699, "dur": 120,
    "args": {
       "External id": 65,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233181987, "dur": 1,
    "args": {
       "External id": 70,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233181931, "dur": 64,
    "args": {
       "External id": 69,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233181873, "dur": 125,
    "args": {
       "External id": 68,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233182165, "dur": 2,
    "args": {
       "External id": 73,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233182109, "dur": 61,
    "args": {
       "External id": 72,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233182056, "dur": 117,
    "args": {
       "External id": 71,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233182339, "dur": 1,
    "args": {
       "External id": 76,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233182283, "dur": 61,
    "args": {
       "External id": 75,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233182230, "dur": 117,
    "args": {
       "External id": 74,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233182514, "dur": 1,
    "args": {
       "External id": 79,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233182460, "dur": 58,
    "args": {
       "External id": 78,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233182404, "dur": 117,
    "args": {
       "External id": 77,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233182695, "dur": 6,
    "args": {
       "External id": 82,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233182641, "dur": 63,
    "args": {
       "External id": 81,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233182579, "dur": 128,
    "args": {
       "External id": 80,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233182877, "dur": 1,
    "args": {
       "External id": 85,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233182817, "dur": 68,
    "args": {
       "External id": 84,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233182762, "dur": 126,
    "args": {
       "External id": 83,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233183054, "dur": 1,
    "args": {
       "External id": 88,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233182998, "dur": 61,
    "args": {
       "External id": 87,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233182942, "dur": 120,
    "args": {
       "External id": 86,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233183227, "dur": 2,
    "args": {
       "External id": 91,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233183172, "dur": 60,
    "args": {
       "External id": 90,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233183119, "dur": 116,
    "args": {
       "External id": 89,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233183401, "dur": 1,
    "args": {
       "External id": 94,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233183345, "dur": 61,
    "args": {
       "External id": 93,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233183293, "dur": 116,
    "args": {
       "External id": 92,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233183582, "dur": 1,
    "args": {
       "External id": 97,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233183529, "dur": 58,
    "args": {
       "External id": 96,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233183474, "dur": 116,
    "args": {
       "External id": 95,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233183771, "dur": 2,
    "args": {
       "External id": 100,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233183715, "dur": 61,
    "args": {
       "External id": 99,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233183657, "dur": 122,
    "args": {
       "External id": 98,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233183945, "dur": 1,
    "args": {
       "External id": 103,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233183889, "dur": 61,
    "args": {
       "External id": 102,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233183834, "dur": 119,
    "args": {
       "External id": 101,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233184118, "dur": 1,
    "args": {
       "External id": 106,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233184062, "dur": 60,
    "args": {
       "External id": 105,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233184007, "dur": 118,
    "args": {
       "External id": 104,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233184293, "dur": 1,
    "args": {
       "External id": 109,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233184235, "dur": 63,
    "args": {
       "External id": 108,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233184183, "dur": 117,
    "args": {
       "External id": 107,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233184466, "dur": 1,
    "args": {
       "External id": 112,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233184410, "dur": 60,
    "args": {
       "External id": 111,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233184358, "dur": 115,
    "args": {
       "External id": 110,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233184650, "dur": 2,
    "args": {
       "External id": 115,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233184586, "dur": 69,
    "args": {
       "External id": 114,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233184530, "dur": 128,
    "args": {
       "External id": 113,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233184829, "dur": 1,
    "args": {
       "External id": 118,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233184771, "dur": 62,
    "args": {
       "External id": 117,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233184715, "dur": 121,
    "args": {
       "External id": 116,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233185002, "dur": 2,
    "args": {
       "External id": 121,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233184947, "dur": 117,
    "args": {
       "External id": 120,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233184891, "dur": 176,
    "args": {
       "External id": 119,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233185233, "dur": 1,
    "args": {
       "External id": 124,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233185179, "dur": 59,
    "args": {
       "External id": 123,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233185125, "dur": 116,
    "args": {
       "External id": 122,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233185404, "dur": 1,
    "args": {
       "External id": 127,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233185350, "dur": 58,
    "args": {
       "External id": 126,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233185296, "dur": 115,
    "args": {
       "External id": 125,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233185576, "dur": 1,
    "args": {
       "External id": 130,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233185520, "dur": 60,
    "args": {
       "External id": 129,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233185466, "dur": 127,
    "args": {
       "External id": 128,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233185771, "dur": 2,
    "args": {
       "External id": 133,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233185718, "dur": 62,
    "args": {
       "External id": 132,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233185661, "dur": 122,
    "args": {
       "External id": 131,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233185949, "dur": 2,
    "args": {
       "External id": 136,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233185893, "dur": 61,
    "args": {
       "External id": 135,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233185837, "dur": 120,
    "args": {
       "External id": 134,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233186123, "dur": 1,
    "args": {
       "External id": 139,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233186067, "dur": 61,
    "args": {
       "External id": 138,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::narrow", "pid": 37628, "tid": 37628,
    "ts": 1638154233186012, "dur": 118,
    "args": {
       "External id": 137,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::split_with_sizes", "pid": 37628, "tid": 37628,
    "ts": 1638154233179424, "dur": 6759,
    "args": {
       "External id": 28,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/_tensor.py(518): split;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(472): get_param_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(343): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Int"], "Fwd thread id": 0, "Sequence number": 273
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186266, "dur": 11,
    "args": {
       "External id": 140,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9216], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 274
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186347, "dur": 7,
    "args": {
       "External id": 141,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 275
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186418, "dur": 6,
    "args": {
       "External id": 142,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 276
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186493, "dur": 6,
    "args": {
       "External id": 143,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 277
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186559, "dur": 12,
    "args": {
       "External id": 144,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 278
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186641, "dur": 7,
    "args": {
       "External id": 145,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 279
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186711, "dur": 6,
    "args": {
       "External id": 146,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 280
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186780, "dur": 6,
    "args": {
       "External id": 147,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 281
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186845, "dur": 9,
    "args": {
       "External id": 148,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 282
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186914, "dur": 5,
    "args": {
       "External id": 149,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 283
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233186981, "dur": 6,
    "args": {
       "External id": 150,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 284
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187049, "dur": 6,
    "args": {
       "External id": 151,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 285
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187117, "dur": 6,
    "args": {
       "External id": 152,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 286
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187184, "dur": 6,
    "args": {
       "External id": 153,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 287
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187248, "dur": 9,
    "args": {
       "External id": 154,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 288
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187315, "dur": 8,
    "args": {
       "External id": 155,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 289
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187381, "dur": 7,
    "args": {
       "External id": 156,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 290
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187452, "dur": 6,
    "args": {
       "External id": 157,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 291
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187518, "dur": 6,
    "args": {
       "External id": 158,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 292
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187586, "dur": 6,
    "args": {
       "External id": 159,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 293
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187664, "dur": 7,
    "args": {
       "External id": 160,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 294
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187729, "dur": 9,
    "args": {
       "External id": 161,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 295
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187796, "dur": 6,
    "args": {
       "External id": 162,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 296
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187868, "dur": 6,
    "args": {
       "External id": 163,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 297
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233187935, "dur": 6,
    "args": {
       "External id": 164,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 298
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188003, "dur": 6,
    "args": {
       "External id": 165,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 299
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188071, "dur": 6,
    "args": {
       "External id": 166,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 300
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188135, "dur": 8,
    "args": {
       "External id": 167,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 301
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188209, "dur": 9,
    "args": {
       "External id": 168,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[2359296], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 302
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188278, "dur": 6,
    "args": {
       "External id": 169,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 303
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188345, "dur": 7,
    "args": {
       "External id": 170,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 304
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188413, "dur": 6,
    "args": {
       "External id": 171,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 305
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188484, "dur": 6,
    "args": {
       "External id": 172,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[9437184], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 306
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188548, "dur": 9,
    "args": {
       "External id": 173,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 307
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188640, "dur": 10,
    "args": {
       "External id": 174,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 308
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188710, "dur": 6,
    "args": {
       "External id": 175,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 309
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233188780, "dur": 6,
    "args": {
       "External id": 176,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[15360], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(91): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(345): _unflatten_params_as_views;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(458): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"], "Fwd thread id": 0, "Sequence number": 310
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233188971, "dur": 5,
    "args": {
       "External id": 177,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233189046, "dur": 1,
    "args": {
       "External id": 178,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "Int", "Bool", "Bool", ""], "Fwd thread id": 0, "Sequence number": 311
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "detach_", "pid": 37628, "tid": 37628,
    "ts": 1638154233189151, "dur": 2,
    "args": {
       "External id": 180,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::detach_", "pid": 37628, "tid": 37628,
    "ts": 1638154233189107, "dur": 49,
    "args": {
       "External id": 179,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(188): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"], "Fwd thread id": 0, "Sequence number": 311
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233189256,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715132777984, "Bytes": 5056, "Total Allocated": 5056, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233189302,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94713184103232, "Bytes": 816, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233189508, "dur": 16,
    "args": {
       "External id": 184,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233189581, "dur": 60,
    "args": {
       "External id": 185,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 37628, "tid": 37628,
    "ts": 1638154233189452, "dur": 194,
    "args": {
       "External id": 183,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233189398, "dur": 257,
    "args": {
       "External id": 182,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233189824, "dur": 10,
    "args": {
       "External id": 188,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233189888, "dur": 28,
    "args": {
       "External id": 189,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "long int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_to_copy", "pid": 37628, "tid": 37628,
    "ts": 1638154233189771, "dur": 149,
    "args": {
       "External id": 187,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233189719, "dur": 204,
    "args": {
       "External id": 186,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): <genexpr>;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(270): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 37628, "tid": 37628,
    "ts": 1638154233190215, "dur": 3,
    "args": {
       "External id": 192,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233190146, "dur": 77,
    "args": {
       "External id": 191,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233190374, "dur": 11,
    "args": {
       "External id": 194,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233190478,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382495047680, "Bytes": 18874368, "Total Allocated": 302578176, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 37628, "tid": 37628,
    "ts": 1638154233190467, "dur": 24,
    "args": {
       "External id": 195,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[0], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::index_select", "pid": 37628, "tid": 37628,
    "ts": 1638154233190306, "dur": 240,
    "args": {
       "External id": 193,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [3072]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "long int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233190628, "dur": 4,
    "args": {
       "External id": 196,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::embedding", "pid": 37628, "tid": 37628,
    "ts": 1638154233190075, "dur": 563,
    "args": {
       "External id": 190,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [512, 6], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2044): embedding;/miniconda/lib/python3.8/site-packages/torch/nn/modules/sparse.py(158): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(126): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "Int", "Bool", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233190770, "dur": 2,
    "args": {
       "External id": 198,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233190715, "dur": 69,
    "args": {
       "External id": 197,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233190892, "dur": 1,
    "args": {
       "External id": 200,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233190838, "dur": 60,
    "args": {
       "External id": 199,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 6, 1536], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(128): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233191011,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": 18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 37628, "tid": 37628,
    "ts": 1638154233190995, "dur": 73,
    "args": {
       "External id": 201,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233191425,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382914478080, "Bytes": 18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233191409, "dur": 29,
    "args": {
       "External id": 205,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233191346, "dur": 97,
    "args": {
       "External id": 204,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233191580,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": 4718592, "Total Allocated": 345045504, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233191567, "dur": 24,
    "args": {
       "External id": 207,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233191507, "dur": 88,
    "args": {
       "External id": 206,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233191268, "dur": 381,
    "args": {
       "External id": 203,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233191655,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": -4718592, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233191181, "dur": 482,
    "args": {
       "External id": 202,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(129): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233191676,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": -18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233191996,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": 18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233191988, "dur": 19,
    "args": {
       "External id": 210,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233192091,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": 12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233192084, "dur": 17,
    "args": {
       "External id": 211,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233192181,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": 12288, "Total Allocated": 340351488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233192175, "dur": 15,
    "args": {
       "External id": 212,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233192316, "dur": 4,
    "args": {
       "External id": 213,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233192394, "dur": 2,
    "args": {
       "External id": 214,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233191909, "dur": 496,
    "args": {
       "External id": 209,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233192410,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": -12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233192418,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": -12288, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233191822, "dur": 602,
    "args": {
       "External id": 208,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233192821, "dur": 3,
    "args": {
       "External id": 218,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233192743, "dur": 88,
    "args": {
       "External id": 217,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233192648, "dur": 189,
    "args": {
       "External id": 216,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233193002, "dur": 5,
    "args": {
       "External id": 220,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233193117,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": 18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233193105, "dur": 121,
    "args": {
       "External id": 221,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233193422, "dur": 3,
    "args": {
       "External id": 223,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233193342, "dur": 87,
    "args": {
       "External id": 222,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233192927, "dur": 507,
    "args": {
       "External id": 219,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233193521, "dur": 49,
    "args": {
       "External id": 224,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233192554, "dur": 1020,
    "args": {
       "External id": 215,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233193670, "dur": 7,
    "args": {
       "External id": 225,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233193825, "dur": 3,
    "args": {
       "External id": 227,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233193753, "dur": 81,
    "args": {
       "External id": 226,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233194165, "dur": 1,
    "args": {
       "External id": 231,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233194088, "dur": 83,
    "args": {
       "External id": 230,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233194012, "dur": 163,
    "args": {
       "External id": 229,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233194330, "dur": 4,
    "args": {
       "External id": 233,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233194428,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233194417, "dur": 106,
    "args": {
       "External id": 234,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233194818, "dur": 3,
    "args": {
       "External id": 236,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233194743, "dur": 82,
    "args": {
       "External id": 235,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233194253, "dur": 577,
    "args": {
       "External id": 232,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233194907, "dur": 46,
    "args": {
       "External id": 237,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233193936, "dur": 1022,
    "args": {
       "External id": 228,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233195039, "dur": 6,
    "args": {
       "External id": 238,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233195185, "dur": 3,
    "args": {
       "External id": 240,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233195118, "dur": 75,
    "args": {
       "External id": 239,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233195512, "dur": 1,
    "args": {
       "External id": 244,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233195438, "dur": 79,
    "args": {
       "External id": 243,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233195365, "dur": 157,
    "args": {
       "External id": 242,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233195684, "dur": 4,
    "args": {
       "External id": 246,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233195780,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233195769, "dur": 106,
    "args": {
       "External id": 247,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233196044, "dur": 3,
    "args": {
       "External id": 249,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233195965, "dur": 86,
    "args": {
       "External id": 248,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233195609, "dur": 447,
    "args": {
       "External id": 245,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233196134, "dur": 42,
    "args": {
       "External id": 250,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233195292, "dur": 889,
    "args": {
       "External id": 241,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233196264, "dur": 6,
    "args": {
       "External id": 251,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233196412, "dur": 3,
    "args": {
       "External id": 253,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233196342, "dur": 79,
    "args": {
       "External id": 252,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233196563, "dur": 2,
    "args": {
       "External id": 255,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233196495, "dur": 75,
    "args": {
       "External id": 254,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233196818, "dur": 3,
    "args": {
       "External id": 258,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233196749, "dur": 80,
    "args": {
       "External id": 257,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233197122,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": 18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233197112, "dur": 25,
    "args": {
       "External id": 262,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233197043, "dur": 101,
    "args": {
       "External id": 261,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233197214, "dur": 48,
    "args": {
       "External id": 263,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233196974, "dur": 293,
    "args": {
       "External id": 260,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233197408, "dur": 4,
    "args": {
       "External id": 265,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233197341, "dur": 75,
    "args": {
       "External id": 264,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233196900, "dur": 519,
    "args": {
       "External id": 259,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233197562, "dur": 2,
    "args": {
       "External id": 267,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233197490, "dur": 80,
    "args": {
       "External id": 266,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233197861,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": 18874368, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233197853, "dur": 20,
    "args": {
       "External id": 271,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233197785, "dur": 94,
    "args": {
       "External id": 270,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233197951, "dur": 39,
    "args": {
       "External id": 272,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233197720, "dur": 274,
    "args": {
       "External id": 269,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233198134, "dur": 3,
    "args": {
       "External id": 274,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233198066, "dur": 75,
    "args": {
       "External id": 273,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233197652, "dur": 492,
    "args": {
       "External id": 268,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198309,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": 3538944, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233198302, "dur": 20,
    "args": {
       "External id": 276,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 37628, "tid": 37628,
    "ts": 1638154233198229, "dur": 134,
    "args": {
       "External id": 275,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233198505, "dur": 3,
    "args": {
       "External id": 278,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233198438, "dur": 74,
    "args": {
       "External id": 277,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198517,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198526,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": -18874368, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233196657, "dur": 1876,
    "args": {
       "External id": 256,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198556,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715133334912, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198681,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": 3538944, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 37628, "tid": 37628,
    "ts": 1638154233198664, "dur": 60,
    "args": {
       "External id": 279,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198734,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715133334912, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233198744,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233198914, "dur": 3,
    "args": {
       "External id": 281,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233198841, "dur": 83,
    "args": {
       "External id": 280,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233199062, "dur": 3,
    "args": {
       "External id": 283,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233198995, "dur": 75,
    "args": {
       "External id": 282,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233199178,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715133357760, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233199199,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567232, "Bytes": 512, "Total Allocated": 400489472, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233199214,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715133357760, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 37628, "tid": 37628,
    "ts": 1638154233199173, "dur": 81,
    "args": {
       "External id": 284,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233199508, "dur": 3,
    "args": {
       "External id": 287,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233199420, "dur": 99,
    "args": {
       "External id": 286,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233199664, "dur": 3,
    "args": {
       "External id": 289,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233199587, "dur": 88,
    "args": {
       "External id": 288,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233199892,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": 3538944, "Total Allocated": 404028416, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233199883, "dur": 20,
    "args": {
       "External id": 292,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233199814, "dur": 94,
    "args": {
       "External id": 291,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233199979, "dur": 50,
    "args": {
       "External id": 293,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233199746, "dur": 288,
    "args": {
       "External id": 290,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233200254, "dur": 3,
    "args": {
       "External id": 296,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233200186, "dur": 75,
    "args": {
       "External id": 295,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 37628, "tid": 37628,
    "ts": 1638154233200113, "dur": 190,
    "args": {
       "External id": 294,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 37628, "tid": 37628,
    "ts": 1638154233199352, "dur": 955,
    "args": {
       "External id": 285,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233200316,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567232, "Bytes": -512, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233200326,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233200524,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": 3538944, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 37628, "tid": 37628,
    "ts": 1638154233200514, "dur": 52,
    "args": {
       "External id": 298,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 37628, "tid": 37628,
    "ts": 1638154233200433, "dur": 141,
    "args": {
       "External id": 297,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233200581,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233200979,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": 3538944, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233200963, "dur": 28,
    "args": {
       "External id": 302,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233200885, "dur": 111,
    "args": {
       "External id": 301,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233201166,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545816576, "Bytes": 884736, "Total Allocated": 404912640, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233201152, "dur": 24,
    "args": {
       "External id": 304,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233201076, "dur": 104,
    "args": {
       "External id": 303,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233200800, "dur": 423,
    "args": {
       "External id": 300,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233201229,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545816576, "Bytes": -884736, "Total Allocated": 404027904, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233200722, "dur": 515,
    "args": {
       "External id": 299,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233201246,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": -3538944, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233201467, "dur": 3,
    "args": {
       "External id": 307,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233201397, "dur": 79,
    "args": {
       "External id": 306,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 37628, "tid": 37628,
    "ts": 1638154233201634, "dur": 6,
    "args": {
       "External id": 309,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233201550, "dur": 94,
    "args": {
       "External id": 308,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233201784, "dur": 2,
    "args": {
       "External id": 311,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233201715, "dur": 76,
    "args": {
       "External id": 310,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233202074,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": 18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233202066, "dur": 19,
    "args": {
       "External id": 315,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233201997, "dur": 95,
    "args": {
       "External id": 314,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233202161, "dur": 45,
    "args": {
       "External id": 316,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233201928, "dur": 282,
    "args": {
       "External id": 313,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233202351, "dur": 4,
    "args": {
       "External id": 318,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233202283, "dur": 76,
    "args": {
       "External id": 317,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233201863, "dur": 499,
    "args": {
       "External id": 312,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233202519,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233202512, "dur": 19,
    "args": {
       "External id": 320,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 37628, "tid": 37628,
    "ts": 1638154233202439, "dur": 136,
    "args": {
       "External id": 319,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233202727, "dur": 3,
    "args": {
       "External id": 322,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233202658, "dur": 76,
    "args": {
       "External id": 321,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233202739,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233201328, "dur": 1419,
    "args": {
       "External id": 305,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233202893, "dur": 3,
    "args": {
       "External id": 324,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233202822, "dur": 79,
    "args": {
       "External id": 323,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233203205,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233203197, "dur": 19,
    "args": {
       "External id": 328,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233203130, "dur": 90,
    "args": {
       "External id": 327,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233203297, "dur": 42,
    "args": {
       "External id": 329,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233203061, "dur": 283,
    "args": {
       "External id": 326,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 37628, "tid": 37628,
    "ts": 1638154233202993, "dur": 353,
    "args": {
       "External id": 325,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233203429, "dur": 6,
    "args": {
       "External id": 330,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233203445,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233203798, "dur": 3,
    "args": {
       "External id": 334,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233203721, "dur": 84,
    "args": {
       "External id": 333,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233203644, "dur": 167,
    "args": {
       "External id": 332,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233203966, "dur": 4,
    "args": {
       "External id": 336,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233204064,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233204053, "dur": 114,
    "args": {
       "External id": 337,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233204335, "dur": 3,
    "args": {
       "External id": 339,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233204258, "dur": 83,
    "args": {
       "External id": 338,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233203891, "dur": 455,
    "args": {
       "External id": 335,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233204422, "dur": 45,
    "args": {
       "External id": 340,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233203557, "dur": 914,
    "args": {
       "External id": 331,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233204844,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233204826, "dur": 31,
    "args": {
       "External id": 344,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233204750, "dur": 116,
    "args": {
       "External id": 343,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205036,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382861393920, "Bytes": 4718592, "Total Allocated": 461830656, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233205023, "dur": 23,
    "args": {
       "External id": 346,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233204946, "dur": 104,
    "args": {
       "External id": 345,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233204666, "dur": 426,
    "args": {
       "External id": 342,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205098,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382861393920, "Bytes": -4718592, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233204580, "dur": 525,
    "args": {
       "External id": 341,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205113,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205124,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205133,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": -18874368, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205141,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": -18874368, "Total Allocated": 381614592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205149,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": -18874368, "Total Allocated": 362740224, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205156,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": -3538944, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205253,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 37628, "tid": 37628,
    "ts": 1638154233205240, "dur": 52,
    "args": {
       "External id": 347,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205309,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382842519552, "Bytes": -18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205581,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233205574, "dur": 17,
    "args": {
       "External id": 350,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205687,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": 12288, "Total Allocated": 378087936, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233205681, "dur": 16,
    "args": {
       "External id": 351,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233205778,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": 12288, "Total Allocated": 378100224, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233205772, "dur": 15,
    "args": {
       "External id": 352,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233205916, "dur": 5,
    "args": {
       "External id": 353,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233205996, "dur": 1,
    "args": {
       "External id": 354,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233205495, "dur": 511,
    "args": {
       "External id": 349,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233206011,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": -12288, "Total Allocated": 378087936, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233206019,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": -12288, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233205422, "dur": 603,
    "args": {
       "External id": 348,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233206373, "dur": 3,
    "args": {
       "External id": 358,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233206296, "dur": 87,
    "args": {
       "External id": 357,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233206213, "dur": 176,
    "args": {
       "External id": 356,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233206547, "dur": 5,
    "args": {
       "External id": 360,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233206659,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379630338048, "Bytes": 75497472, "Total Allocated": 453573120, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233206648, "dur": 78,
    "args": {
       "External id": 361,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233206894, "dur": 3,
    "args": {
       "External id": 363,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233206816, "dur": 85,
    "args": {
       "External id": 362,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233206468, "dur": 438,
    "args": {
       "External id": 359,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233206982, "dur": 44,
    "args": {
       "External id": 364,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233206137, "dur": 893,
    "args": {
       "External id": 355,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233207154,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379705835520, "Bytes": 75497472, "Total Allocated": 529070592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 37628, "tid": 37628,
    "ts": 1638154233207142, "dur": 55,
    "args": {
       "External id": 365,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233207207,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379630338048, "Bytes": -75497472, "Total Allocated": 453573120, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233207537, "dur": 3,
    "args": {
       "External id": 369,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233207457, "dur": 90,
    "args": {
       "External id": 368,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233207380, "dur": 173,
    "args": {
       "External id": 367,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233207717, "dur": 5,
    "args": {
       "External id": 371,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233207819,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": 18874368, "Total Allocated": 472447488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233207810, "dur": 98,
    "args": {
       "External id": 372,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233208078, "dur": 3,
    "args": {
       "External id": 374,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233208000, "dur": 88,
    "args": {
       "External id": 373,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233207640, "dur": 453,
    "args": {
       "External id": 370,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233208169, "dur": 40,
    "args": {
       "External id": 375,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233207307, "dur": 907,
    "args": {
       "External id": 366,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208224,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379705835520, "Bytes": -75497472, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208589,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": 18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233208573, "dur": 57,
    "args": {
       "External id": 379,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233208495, "dur": 140,
    "args": {
       "External id": 378,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208808,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": 4718592, "Total Allocated": 420542976, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233208794, "dur": 30,
    "args": {
       "External id": 381,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233208718, "dur": 110,
    "args": {
       "External id": 380,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233208412, "dur": 459,
    "args": {
       "External id": 377,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208877,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": -4718592, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233208334, "dur": 550,
    "args": {
       "External id": 376,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208893,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": -18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208903,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": -18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208911,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": -18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233208918,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": -18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233209193,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": 18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233209186, "dur": 17,
    "args": {
       "External id": 384,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233209287,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": 12288, "Total Allocated": 359213568, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233209281, "dur": 15,
    "args": {
       "External id": 385,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233209373,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": 12288, "Total Allocated": 359225856, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233209367, "dur": 19,
    "args": {
       "External id": 386,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233209512, "dur": 4,
    "args": {
       "External id": 387,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233209583, "dur": 2,
    "args": {
       "External id": 388,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233209102, "dur": 493,
    "args": {
       "External id": 383,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233209600,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": -12288, "Total Allocated": 359213568, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233209617,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": -12288, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233209032, "dur": 590,
    "args": {
       "External id": 382,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(53): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233209942, "dur": 2,
    "args": {
       "External id": 392,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233209870, "dur": 79,
    "args": {
       "External id": 391,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233209798, "dur": 157,
    "args": {
       "External id": 390,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233210099, "dur": 5,
    "args": {
       "External id": 394,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233210193,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": 18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233210182, "dur": 102,
    "args": {
       "External id": 395,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233210442, "dur": 2,
    "args": {
       "External id": 397,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233210370, "dur": 83,
    "args": {
       "External id": 396,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233210027, "dur": 431,
    "args": {
       "External id": 393,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233210533, "dur": 42,
    "args": {
       "External id": 398,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233209727, "dur": 852,
    "args": {
       "External id": 389,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233210669, "dur": 7,
    "args": {
       "External id": 399,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233210814, "dur": 2,
    "args": {
       "External id": 401,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233210747, "dur": 75,
    "args": {
       "External id": 400,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(74): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233211131, "dur": 2,
    "args": {
       "External id": 405,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233211059, "dur": 78,
    "args": {
       "External id": 404,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233210987, "dur": 154,
    "args": {
       "External id": 403,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233211284, "dur": 3,
    "args": {
       "External id": 407,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233211375,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233211365, "dur": 96,
    "args": {
       "External id": 408,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233211627, "dur": 6,
    "args": {
       "External id": 410,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233211545, "dur": 96,
    "args": {
       "External id": 409,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233211212, "dur": 434,
    "args": {
       "External id": 406,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233211718, "dur": 40,
    "args": {
       "External id": 411,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233210916, "dur": 846,
    "args": {
       "External id": 402,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233211840, "dur": 5,
    "args": {
       "External id": 412,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233211986, "dur": 2,
    "args": {
       "External id": 414,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233211916, "dur": 78,
    "args": {
       "External id": 413,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(75): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233212300, "dur": 1,
    "args": {
       "External id": 418,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233212228, "dur": 77,
    "args": {
       "External id": 417,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233212156, "dur": 154,
    "args": {
       "External id": 416,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233212455, "dur": 3,
    "args": {
       "External id": 420,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233212553,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": 18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233212542, "dur": 106,
    "args": {
       "External id": 421,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233212804, "dur": 3,
    "args": {
       "External id": 423,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233212733, "dur": 78,
    "args": {
       "External id": 422,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233212383, "dur": 433,
    "args": {
       "External id": 419,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233212889, "dur": 38,
    "args": {
       "External id": 424,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233212086, "dur": 845,
    "args": {
       "External id": 415,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233213233, "dur": 7,
    "args": {
       "External id": 425,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233213374, "dur": 2,
    "args": {
       "External id": 427,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233213309, "dur": 72,
    "args": {
       "External id": 426,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(76): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233213512, "dur": 2,
    "args": {
       "External id": 429,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233213450, "dur": 69,
    "args": {
       "External id": 428,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233213953, "dur": 2,
    "args": {
       "External id": 432,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233213866, "dur": 95,
    "args": {
       "External id": 431,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233214272,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": 18874368, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233214260, "dur": 27,
    "args": {
       "External id": 436,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233214193, "dur": 98,
    "args": {
       "External id": 435,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233214366, "dur": 52,
    "args": {
       "External id": 437,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233214091, "dur": 331,
    "args": {
       "External id": 434,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233214582, "dur": 3,
    "args": {
       "External id": 439,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233214515, "dur": 74,
    "args": {
       "External id": 438,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233214026, "dur": 567,
    "args": {
       "External id": 433,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233214861, "dur": 2,
    "args": {
       "External id": 441,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233214790, "dur": 79,
    "args": {
       "External id": 440,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233215181,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": 18874368, "Total Allocated": 453573120, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233215173, "dur": 21,
    "args": {
       "External id": 445,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233215107, "dur": 91,
    "args": {
       "External id": 444,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233215297, "dur": 40,
    "args": {
       "External id": 446,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], [512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233215040, "dur": 301,
    "args": {
       "External id": 443,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233215513, "dur": 3,
    "args": {
       "External id": 448,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233215451, "dur": 68,
    "args": {
       "External id": 447,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233214933, "dur": 595,
    "args": {
       "External id": 442,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 32, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233215697,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382857854976, "Bytes": 3538944, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233215685, "dur": 24,
    "args": {
       "External id": 450,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 37628, "tid": 37628,
    "ts": 1638154233215598, "dur": 154,
    "args": {
       "External id": 449,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], [24576, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233215932, "dur": 3,
    "args": {
       "External id": 452,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233215868, "dur": 71,
    "args": {
       "External id": 451,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233215944,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233215952,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233213720, "dur": 2238,
    "args": {
       "External id": 430,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 32, 6]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233215981,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715134205760, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233216078,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382861393920, "Bytes": 3538944, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mul", "pid": 37628, "tid": 37628,
    "ts": 1638154233216062, "dur": 61,
    "args": {
       "External id": 453,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(79): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233216132,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715134205760, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233216142,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382857854976, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233216305, "dur": 3,
    "args": {
       "External id": 455,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233216236, "dur": 80,
    "args": {
       "External id": 454,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233216445, "dur": 2,
    "args": {
       "External id": 457,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::slice", "pid": 37628, "tid": 37628,
    "ts": 1638154233216381, "dur": 71,
    "args": {
       "External id": 456,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233216533,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715134228928, "Bytes": 8, "Total Allocated": 5880, "Total Reserved": 0
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233216553,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567232, "Bytes": 512, "Total Allocated": 419363840, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233216564,
    "args": {
      "Device Type": 0, "Device Id": -1, "Addr": 94715134228928, "Bytes": -8, "Total Allocated": 5872, "Total Reserved": 0
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::eq", "pid": 37628, "tid": 37628,
    "ts": 1638154233216529, "dur": 82,
    "args": {
       "External id": 458,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233216827, "dur": 2,
    "args": {
       "External id": 461,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233216761, "dur": 74,
    "args": {
       "External id": 460,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233216966, "dur": 2,
    "args": {
       "External id": 463,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233216902, "dur": 71,
    "args": {
       "External id": 462,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233217182,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382864932864, "Bytes": 3538944, "Total Allocated": 422902784, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233217174, "dur": 19,
    "args": {
       "External id": 466,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233217109, "dur": 88,
    "args": {
       "External id": 465,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233217268, "dur": 46,
    "args": {
       "External id": 467,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233217045, "dur": 273,
    "args": {
       "External id": 464,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233217519, "dur": 3,
    "args": {
       "External id": 470,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233217455, "dur": 70,
    "args": {
       "External id": 469,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1, 1, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["bool", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill_", "pid": 37628, "tid": 37628,
    "ts": 1638154233217385, "dur": 179,
    "args": {
       "External id": 468,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::masked_fill", "pid": 37628, "tid": 37628,
    "ts": 1638154233216695, "dur": 873,
    "args": {
       "External id": 459,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [1, 1, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(80): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "bool", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233217577,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567232, "Bytes": -512, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233217586,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382861393920, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233217756,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382868471808, "Bytes": 3538944, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_softmax", "pid": 37628, "tid": 37628,
    "ts": 1638154233217746, "dur": 48,
    "args": {
       "External id": 472,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::softmax", "pid": 37628, "tid": 37628,
    "ts": 1638154233217679, "dur": 119,
    "args": {
       "External id": 471,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1680): softmax;/home/jiangyouhe/memory_cost_model/mingpt/model.py(81): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233217805,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382864932864, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233218158,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382872010752, "Bytes": 3538944, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233218142, "dur": 26,
    "args": {
       "External id": 476,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233218070, "dur": 108,
    "args": {
       "External id": 475,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233218337,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545816576, "Bytes": 884736, "Total Allocated": 423787008, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233218324, "dur": 22,
    "args": {
       "External id": 478,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233218251, "dur": 99,
    "args": {
       "External id": 477,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233217990, "dur": 400,
    "args": {
       "External id": 474,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233218395,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545816576, "Bytes": -884736, "Total Allocated": 422902272, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233217918, "dur": 485,
    "args": {
       "External id": 473,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(82): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233218411,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382868471808, "Bytes": -3538944, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233218628, "dur": 3,
    "args": {
       "External id": 481,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233218552, "dur": 85,
    "args": {
       "External id": 480,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_reshape_alias", "pid": 37628, "tid": 37628,
    "ts": 1638154233218771, "dur": 6,
    "args": {
       "External id": 483,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233218706, "dur": 74,
    "args": {
       "External id": 482,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233218914, "dur": 2,
    "args": {
       "External id": 485,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::expand", "pid": 37628, "tid": 37628,
    "ts": 1638154233218847, "dur": 73,
    "args": {
       "External id": 484,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233219193,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": 18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233219185, "dur": 19,
    "args": {
       "External id": 489,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233219120, "dur": 88,
    "args": {
       "External id": 488,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233219276, "dur": 43,
    "args": {
       "External id": 490,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233219055, "dur": 268,
    "args": {
       "External id": 487,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233219456, "dur": 3,
    "args": {
       "External id": 492,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233219392, "dur": 71,
    "args": {
       "External id": 491,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::reshape", "pid": 37628, "tid": 37628,
    "ts": 1638154233218987, "dur": 479,
    "args": {
       "External id": 486,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233219615,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233219599, "dur": 27,
    "args": {
       "External id": 494,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::bmm", "pid": 37628, "tid": 37628,
    "ts": 1638154233219533, "dur": 139,
    "args": {
       "External id": 493,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 6], [24576, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233219804, "dur": 3,
    "args": {
       "External id": 496,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233219740, "dur": 71,
    "args": {
       "External id": 495,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[24576, 6, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233219816,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233218484, "dur": 1343,
    "args": {
       "External id": 479,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 6], [512, 48, 6, 32]], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(83): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233219965, "dur": 2,
    "args": {
       "External id": 498,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233219900, "dur": 72,
    "args": {
       "External id": 497,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 48, 6, 32], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233220240,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233220234, "dur": 19,
    "args": {
       "External id": 502,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233220173, "dur": 84,
    "args": {
       "External id": 501,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [], [], [], [], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::copy_", "pid": 37628, "tid": 37628,
    "ts": 1638154233220322, "dur": 37,
    "args": {
       "External id": 503,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], [512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::clone", "pid": 37628, "tid": 37628,
    "ts": 1638154233220108, "dur": 258,
    "args": {
       "External id": 500,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::contiguous", "pid": 37628, "tid": 37628,
    "ts": 1638154233220045, "dur": 324,
    "args": {
       "External id": 499,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233220443, "dur": 5,
    "args": {
       "External id": 504,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 48, 32], []], "Call stack": "/home/jiangyouhe/memory_cost_model/mingpt/model.py(84): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233220455,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233220784, "dur": 2,
    "args": {
       "External id": 508,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233220712, "dur": 78,
    "args": {
       "External id": 507,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233220639, "dur": 156,
    "args": {
       "External id": 506,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233220940, "dur": 4,
    "args": {
       "External id": 510,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233221037,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": 18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233221027, "dur": 104,
    "args": {
       "External id": 511,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233221289, "dur": 2,
    "args": {
       "External id": 513,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233221217, "dur": 78,
    "args": {
       "External id": 512,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233220868, "dur": 432,
    "args": {
       "External id": 509,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233221374, "dur": 42,
    "args": {
       "External id": 514,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233220559, "dur": 861,
    "args": {
       "External id": 505,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 1536], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233221782,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382876729344, "Bytes": 18874368, "Total Allocated": 475986432, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233221765, "dur": 29,
    "args": {
       "External id": 518,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233221693, "dur": 106,
    "args": {
       "External id": 517,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233221956,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382857854976, "Bytes": 4718592, "Total Allocated": 480705024, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233221944, "dur": 22,
    "args": {
       "External id": 520,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233221873, "dur": 96,
    "args": {
       "External id": 519,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233221596, "dur": 414,
    "args": {
       "External id": 516,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222019,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382857854976, "Bytes": -4718592, "Total Allocated": 475986432, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233221524, "dur": 502,
    "args": {
       "External id": 515,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/mingpt/model.py(87): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222034,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382838980608, "Bytes": -18874368, "Total Allocated": 457112064, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222043,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379884093440, "Bytes": -18874368, "Total Allocated": 438237696, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222052,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": -18874368, "Total Allocated": 419363328, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222063,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": -18874368, "Total Allocated": 400488960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222071,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": -18874368, "Total Allocated": 381614592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222078,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382872010752, "Bytes": -3538944, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222167,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382895603712, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add", "pid": 37628, "tid": 37628,
    "ts": 1638154233222155, "dur": 49,
    "args": {
       "External id": 521,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [512, 6, 1536], []], "Call stack": "/home/jiangyouhe/memory_cost_model/block_algorithm.py(54): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222214,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382876729344, "Bytes": -18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222480,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382876729344, "Bytes": 18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233222473, "dur": 17,
    "args": {
       "External id": 524,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222567,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": 12288, "Total Allocated": 396962304, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233222561, "dur": 18,
    "args": {
       "External id": 525,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222664,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": 12288, "Total Allocated": 396974592, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233222658, "dur": 15,
    "args": {
       "External id": 526,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233222791, "dur": 4,
    "args": {
       "External id": 527,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233222864, "dur": 2,
    "args": {
       "External id": 528,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233222394, "dur": 480,
    "args": {
       "External id": 523,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222879,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": -12288, "Total Allocated": 396962304, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233222886,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": -12288, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233222325, "dur": 566,
    "args": {
       "External id": 522,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(55): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233223211, "dur": 3,
    "args": {
       "External id": 532,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233223139, "dur": 78,
    "args": {
       "External id": 531,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233223066, "dur": 157,
    "args": {
       "External id": 530,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233223369, "dur": 5,
    "args": {
       "External id": 534,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233223463,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379630338048, "Bytes": 75497472, "Total Allocated": 472447488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233223452, "dur": 77,
    "args": {
       "External id": 535,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233223697, "dur": 2,
    "args": {
       "External id": 537,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233223623, "dur": 80,
    "args": {
       "External id": 536,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233223296, "dur": 412,
    "args": {
       "External id": 533,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233223783, "dur": 41,
    "args": {
       "External id": 538,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233222995, "dur": 833,
    "args": {
       "External id": 529,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [6144, 1536], [6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233223931,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379705835520, "Bytes": 75497472, "Total Allocated": 547944960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::gelu", "pid": 37628, "tid": 37628,
    "ts": 1638154233223920, "dur": 50,
    "args": {
       "External id": 539,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1556): gelu;/miniconda/lib/python3.8/site-packages/torch/nn/modules/activation.py(652): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233223978,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379630338048, "Bytes": -75497472, "Total Allocated": 472447488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233224285, "dur": 3,
    "args": {
       "External id": 543,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233224213, "dur": 79,
    "args": {
       "External id": 542,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233224140, "dur": 157,
    "args": {
       "External id": 541,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[1536, 6144]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233224443, "dur": 4,
    "args": {
       "External id": 545,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233224537,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": 18874368, "Total Allocated": 491321856, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233224527, "dur": 99,
    "args": {
       "External id": 546,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233224788, "dur": 3,
    "args": {
       "External id": 548,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233224714, "dur": 81,
    "args": {
       "External id": 547,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233224370, "dur": 430,
    "args": {
       "External id": 544,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [6144, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::add_", "pid": 37628, "tid": 37628,
    "ts": 1638154233224875, "dur": 37,
    "args": {
       "External id": 549,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233224069, "dur": 847,
    "args": {
       "External id": 540,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 6144], [1536, 6144], [1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233224926,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379705835520, "Bytes": -75497472, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225275,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": 18874368, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233225259, "dur": 27,
    "args": {
       "External id": 553,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233225186, "dur": 104,
    "args": {
       "External id": 552,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "", "", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225455,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": 4718592, "Total Allocated": 439417344, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233225443, "dur": 22,
    "args": {
       "External id": 555,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "GenericList", "Int", "Int", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty_like", "pid": 37628, "tid": 37628,
    "ts": 1638154233225365, "dur": 104,
    "args": {
       "External id": 554,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_fused_dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233225103, "dur": 405,
    "args": {
       "External id": 551,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225513,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379865219072, "Bytes": -4718592, "Total Allocated": 434698752, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::dropout", "pid": 37628, "tid": 37628,
    "ts": 1638154233225031, "dur": 492,
    "args": {
       "External id": 550,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1169): dropout;/miniconda/lib/python3.8/site-packages/torch/nn/modules/dropout.py(58): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/block_algorithm.py(56): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/torch/nn/modules/container.py(141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(130): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225531,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": -18874368, "Total Allocated": 415824384, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225540,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382895603712, "Bytes": -18874368, "Total Allocated": 396950016, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225548,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379951202304, "Bytes": -18874368, "Total Allocated": 378075648, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225555,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382876729344, "Bytes": -18874368, "Total Allocated": 359201280, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225562,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140379932327936, "Bytes": -18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225570,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382914478080, "Bytes": -18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225807,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": 18874368, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233225800, "dur": 18,
    "args": {
       "External id": 558,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225883,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": 12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233225877, "dur": 15,
    "args": {
       "External id": 559,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233225958,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": 12288, "Total Allocated": 340351488, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::empty", "pid": 37628, "tid": 37628,
    "ts": 1638154233225953, "dur": 13,
    "args": {
       "External id": 560,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["GenericList", "Int", "Int", "", "", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226073, "dur": 3,
    "args": {
       "External id": 561,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226141, "dur": 1,
    "args": {
       "External id": 562,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::native_layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233225736, "dur": 414,
    "args": {
       "External id": 557,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233226155,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545539584, "Bytes": -12288, "Total Allocated": 340339200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233226162,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545551872, "Bytes": -12288, "Total Allocated": 340326912, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::layer_norm", "pid": 37628, "tid": 37628,
    "ts": 1638154233225676, "dur": 491,
    "args": {
       "External id": 556,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [], [1536], [1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2347): layer_norm;/miniconda/lib/python3.8/site-packages/torch/nn/modules/normalization.py(189): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(131): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "float", "float", "Double", "Bool"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233226176,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382935449600, "Bytes": -18874368, "Total Allocated": 321452544, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::as_strided", "pid": 37628, "tid": 37628,
    "ts": 1638154233226430, "dur": 2,
    "args": {
       "External id": 566,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::transpose", "pid": 37628, "tid": 37628,
    "ts": 1638154233226370, "dur": 66,
    "args": {
       "External id": 565,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::t", "pid": 37628, "tid": 37628,
    "ts": 1638154233226312, "dur": 129,
    "args": {
       "External id": 564,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[10, 1536]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226557, "dur": 5,
    "args": {
       "External id": 568,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233226640,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545570816, "Bytes": 122880, "Total Allocated": 321575424, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::mm", "pid": 37628, "tid": 37628,
    "ts": 1638154233226630, "dur": 67,
    "args": {
       "External id": 569,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226822, "dur": 2,
    "args": {
       "External id": 571,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_unsafe_view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226765, "dur": 63,
    "args": {
       "External id": 570,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::matmul", "pid": 37628, "tid": 37628,
    "ts": 1638154233226499, "dur": 336,
    "args": {
       "External id": 567,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [1536, 10]], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::linear", "pid": 37628, "tid": 37628,
    "ts": 1638154233226258, "dur": 580,
    "args": {
       "External id": 563,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 1536], [10, 1536], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(1848): linear;/miniconda/lib/python3.8/site-packages/torch/nn/modules/linear.py(103): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(132): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233226847,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382818009088, "Bytes": -18874368, "Total Allocated": 302701056, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226910, "dur": 4,
    "args": {
       "External id": 572,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6, 10], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::view", "pid": 37628, "tid": 37628,
    "ts": 1638154233226969, "dur": 4,
    "args": {
       "External id": 573,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[512, 6], []], "Call stack": "/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["long int", "GenericList"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::to", "pid": 37628, "tid": 37628,
    "ts": 1638154233227173, "dur": 2,
    "args": {
       "External id": 576,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], [], [], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int", "", "", "Bool", "Bool", ""]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233227247,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545816576, "Bytes": 122880, "Total Allocated": 302823936, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_log_softmax", "pid": 37628, "tid": 37628,
    "ts": 1638154233227237, "dur": 54,
    "args": {
       "External id": 577,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Bool"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::log_softmax", "pid": 37628, "tid": 37628,
    "ts": 1638154233227120, "dur": 175,
    "args": {
       "External id": 575,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233227505,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567232, "Bytes": 512, "Total Allocated": 302824448, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233227516,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567744, "Bytes": 512, "Total Allocated": 302824960, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 37628, "tid": 37628,
    "ts": 1638154233227582, "dur": 1,
    "args": {
       "External id": 581,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::resize_", "pid": 37628, "tid": 37628,
    "ts": 1638154233227647, "dur": 1,
    "args": {
       "External id": 582,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "GenericList", ""]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_forward", "pid": 37628, "tid": 37628,
    "ts": 1638154233227495, "dur": 187,
    "args": {
       "External id": 580,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233227689,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545567744, "Bytes": -512, "Total Allocated": 302824448, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss", "pid": 37628, "tid": 37628,
    "ts": 1638154233227431, "dur": 265,
    "args": {
       "External id": 579,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::nll_loss_nd", "pid": 37628, "tid": 37628,
    "ts": 1638154233227368, "dur": 331,
    "args": {
       "External id": 578,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233227703,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545816576, "Bytes": -122880, "Total Allocated": 302701568, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::cross_entropy_loss", "pid": 37628, "tid": 37628,
    "ts": 1638154233227052, "dur": 657,
    "args": {
       "External id": 574,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[3072, 10], [3072], [], [], [], []], "Call stack": "/miniconda/lib/python3.8/site-packages/torch/nn/functional.py(2846): cross_entropy;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(133): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(279): forward;/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "long int", "", "Int", "Int", "Double"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233227718,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382495047680, "Bytes": -18874368, "Total Allocated": 283827200, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "CheckpointFunction", "pid": 37628, "tid": 37628,
    "ts": 1638154233189205, "dur": 38720,
    "args": {
       "External id": 181,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/checkpoint/checkpoint_activations.py(187): _checkpointed_forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/misc/flatten_params_wrapper.py(459): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1141): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Fwd thread id": 0, "Sequence number": 311
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "aten::_has_compatible_shallow_copy_type", "pid": 37628, "tid": 37628,
    "ts": 1638154233228013, "dur": 1,
    "args": {
       "External id": 583,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Input Dims": [[56706048], [14176512]], "Call stack": "/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1822): _use_fp32_param_shard;/miniconda/lib/python3.8/site-packages/torch/autograd/grad_mode.py(28): decorate_context;/miniconda/lib/python3.8/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py(1153): forward;/miniconda/lib/python3.8/site-packages/torch/nn/modules/module.py(1102): _call_impl;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(172): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;", "Input type": ["float", "float"]
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233228115,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545693696, "Bytes": -122880, "Total Allocated": 283704320, "Total Reserved": 752877568
    }
  },
  {
    "ph": "i", "s": "t", "name": "[memory]",
    "pid": 37628, "tid": 37628,
    "ts": 1638154233228223,
    "args": {
      "Device Type": 1, "Device Id": 3, "Addr": 140382545566720, "Bytes": -512, "Total Allocated": 283703808, "Total Reserved": 752877568
    }
  },
  {
    "ph": "X", "cat": "cpu_op", 
    "name": "ProfilerStep#6", "pid": 37628, "tid": 37628,
    "ts": 1638154233175876, "dur": 60709,
    "args": {
       "External id": 4,
       "Trace name": "PyTorch Profiler", "Trace iteration": 0,
       "Call stack": "/miniconda/lib/python3.8/site-packages/torch/autograd/profiler.py(435): __enter__;/miniconda/lib/python3.8/site-packages/torch/profiler/profiler.py(330): step;/home/jiangyouhe/memory_cost_model/fsdp_gpt.py(177): test_one_iteration;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(111): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(420): wrapper;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_distributed.py(536): run_test;/miniconda/lib/python3.8/site-packages/torch/testing/_internal/common_fsdp.py(302): _run;/miniconda/lib/python3.8/multiprocessing/process.py(108): run;/miniconda/lib/python3.8/multiprocessing/process.py(315): _bootstrap;/miniconda/lib/python3.8/multiprocessing/spawn.py(129): _main;/miniconda/lib/python3.8/multiprocessing/spawn.py(116): spawn_main;<string>(1): <module>;"
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233176995, "dur": 8,
    "args": {
      "cbid": 151, "correlation": 3865,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233177014, "dur": 8,
    "args": {
      "cbid": 138, "correlation": 3868,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233177023, "dur": 4,
    "args": {
      "cbid": 136, "correlation": 3869,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233177030, "dur": 2,
    "args": {
      "cbid": 138, "correlation": 3870,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233177033, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3871,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233177224, "dur": 3,
    "args": {
      "cbid": 151, "correlation": 3883,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638154233177713, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3896, "external id": 14,
      "bytes": 24576, "memory bandwidth (GB/s)": 11.462686567164178
    }
  },
  {
    "ph": "f", "id": 3896, "pid": 3, "tid": 7, "ts": 1638154233177713,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233177674, "dur": 37,
    "args": {
      "cbid": 41, "correlation": 3896,
      "external id": 14, "external ts": 1638154233177659
    }
  },
  {
    "ph": "s", "id": 3896, "pid": 37628, "tid": 37628, "ts": 1638154233177674,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 37628, "tid": 37628,
    "ts": 1638154233177712, "dur": 11,
    "args": {
      "cbid": 131, "correlation": 3897,
      "external id": 14, "external ts": 1638154233177659
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy HtoD (Pinned -> Device)", "pid": 3, "tid": 7,
    "ts": 1638154233177955, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3909, "external id": 18,
      "bytes": 24576, "memory bandwidth (GB/s)": 12.0
    }
  },
  {
    "ph": "f", "id": 3909, "pid": 3, "tid": 7, "ts": 1638154233177955,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233177930, "dur": 22,
    "args": {
      "cbid": 41, "correlation": 3909,
      "external id": 18, "external ts": 1638154233177920
    }
  },
  {
    "ph": "s", "id": 3909, "pid": 37628, "tid": 37628, "ts": 1638154233177930,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamSynchronize", "pid": 37628, "tid": 37628,
    "ts": 1638154233177953, "dur": 8,
    "args": {
      "cbid": 131, "correlation": 3910,
      "external id": 18, "external ts": 1638154233177920
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 37628, "tid": 37628,
    "ts": 1638154233178021, "dur": 7,
    "args": {
      "cbid": 165, "correlation": 3914,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233178808, "dur": 4,
    "args": {
      "cbid": 134, "correlation": 3920,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233178817, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 3923,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaStreamWaitEvent", "pid": 37628, "tid": 37628,
    "ts": 1638154233178829, "dur": 3,
    "args": {
      "cbid": 147, "correlation": 3926,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventDestroy", "pid": 37628, "tid": 37628,
    "ts": 1638154233178838, "dur": 2,
    "args": {
      "cbid": 136, "correlation": 3929,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638154233189635, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3938, "external id": 185,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.258064516129032
    }
  },
  {
    "ph": "f", "id": 3938, "pid": 3, "tid": 7, "ts": 1638154233189635,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233189595, "dur": 39,
    "args": {
      "cbid": 41, "correlation": 3938,
      "external id": 185, "external ts": 1638154233189581
    }
  },
  {
    "ph": "s", "id": 3938, "pid": 37628, "tid": 37628, "ts": 1638154233189595,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoH (Device -> Pinned)", "pid": 3, "tid": 7,
    "ts": 1638154233189913, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 3944, "external id": 189,
      "bytes": 24576, "memory bandwidth (GB/s)": 8.347826086956522
    }
  },
  {
    "ph": "f", "id": 3944, "pid": 3, "tid": 7, "ts": 1638154233189913,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233189896, "dur": 15,
    "args": {
      "cbid": 41, "correlation": 3944,
      "external id": 189, "external ts": 1638154233189888
    }
  },
  {
    "ph": "s", "id": 3944, "pid": 37628, "tid": 37628, "ts": 1638154233189896,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::indexSelectLargeIndex<float, long, unsigned int, 2, 2, -2, true>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<long, unsigned int>, int, int, unsigned int, unsigned int, long)", "pid": 3, "tid": 7,
    "ts": 1638154233190539, "dur": 76,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3957, "external id": 193,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 8.0,
      "warps per SM": 32.0,
      "grid": [544, 1, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3957, "pid": 3, "tid": 7, "ts": 1638154233190539,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233190505, "dur": 36,
    "args": {
      "cbid": 211, "correlation": 3957,
      "external id": 193, "external ts": 1638154233190306
    }
  },
  {
    "ph": "s", "id": 3957, "pid": 37628, "tid": 37628, "ts": 1638154233190505,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233191062, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3965, "external id": 201,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3965, "pid": 3, "tid": 7, "ts": 1638154233191062,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233191035, "dur": 27,
    "args": {
      "cbid": 211, "correlation": 3965,
      "external id": 201, "external ts": 1638154233190995
    }
  },
  {
    "ph": "s", "id": 3965, "pid": 37628, "tid": 37628, "ts": 1638154233191035,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233191643, "dur": 87,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 3987, "external id": 203,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 3987, "pid": 3, "tid": 7, "ts": 1638154233191643,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233191619, "dur": 24,
    "args": {
      "cbid": 211, "correlation": 3987,
      "external id": 203, "external ts": 1638154233191268
    }
  },
  {
    "ph": "s", "id": 3987, "pid": 37628, "tid": 37628, "ts": 1638154233191619,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233192221, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4001, "external id": 209,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4001, "pid": 3, "tid": 7, "ts": 1638154233192221,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233192198, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4001,
      "external id": 209, "external ts": 1638154233191909
    }
  },
  {
    "ph": "s", "id": 4001, "pid": 37628, "tid": 37628, "ts": 1638154233192198,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233192357, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4003, "external id": 209,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4003, "pid": 3, "tid": 7, "ts": 1638154233192357,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233192223, "dur": 15,
    "args": {
      "cbid": 211, "correlation": 4003,
      "external id": 209, "external ts": 1638154233191909
    }
  },
  {
    "ph": "s", "id": 4003, "pid": 37628, "tid": 37628, "ts": 1638154233192223,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233193143, "dur": 4,
    "args": {
      "cbid": 251, "correlation": 4010,
      "external id": 221, "external ts": 1638154233193105
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233193152, "dur": 6,
    "args": {
      "cbid": 138, "correlation": 4011,
      "external id": 221, "external ts": 1638154233193105
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233193181, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4012, "external id": 221,
      "bytes": 2304, "memory bandwidth (GB/s)": 4.8
    }
  },
  {
    "ph": "f", "id": 4012, "pid": 3, "tid": 7, "ts": 1638154233193181,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233193162, "dur": 16,
    "args": {
      "cbid": 51, "correlation": 4012,
      "external id": 221, "external ts": 1638154233193105
    }
  },
  {
    "ph": "s", "id": 4012, "pid": 37628, "tid": 37628, "ts": 1638154233193162,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233193179, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4013,
      "external id": 221, "external ts": 1638154233193105
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233193212, "dur": 1382,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4014, "external id": 221,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4014, "pid": 3, "tid": 7, "ts": 1638154233193212,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233193191, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4014,
      "external id": 221, "external ts": 1638154233193105
    }
  },
  {
    "ph": "s", "id": 4014, "pid": 37628, "tid": 37628, "ts": 1638154233193191,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233193218, "dur": 3,
    "args": {
      "cbid": 135, "correlation": 4016,
      "external id": 221, "external ts": 1638154233193105
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233194597, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4020, "external id": 224,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4020, "pid": 3, "tid": 7, "ts": 1638154233194597,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233193542, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4020,
      "external id": 224, "external ts": 1638154233193521
    }
  },
  {
    "ph": "s", "id": 4020, "pid": 37628, "tid": 37628, "ts": 1638154233193542,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233194452, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4027,
      "external id": 234, "external ts": 1638154233194417
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233194459, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4028,
      "external id": 234, "external ts": 1638154233194417
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233194674, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4029, "external id": 234,
      "bytes": 2304, "memory bandwidth (GB/s)": 2.25
    }
  },
  {
    "ph": "f", "id": 4029, "pid": 3, "tid": 7, "ts": 1638154233194674,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233194466, "dur": 14,
    "args": {
      "cbid": 51, "correlation": 4029,
      "external id": 234, "external ts": 1638154233194417
    }
  },
  {
    "ph": "s", "id": 4029, "pid": 37628, "tid": 37628, "ts": 1638154233194466,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233194481, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4030,
      "external id": 234, "external ts": 1638154233194417
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233194677, "dur": 1377,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4031, "external id": 234,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4031, "pid": 3, "tid": 7, "ts": 1638154233194677,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233194491, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4031,
      "external id": 234, "external ts": 1638154233194417
    }
  },
  {
    "ph": "s", "id": 4031, "pid": 37628, "tid": 37628, "ts": 1638154233194491,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233194515, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4033,
      "external id": 234, "external ts": 1638154233194417
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233196056, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4037, "external id": 237,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4037, "pid": 3, "tid": 7, "ts": 1638154233196056,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233194926, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4037,
      "external id": 237, "external ts": 1638154233194907
    }
  },
  {
    "ph": "s", "id": 4037, "pid": 37628, "tid": 37628, "ts": 1638154233194926,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233195805, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4044,
      "external id": 247, "external ts": 1638154233195769
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233195812, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4045,
      "external id": 247, "external ts": 1638154233195769
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233196133, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4046, "external id": 247,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.945945945945946
    }
  },
  {
    "ph": "f", "id": 4046, "pid": 3, "tid": 7, "ts": 1638154233196133,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233195819, "dur": 13,
    "args": {
      "cbid": 51, "correlation": 4046,
      "external id": 247, "external ts": 1638154233195769
    }
  },
  {
    "ph": "s", "id": 4046, "pid": 37628, "tid": 37628, "ts": 1638154233195819,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233195833, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4047,
      "external id": 247, "external ts": 1638154233195769
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233196135, "dur": 1378,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4048, "external id": 247,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4048, "pid": 3, "tid": 7, "ts": 1638154233196135,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233195843, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4048,
      "external id": 247, "external ts": 1638154233195769
    }
  },
  {
    "ph": "s", "id": 4048, "pid": 37628, "tid": 37628, "ts": 1638154233195843,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233195868, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4050,
      "external id": 247, "external ts": 1638154233195769
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233197515, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4054, "external id": 250,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4054, "pid": 3, "tid": 7, "ts": 1638154233197515,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233196151, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4054,
      "external id": 250, "external ts": 1638154233196134
    }
  },
  {
    "ph": "s", "id": 4054, "pid": 37628, "tid": 37628, "ts": 1638154233196151,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233197591, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4062, "external id": 263,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4062, "pid": 3, "tid": 7, "ts": 1638154233197591,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233197231, "dur": 24,
    "args": {
      "cbid": 211, "correlation": 4062,
      "external id": 263, "external ts": 1638154233197214
    }
  },
  {
    "ph": "s", "id": 4062, "pid": 37628, "tid": 37628, "ts": 1638154233197231,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233197984, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4071, "external id": 272,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4071, "pid": 3, "tid": 7, "ts": 1638154233197984,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233197964, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4071,
      "external id": 272, "external ts": 1638154233197951
    }
  },
  {
    "ph": "s", "id": 4071, "pid": 37628, "tid": 37628, "ts": 1638154233197964,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638154233198358, "dur": 283,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4081, "external id": 275,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4081, "pid": 3, "tid": 7, "ts": 1638154233198358,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233198338, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4081,
      "external id": 275, "external ts": 1638154233198229
    }
  },
  {
    "ph": "s", "id": 4081, "pid": 37628, "tid": 37628, "ts": 1638154233198338,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638154233198719, "dur": 9,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4087, "external id": 279,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4087, "pid": 3, "tid": 7, "ts": 1638154233198719,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233198697, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4087,
      "external id": 279, "external ts": 1638154233198664
    }
  },
  {
    "ph": "s", "id": 4087, "pid": 37628, "tid": 37628, "ts": 1638154233198697,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638154233199248, "dur": 1,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4095, "external id": 284,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4095, "pid": 3, "tid": 7, "ts": 1638154233199248,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233199226, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4095,
      "external id": 284, "external ts": 1638154233199173
    }
  },
  {
    "ph": "s", "id": 4095, "pid": 37628, "tid": 37628, "ts": 1638154233199226,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638154233200022, "dur": 9,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4102, "external id": 293,
      "bytes": 3538944, "memory bandwidth (GB/s)": 356.7843532614175
    }
  },
  {
    "ph": "f", "id": 4102, "pid": 3, "tid": 7, "ts": 1638154233200022,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233199989, "dur": 34,
    "args": {
      "cbid": 41, "correlation": 4102,
      "external id": 293, "external ts": 1638154233199979
    }
  },
  {
    "ph": "s", "id": 4102, "pid": 37628, "tid": 37628, "ts": 1638154233199989,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233200296, "dur": 14,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4107, "external id": 294,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4107, "pid": 3, "tid": 7, "ts": 1638154233200296,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233200276, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4107,
      "external id": 294, "external ts": 1638154233200113
    }
  },
  {
    "ph": "s", "id": 4107, "pid": 37628, "tid": 37628, "ts": 1638154233200276,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638154233200560, "dur": 20,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4114, "external id": 298,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4114, "pid": 3, "tid": 7, "ts": 1638154233200560,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233200541, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4114,
      "external id": 298, "external ts": 1638154233200514
    }
  },
  {
    "ph": "s", "id": 4114, "pid": 37628, "tid": 37628, "ts": 1638154233200541,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233201218, "dur": 12,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4136, "external id": 300,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4136, "pid": 3, "tid": 7, "ts": 1638154233201218,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233201195, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4136,
      "external id": 300, "external ts": 1638154233200800
    }
  },
  {
    "ph": "s", "id": 4136, "pid": 37628, "tid": 37628, "ts": 1638154233201195,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233202199, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4144, "external id": 316,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4144, "pid": 3, "tid": 7, "ts": 1638154233202199,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233202178, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4144,
      "external id": 316, "external ts": 1638154233202161
    }
  },
  {
    "ph": "s", "id": 4144, "pid": 37628, "tid": 37628, "ts": 1638154233202178,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638154233202569, "dur": 272,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4154, "external id": 319,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4154, "pid": 3, "tid": 7, "ts": 1638154233202569,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233202549, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4154,
      "external id": 319, "external ts": 1638154233202439
    }
  },
  {
    "ph": "s", "id": 4154, "pid": 37628, "tid": 37628, "ts": 1638154233202549,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233203333, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4163, "external id": 329,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4163, "pid": 3, "tid": 7, "ts": 1638154233203333,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233203312, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4163,
      "external id": 329, "external ts": 1638154233203297
    }
  },
  {
    "ph": "s", "id": 4163, "pid": 37628, "tid": 37628, "ts": 1638154233203312,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233204091, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4172,
      "external id": 337, "external ts": 1638154233204053
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233204099, "dur": 6,
    "args": {
      "cbid": 138, "correlation": 4173,
      "external id": 337, "external ts": 1638154233204053
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233204126, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4174, "external id": 337,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.3584905660377358
    }
  },
  {
    "ph": "f", "id": 4174, "pid": 3, "tid": 7, "ts": 1638154233204126,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233204108, "dur": 15,
    "args": {
      "cbid": 51, "correlation": 4174,
      "external id": 337, "external ts": 1638154233204053
    }
  },
  {
    "ph": "s", "id": 4174, "pid": 37628, "tid": 37628, "ts": 1638154233204108,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233204124, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4175,
      "external id": 337, "external ts": 1638154233204053
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233204155, "dur": 1382,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4176, "external id": 337,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4176, "pid": 3, "tid": 7, "ts": 1638154233204155,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233204135, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4176,
      "external id": 337, "external ts": 1638154233204053
    }
  },
  {
    "ph": "s", "id": 4176, "pid": 37628, "tid": 37628, "ts": 1638154233204135,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233204160, "dur": 3,
    "args": {
      "cbid": 135, "correlation": 4178,
      "external id": 337, "external ts": 1638154233204053
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233205539, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4182, "external id": 340,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4182, "pid": 3, "tid": 7, "ts": 1638154233205539,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233204441, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4182,
      "external id": 340, "external ts": 1638154233204422
    }
  },
  {
    "ph": "s", "id": 4182, "pid": 37628, "tid": 37628, "ts": 1638154233204441,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233205616, "dur": 88,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4204, "external id": 342,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4204, "pid": 3, "tid": 7, "ts": 1638154233205616,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233205065, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4204,
      "external id": 342, "external ts": 1638154233204666
    }
  },
  {
    "ph": "s", "id": 4204, "pid": 37628, "tid": 37628, "ts": 1638154233205065,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638154233205707, "dur": 102,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4210, "external id": 347,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4210, "pid": 3, "tid": 7, "ts": 1638154233205707,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233205267, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4210,
      "external id": 347, "external ts": 1638154233205240
    }
  },
  {
    "ph": "s", "id": 4210, "pid": 37628, "tid": 37628, "ts": 1638154233205267,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233205817, "dur": 125,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4224, "external id": 349,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4224, "pid": 3, "tid": 7, "ts": 1638154233205817,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233205795, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4224,
      "external id": 349, "external ts": 1638154233205495
    }
  },
  {
    "ph": "s", "id": 4224, "pid": 37628, "tid": 37628, "ts": 1638154233205795,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233205945, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4226, "external id": 349,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4226, "pid": 3, "tid": 7, "ts": 1638154233205945,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233205819, "dur": 14,
    "args": {
      "cbid": 211, "correlation": 4226,
      "external id": 349, "external ts": 1638154233205495
    }
  },
  {
    "ph": "s", "id": 4226, "pid": 37628, "tid": 37628, "ts": 1638154233205819,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233206682, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4233,
      "external id": 361, "external ts": 1638154233206648
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233206688, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4234,
      "external id": 361, "external ts": 1638154233206648
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638154233206720, "dur": 5136,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4235, "external id": 361,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4235, "pid": 3, "tid": 7, "ts": 1638154233206720,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233206698, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4235,
      "external id": 361, "external ts": 1638154233206648
    }
  },
  {
    "ph": "s", "id": 4235, "pid": 37628, "tid": 37628, "ts": 1638154233206698,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233211859, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4240, "external id": 364,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4240, "pid": 3, "tid": 7, "ts": 1638154233211859,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233207000, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4240,
      "external id": 364, "external ts": 1638154233206982
    }
  },
  {
    "ph": "s", "id": 4240, "pid": 37628, "tid": 37628, "ts": 1638154233207000,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638154233212142, "dur": 281,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4246, "external id": 365,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4246, "pid": 3, "tid": 7, "ts": 1638154233212142,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233207170, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4246,
      "external id": 365, "external ts": 1638154233207142
    }
  },
  {
    "ph": "s", "id": 4246, "pid": 37628, "tid": 37628, "ts": 1638154233207170,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233207842, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4253,
      "external id": 372, "external ts": 1638154233207810
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233207849, "dur": 6,
    "args": {
      "cbid": 138, "correlation": 4254,
      "external id": 372, "external ts": 1638154233207810
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233212426, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4255, "external id": 372,
      "bytes": 1152, "memory bandwidth (GB/s)": 1.44
    }
  },
  {
    "ph": "f", "id": 4255, "pid": 3, "tid": 7, "ts": 1638154233212426,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233207858, "dur": 17,
    "args": {
      "cbid": 51, "correlation": 4255,
      "external id": 372, "external ts": 1638154233207810
    }
  },
  {
    "ph": "s", "id": 4255, "pid": 37628, "tid": 37628, "ts": 1638154233207858,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638154233212429, "dur": 5158,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4256, "external id": 372,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4256, "pid": 3, "tid": 7, "ts": 1638154233212429,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233207877, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4256,
      "external id": 372, "external ts": 1638154233207810
    }
  },
  {
    "ph": "s", "id": 4256, "pid": 37628, "tid": 37628, "ts": 1638154233207877,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233207901, "dur": 3,
    "args": {
      "cbid": 135, "correlation": 4258,
      "external id": 372, "external ts": 1638154233207810
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233217590, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4262, "external id": 375,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4262, "pid": 3, "tid": 7, "ts": 1638154233217590,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233208185, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4262,
      "external id": 375, "external ts": 1638154233208169
    }
  },
  {
    "ph": "s", "id": 4262, "pid": 37628, "tid": 37628, "ts": 1638154233208185,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233217666, "dur": 86,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4284, "external id": 377,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4284, "pid": 3, "tid": 7, "ts": 1638154233217666,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233208843, "dur": 23,
    "args": {
      "cbid": 211, "correlation": 4284,
      "external id": 377, "external ts": 1638154233208412
    }
  },
  {
    "ph": "s", "id": 4284, "pid": 37628, "tid": 37628, "ts": 1638154233208843,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233217755, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4298, "external id": 383,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4298, "pid": 3, "tid": 7, "ts": 1638154233217755,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233209394, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4298,
      "external id": 383, "external ts": 1638154233209102
    }
  },
  {
    "ph": "s", "id": 4298, "pid": 37628, "tid": 37628, "ts": 1638154233209394,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233217890, "dur": 68,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4300, "external id": 383,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4300, "pid": 3, "tid": 7, "ts": 1638154233217890,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233209416, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4300,
      "external id": 383, "external ts": 1638154233209102
    }
  },
  {
    "ph": "s", "id": 4300, "pid": 37628, "tid": 37628, "ts": 1638154233209416,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233210214, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4307,
      "external id": 395, "external ts": 1638154233210182
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233210221, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 4308,
      "external id": 395, "external ts": 1638154233210182
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233217960, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4309, "external id": 395,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.7560975609756098
    }
  },
  {
    "ph": "f", "id": 4309, "pid": 3, "tid": 7, "ts": 1638154233217960,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233210229, "dur": 14,
    "args": {
      "cbid": 51, "correlation": 4309,
      "external id": 395, "external ts": 1638154233210182
    }
  },
  {
    "ph": "s", "id": 4309, "pid": 37628, "tid": 37628, "ts": 1638154233210229,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233210244, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4310,
      "external id": 395, "external ts": 1638154233210182
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233217962, "dur": 1379,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4311, "external id": 395,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4311, "pid": 3, "tid": 7, "ts": 1638154233217962,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233210255, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4311,
      "external id": 395, "external ts": 1638154233210182
    }
  },
  {
    "ph": "s", "id": 4311, "pid": 37628, "tid": 37628, "ts": 1638154233210255,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233210277, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4313,
      "external id": 395, "external ts": 1638154233210182
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233219344, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4317, "external id": 398,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4317, "pid": 3, "tid": 7, "ts": 1638154233219344,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233210550, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4317,
      "external id": 398, "external ts": 1638154233210533
    }
  },
  {
    "ph": "s", "id": 4317, "pid": 37628, "tid": 37628, "ts": 1638154233210550,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233211399, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4324,
      "external id": 408, "external ts": 1638154233211365
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233211405, "dur": 3,
    "args": {
      "cbid": 138, "correlation": 4325,
      "external id": 408, "external ts": 1638154233211365
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233219420, "dur": 2,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4326, "external id": 408,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.125
    }
  },
  {
    "ph": "f", "id": 4326, "pid": 3, "tid": 7, "ts": 1638154233219420,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233211411, "dur": 12,
    "args": {
      "cbid": 51, "correlation": 4326,
      "external id": 408, "external ts": 1638154233211365
    }
  },
  {
    "ph": "s", "id": 4326, "pid": 37628, "tid": 37628, "ts": 1638154233211411,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233211424, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4327,
      "external id": 408, "external ts": 1638154233211365
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233219424, "dur": 1378,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4328, "external id": 408,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4328, "pid": 3, "tid": 7, "ts": 1638154233219424,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233211433, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4328,
      "external id": 408, "external ts": 1638154233211365
    }
  },
  {
    "ph": "s", "id": 4328, "pid": 37628, "tid": 37628, "ts": 1638154233211433,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233211455, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4330,
      "external id": 408, "external ts": 1638154233211365
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233220805, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4334, "external id": 411,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4334, "pid": 3, "tid": 7, "ts": 1638154233220805,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233211734, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4334,
      "external id": 411, "external ts": 1638154233211718
    }
  },
  {
    "ph": "s", "id": 4334, "pid": 37628, "tid": 37628, "ts": 1638154233211734,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233212574, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4341,
      "external id": 421, "external ts": 1638154233212542
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233212581, "dur": 4,
    "args": {
      "cbid": 138, "correlation": 4342,
      "external id": 421, "external ts": 1638154233212542
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233220881, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4343, "external id": 421,
      "bytes": 2304, "memory bandwidth (GB/s)": 1.2857142857142858
    }
  },
  {
    "ph": "f", "id": 4343, "pid": 3, "tid": 7, "ts": 1638154233220881,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233212587, "dur": 11,
    "args": {
      "cbid": 51, "correlation": 4343,
      "external id": 421, "external ts": 1638154233212542
    }
  },
  {
    "ph": "s", "id": 4343, "pid": 37628, "tid": 37628, "ts": 1638154233212587,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233212599, "dur": 13,
    "args": {
      "cbid": 251, "correlation": 4344,
      "external id": 421, "external ts": 1638154233212542
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233220884, "dur": 1378,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4345, "external id": 421,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4345, "pid": 3, "tid": 7, "ts": 1638154233220884,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233212619, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4345,
      "external id": 421, "external ts": 1638154233212542
    }
  },
  {
    "ph": "s", "id": 4345, "pid": 37628, "tid": 37628, "ts": 1638154233212619,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233212641, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4347,
      "external id": 421, "external ts": 1638154233212542
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233222263, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4351, "external id": 424,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4351, "pid": 3, "tid": 7, "ts": 1638154233222263,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233212904, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4351,
      "external id": 424, "external ts": 1638154233212889
    }
  },
  {
    "ph": "s", "id": 4351, "pid": 37628, "tid": 37628, "ts": 1638154233212904,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233222339, "dur": 75,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4359, "external id": 437,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4359, "pid": 3, "tid": 7, "ts": 1638154233222339,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233214384, "dur": 28,
    "args": {
      "cbid": 211, "correlation": 4359,
      "external id": 437, "external ts": 1638154233214366
    }
  },
  {
    "ph": "s", "id": 4359, "pid": 37628, "tid": 37628, "ts": 1638154233214384,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233222416, "dur": 71,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4368, "external id": 446,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4368, "pid": 3, "tid": 7, "ts": 1638154233222416,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233215310, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4368,
      "external id": 446, "external ts": 1638154233215297
    }
  },
  {
    "ph": "s", "id": 4368, "pid": 37628, "tid": 37628, "ts": 1638154233215310,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233215472, "dur": 9,
    "args": {
      "cbid": 151, "correlation": 4375,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaPointerGetAttributes", "pid": 37628, "tid": -1114306816,
    "ts": 1638154233215571, "dur": 3,
    "args": {
      "cbid": 151, "correlation": 4381,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638154233222490, "dur": 282,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4390, "external id": 449,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4390, "pid": 3, "tid": 7, "ts": 1638154233222490,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233215725, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4390,
      "external id": 449, "external ts": 1638154233215598
    }
  },
  {
    "ph": "s", "id": 4390, "pid": 37628, "tid": 37628, "ts": 1638154233215725,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, float, at::native::MulFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638154233222775, "dur": 9,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4396, "external id": 453,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4396, "pid": 3, "tid": 7, "ts": 1638154233222775,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233216097, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4396,
      "external id": 453, "external ts": 1638154233216062
    }
  },
  {
    "ph": "s", "id": 4396, "pid": 37628, "tid": 37628, "ts": 1638154233216097,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::BUnaryFunctor<float, float, bool, at::native::CompareEqFunctor<float> >, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638154233222787, "dur": 1,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4404, "external id": 458,
      "registers per thread": 16,
      "shared memory": 0,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.029411765,
      "grid": [1, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4404, "pid": 3, "tid": 7, "ts": 1638154233222787,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233216575, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4404,
      "external id": 458, "external ts": 1638154233216529
    }
  },
  {
    "ph": "s", "id": 4404, "pid": 37628, "tid": 37628, "ts": 1638154233216575,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Memcpy", 
    "name": "Memcpy DtoD (Device -> Device)", "pid": 3, "tid": 7,
    "ts": 1638154233222790, "dur": 9,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4411, "external id": 467,
      "bytes": 3538944, "memory bandwidth (GB/s)": 362.6338764217645
    }
  },
  {
    "ph": "f", "id": 4411, "pid": 3, "tid": 7, "ts": 1638154233222790,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemcpyAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233217277, "dur": 31,
    "args": {
      "cbid": 41, "correlation": 4411,
      "external id": 467, "external ts": 1638154233217268
    }
  },
  {
    "ph": "s", "id": 4411, "pid": 37628, "tid": 37628, "ts": 1638154233217277,
    "cat": "async_gpu", "name": "cudaMemcpyAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast>(int, at::native::(anonymous namespace)::masked_fill_kernel<bool>(at::TensorIterator&, c10::Scalar const&)::{lambda()#1}::operator()() const::{lambda()#8}::operator()() const::{lambda(float, bool)#1}, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, at::detail::Array<1, unsigned int, false>, at::native::memory::LoadWithoutCast, OffsetCalculator::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233222801, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4416, "external id": 468,
      "registers per thread": 24,
      "shared memory": 0,
      "blocks per SM": 50.82353,
      "warps per SM": 101.64706,
      "grid": [3456, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4416, "pid": 3, "tid": 7, "ts": 1638154233222801,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233217539, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4416,
      "external id": 468, "external ts": 1638154233217385
    }
  },
  {
    "ph": "s", "id": 4416, "pid": 37628, "tid": 37628, "ts": 1638154233217539,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 3, false>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638154233222816, "dur": 21,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4423, "external id": 472,
      "registers per thread": 19,
      "shared memory": 0,
      "blocks per SM": 67.76471,
      "warps per SM": 271.05884,
      "grid": [4608, 1, 1],
      "block": [8, 16, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4423, "pid": 3, "tid": 7, "ts": 1638154233222816,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233217770, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4423,
      "external id": 472, "external ts": 1638154233217746
    }
  },
  {
    "ph": "s", "id": 4423, "pid": 37628, "tid": 37628, "ts": 1638154233217770,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233222840, "dur": 13,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4445, "external id": 474,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4445, "pid": 3, "tid": 7, "ts": 1638154233222840,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233218364, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4445,
      "external id": 474, "external ts": 1638154233217990
    }
  },
  {
    "ph": "s", "id": 4445, "pid": 37628, "tid": 37628, "ts": 1638154233218364,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233222855, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4453, "external id": 490,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4453, "pid": 3, "tid": 7, "ts": 1638154233222855,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233219291, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4453,
      "external id": 490, "external ts": 1638154233219276
    }
  },
  {
    "ph": "s", "id": 4453, "pid": 37628, "tid": 37628, "ts": 1638154233219291,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void gemmSN_NN_kernel<float, 128, 2, 4, 8, 3, 4, cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float> >(cublasGemmSmallNParams<cublasGemvTensorStridedBatched<float const>, cublasGemvTensorStridedBatched<float>, float>)", "pid": 3, "tid": 7,
    "ts": 1638154233222932, "dur": 271,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4463, "external id": 493,
      "registers per thread": 64,
      "shared memory": 7680,
      "blocks per SM": 722.82355,
      "warps per SM": 2891.2942,
      "grid": [1, 2, 24576],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4463, "pid": 3, "tid": 7, "ts": 1638154233222932,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233219648, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4463,
      "external id": 493, "external ts": 1638154233219533
    }
  },
  {
    "ph": "s", "id": 4463, "pid": 37628, "tid": 37628, "ts": 1638154233219648,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast>(int, at::native::copy_device_to_device(at::TensorIterator&, bool)::{lambda()#3}::operator()() const::{lambda()#8}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, OffsetCalculator<1, unsigned int, false>, char*, at::native::memory::LoadWithoutCast, at::detail::Array<char*, 2>::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233223205, "dur": 73,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4472, "external id": 503,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4472, "pid": 3, "tid": 7, "ts": 1638154233223205,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233220334, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4472,
      "external id": 503, "external ts": 1638154233220322
    }
  },
  {
    "ph": "s", "id": 4472, "pid": 37628, "tid": 37628, "ts": 1638154233220334,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233221059, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4481,
      "external id": 511, "external ts": 1638154233221027
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233221067, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 4482,
      "external id": 511, "external ts": 1638154233221027
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233223281, "dur": 0,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4483, "external id": 511,
      "bytes": 2304, "memory bandwidth (GB/s)": 8.0
    }
  },
  {
    "ph": "f", "id": 4483, "pid": 3, "tid": 7, "ts": 1638154233223281,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233221075, "dur": 14,
    "args": {
      "cbid": 51, "correlation": 4483,
      "external id": 511, "external ts": 1638154233221027
    }
  },
  {
    "ph": "s", "id": 4483, "pid": 37628, "tid": 37628, "ts": 1638154233221075,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233221091, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4484,
      "external id": 511, "external ts": 1638154233221027
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x64_tn", "pid": 3, "tid": 7,
    "ts": 1638154233223283, "dur": 1379,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4485, "external id": 511,
      "registers per thread": 122,
      "shared memory": 12800,
      "blocks per SM": 16.941177,
      "warps per SM": 67.76471,
      "grid": [12, 48, 2],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4485, "pid": 3, "tid": 7, "ts": 1638154233223283,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233221101, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4485,
      "external id": 511, "external ts": 1638154233221027
    }
  },
  {
    "ph": "s", "id": 4485, "pid": 37628, "tid": 37628, "ts": 1638154233221101,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233221124, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4487,
      "external id": 511, "external ts": 1638154233221027
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233224664, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4491, "external id": 514,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4491, "pid": 3, "tid": 7, "ts": 1638154233224664,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233221391, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4491,
      "external id": 514, "external ts": 1638154233221374
    }
  },
  {
    "ph": "s", "id": 4491, "pid": 37628, "tid": 37628, "ts": 1638154233221391,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233224741, "dur": 83,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4513, "external id": 516,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4513, "pid": 3, "tid": 7, "ts": 1638154233224741,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233221984, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4513,
      "external id": 516, "external ts": 1638154233221596
    }
  },
  {
    "ph": "s", "id": 4513, "pid": 37628, "tid": 37628, "ts": 1638154233221984,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3> >(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>)", "pid": 3, "tid": 7,
    "ts": 1638154233224827, "dur": 103,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4519, "external id": 521,
      "registers per thread": 20,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4519, "pid": 3, "tid": 7, "ts": 1638154233224827,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233222181, "dur": 18,
    "args": {
      "cbid": 211, "correlation": 4519,
      "external id": 521, "external ts": 1638154233222155
    }
  },
  {
    "ph": "s", "id": 4519, "pid": 37628, "tid": 37628, "ts": 1638154233222181,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233224933, "dur": 125,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4533, "external id": 523,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4533, "pid": 3, "tid": 7, "ts": 1638154233224933,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233222681, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4533,
      "external id": 523, "external ts": 1638154233222394
    }
  },
  {
    "ph": "s", "id": 4533, "pid": 37628, "tid": 37628, "ts": 1638154233222681,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233225060, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4535, "external id": 523,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4535, "pid": 3, "tid": 7, "ts": 1638154233225060,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233222704, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4535,
      "external id": 523, "external ts": 1638154233222394
    }
  },
  {
    "ph": "s", "id": 4535, "pid": 37628, "tid": 37628, "ts": 1638154233222704,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233223489, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4542,
      "external id": 535, "external ts": 1638154233223452
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233223495, "dur": 1,
    "args": {
      "cbid": 251, "correlation": 4543,
      "external id": 535, "external ts": 1638154233223452
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638154233225131, "dur": 5134,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4544, "external id": 535,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [48, 24, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4544, "pid": 3, "tid": 7, "ts": 1638154233225131,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233223504, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4544,
      "external id": 535, "external ts": 1638154233223452
    }
  },
  {
    "ph": "s", "id": 4544, "pid": 37628, "tid": 37628, "ts": 1638154233223504,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233230267, "dur": 282,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4549, "external id": 538,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4549, "pid": 3, "tid": 7, "ts": 1638154233230267,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233223800, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4549,
      "external id": 538, "external ts": 1638154233223783
    }
  },
  {
    "ph": "s", "id": 4549, "pid": 37628, "tid": 37628, "ts": 1638154233223800,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::vectorized_elementwise_kernel<4, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2> >(int, at::native::(anonymous namespace)::GeluCUDAKernelImpl(at::TensorIteratorBase&)::{lambda()#1}::operator()() const::{lambda()#4}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>)", "pid": 3, "tid": 7,
    "ts": 1638154233230551, "dur": 280,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4555, "external id": 539,
      "registers per thread": 32,
      "shared memory": 0,
      "blocks per SM": 1084.2354,
      "warps per SM": 2168.4707,
      "grid": [73728, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4555, "pid": 3, "tid": 7, "ts": 1638154233230551,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233223946, "dur": 19,
    "args": {
      "cbid": 211, "correlation": 4555,
      "external id": 539, "external ts": 1638154233223920
    }
  },
  {
    "ph": "s", "id": 4555, "pid": 37628, "tid": 37628, "ts": 1638154233223946,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233224556, "dur": 2,
    "args": {
      "cbid": 251, "correlation": 4562,
      "external id": 546, "external ts": 1638154233224527
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233224563, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 4563,
      "external id": 546, "external ts": 1638154233224527
    }
  },
  {
    "ph": "X", "cat": "Memset", 
    "name": "Memset (Device)", "pid": 3, "tid": 7,
    "ts": 1638154233230834, "dur": 1,
    "args": {
      "device": 3, "context": 1,
      "stream": 7, "correlation": 4564, "external id": 546,
      "bytes": 1152, "memory bandwidth (GB/s)": 0.9473684210526315
    }
  },
  {
    "ph": "f", "id": 4564, "pid": 3, "tid": 7, "ts": 1638154233230834,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaMemsetAsync", "pid": 37628, "tid": 37628,
    "ts": 1638154233224570, "dur": 14,
    "args": {
      "cbid": 51, "correlation": 4564,
      "external id": 546, "external ts": 1638154233224527
    }
  },
  {
    "ph": "s", "id": 4564, "pid": 37628, "tid": 37628, "ts": 1638154233224570,
    "cat": "async_gpu", "name": "cudaMemsetAsync", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_128x128_tn", "pid": 3, "tid": 7,
    "ts": 1638154233230836, "dur": 5162,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4565, "external id": 546,
      "registers per thread": 118,
      "shared memory": 16896,
      "blocks per SM": 16.941177,
      "warps per SM": 135.52942,
      "grid": [12, 24, 4],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 50
    }
  },
  {
    "ph": "f", "id": 4565, "pid": 3, "tid": 7, "ts": 1638154233230836,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233224586, "dur": 28,
    "args": {
      "cbid": 211, "correlation": 4565,
      "external id": 546, "external ts": 1638154233224527
    }
  },
  {
    "ph": "s", "id": 4565, "pid": 37628, "tid": 37628, "ts": 1638154233224586,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233224619, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4567,
      "external id": 546, "external ts": 1638154233224527
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::unrolled_elementwise_kernel<at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast>(int, at::native::BinaryFunctor<float, float, float, at::native::AddFunctor<float> >, at::detail::Array<char*, 3>, OffsetCalculator<2, unsigned int, false>, OffsetCalculator<1, unsigned int, false>, at::native::memory::LoadWithoutCast, at::native::memory::StoreWithoutCast)", "pid": 3, "tid": 7,
    "ts": 1638154233236002, "dur": 74,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4571, "external id": 549,
      "registers per thread": 22,
      "shared memory": 0,
      "blocks per SM": 271.05884,
      "warps per SM": 542.1177,
      "grid": [18432, 1, 1],
      "block": [64, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4571, "pid": 3, "tid": 7, "ts": 1638154233236002,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233224890, "dur": 17,
    "args": {
      "cbid": 211, "correlation": 4571,
      "external id": 549, "external ts": 1638154233224875
    }
  },
  {
    "ph": "s", "id": 4571, "pid": 37628, "tid": 37628, "ts": 1638154233224890,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::fused_dropout_kernel_vec<float, float, unsigned int, 1, 4>(at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<float, unsigned int>, at::cuda::detail::TensorInfo<unsigned char, unsigned int>, unsigned int, float, at::PhiloxCudaState)", "pid": 3, "tid": 7,
    "ts": 1638154233236079, "dur": 86,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4593, "external id": 551,
      "registers per thread": 47,
      "shared memory": 0,
      "blocks per SM": 4.0,
      "warps per SM": 32.0,
      "grid": [272, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4593, "pid": 3, "tid": 7, "ts": 1638154233236079,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233225483, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4593,
      "external id": 551, "external ts": 1638154233225103
    }
  },
  {
    "ph": "s", "id": 4593, "pid": 37628, "tid": 37628, "ts": 1638154233225483,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::RowwiseMomentsCUDAKernel<float>(long, float, float const*, float*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233236167, "dur": 133,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4607, "external id": 557,
      "registers per thread": 26,
      "shared memory": 768,
      "blocks per SM": 45.17647,
      "warps per SM": 722.82355,
      "grid": [3072, 1, 1],
      "block": [512, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4607, "pid": 3, "tid": 7, "ts": 1638154233236167,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233225976, "dur": 20,
    "args": {
      "cbid": 211, "correlation": 4607,
      "external id": 557, "external ts": 1638154233225736
    }
  },
  {
    "ph": "s", "id": 4607, "pid": 37628, "tid": 37628, "ts": 1638154233225976,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::LayerNormForwardCUDAKernel<float>(long, float const*, float const*, float const*, float const*, float const*, float*)", "pid": 3, "tid": 7,
    "ts": 1638154233236302, "dur": 69,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4609, "external id": 557,
      "registers per thread": 21,
      "shared memory": 0,
      "blocks per SM": 45.17647,
      "warps per SM": 361.41177,
      "grid": [3072, 1, 1],
      "block": [256, 1, 1],
      "est. achieved occupancy %": 100
    }
  },
  {
    "ph": "f", "id": 4609, "pid": 3, "tid": 7, "ts": 1638154233236302,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233225999, "dur": 13,
    "args": {
      "cbid": 211, "correlation": 4609,
      "external id": 557, "external ts": 1638154233225736
    }
  },
  {
    "ph": "s", "id": 4609, "pid": 37628, "tid": 37628, "ts": 1638154233225999,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233226662, "dur": 3,
    "args": {
      "cbid": 251, "correlation": 4616,
      "external id": 569, "external ts": 1638154233226630
    }
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "volta_sgemm_32x32_sliced1x4_tn", "pid": 3, "tid": 7,
    "ts": 1638154233236374, "dur": 83,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4617, "external id": 569,
      "registers per thread": 86,
      "shared memory": 32768,
      "blocks per SM": 1.4117647,
      "warps per SM": 5.647059,
      "grid": [1, 96, 1],
      "block": [128, 1, 1],
      "est. achieved occupancy %": 18
    }
  },
  {
    "ph": "f", "id": 4617, "pid": 3, "tid": 7, "ts": 1638154233236374,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233226669, "dur": 22,
    "args": {
      "cbid": 211, "correlation": 4617,
      "external id": 569, "external ts": 1638154233226630
    }
  },
  {
    "ph": "s", "id": 4617, "pid": 37628, "tid": 37628, "ts": 1638154233226669,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void (anonymous namespace)::softmax_warp_forward<float, float, float, 4, true>(float*, float const*, int, int, int)", "pid": 3, "tid": 7,
    "ts": 1638154233236458, "dur": 3,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4624, "external id": 577,
      "registers per thread": 18,
      "shared memory": 0,
      "blocks per SM": 2.8235295,
      "warps per SM": 11.294118,
      "grid": [192, 1, 1],
      "block": [16, 8, 1],
      "est. achieved occupancy %": 35
    }
  },
  {
    "ph": "f", "id": 4624, "pid": 3, "tid": 7, "ts": 1638154233236458,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233227263, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4624,
      "external id": 577, "external ts": 1638154233227237
    }
  },
  {
    "ph": "s", "id": 4624, "pid": 37628, "tid": 37628, "ts": 1638154233227263,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Kernel", 
    "name": "void at::native::(anonymous namespace)::nll_loss_forward_reduce_cuda_kernel_2d<float, float, long>(float*, float*, float*, long*, float*, bool, int, int, int, long)", "pid": 3, "tid": 7,
    "ts": 1638154233236463, "dur": 57,
    "args": {
      "queued": 0, "device": 3, "context": 1,
      "stream": 7, "correlation": 4631, "external id": 580,
      "registers per thread": 38,
      "shared memory": 256,
      "blocks per SM": 0.014705882,
      "warps per SM": 0.014705882,
      "grid": [1, 1, 1],
      "block": [32, 1, 1],
      "est. achieved occupancy %": 0
    }
  },
  {
    "ph": "f", "id": 4631, "pid": 3, "tid": 7, "ts": 1638154233236463,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaLaunchKernel", "pid": 37628, "tid": 37628,
    "ts": 1638154233227655, "dur": 21,
    "args": {
      "cbid": 211, "correlation": 4631,
      "external id": 580, "external ts": 1638154233227495
    }
  },
  {
    "ph": "s", "id": 4631, "pid": 37628, "tid": 37628, "ts": 1638154233227655,
    "cat": "async_gpu", "name": "cudaLaunchKernel", "bp": "e"
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233228133, "dur": 3,
    "args": {
      "cbid": 134, "correlation": 4636,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233228138, "dur": 2,
    "args": {
      "cbid": 135, "correlation": 4637,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventQuery", "pid": 37628, "tid": 37628,
    "ts": 1638154233228145, "dur": 5,
    "args": {
      "cbid": 138, "correlation": 4639,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventCreateWithFlags", "pid": 37628, "tid": 37628,
    "ts": 1638154233228156, "dur": 1,
    "args": {
      "cbid": 134, "correlation": 4643,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaEventRecord", "pid": 37628, "tid": 37628,
    "ts": 1638154233228158, "dur": 1,
    "args": {
      "cbid": 135, "correlation": 4644,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 37628, "tid": 37628,
    "ts": 1638154233228267, "dur": 8258,
    "args": {
      "cbid": 165, "correlation": 4648,
      "external id": 4, "external ts": 1638154233175876
    }
  },
  {
    "ph": "X", "cat": "Runtime", 
    "name": "cudaDeviceSynchronize", "pid": 37628, "tid": 37628,
    "ts": 1638154233236636, "dur": 6,
    "args": {
      "cbid": 165, "correlation": 4651,
      "external id": 0, "external ts": 1638154233228223
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 37628, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 37628, "tid": 0,
    "args": {
      "labels": "CPU"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 37628, "tid": 0,
    "args": {
      "sort_index": 37628
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 0, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 0, "tid": 0,
    "args": {
      "labels": "GPU 0"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 0, "tid": 0,
    "args": {
      "sort_index": 16777216
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 1, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 1, "tid": 0,
    "args": {
      "labels": "GPU 1"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 1, "tid": 0,
    "args": {
      "sort_index": 16777217
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 2, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 2, "tid": 0,
    "args": {
      "labels": "GPU 2"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 2, "tid": 0,
    "args": {
      "sort_index": 16777218
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 3, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 3, "tid": 0,
    "args": {
      "labels": "GPU 3"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 3, "tid": 0,
    "args": {
      "sort_index": 16777219
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 4, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 4, "tid": 0,
    "args": {
      "labels": "GPU 4"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 4, "tid": 0,
    "args": {
      "sort_index": 16777220
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 5, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 5, "tid": 0,
    "args": {
      "labels": "GPU 5"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 5, "tid": 0,
    "args": {
      "sort_index": 16777221
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 6, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 6, "tid": 0,
    "args": {
      "labels": "GPU 6"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 6, "tid": 0,
    "args": {
      "sort_index": 16777222
    }
  },
  {
    "name": "process_name", "ph": "M", "ts": 1638154233175196, "pid": 7, "tid": 0,
    "args": {
      "name": "python"
    }
  },
  {
    "name": "process_labels", "ph": "M", "ts": 1638154233175196, "pid": 7, "tid": 0,
    "args": {
      "labels": "GPU 7"
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 7, "tid": 0,
    "args": {
      "sort_index": 16777223
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638154233175196, "pid": 3, "tid": 7,
    "args": {
      "name": "stream 7"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 3, "tid": 7,
    "args": {
      "sort_index": 7
    }
  },
  {
    "name": "thread_name", "ph": "M", "ts": 1638154233175196, "pid": 37628, "tid": 37628,
    "args": {
      "name": "thread 37628 (python)"
    }
  },
  {
    "name": "thread_sort_index", "ph": "M", "ts": 1638154233175196, "pid": 37628, "tid": 37628,
    "args": {
      "sort_index": 37628
    }
  },
  {
    "ph": "X", "cat": "Trace", "ts": 1638154233175196, "dur": 61456,
    "pid": "Spans", "tid": "PyTorch Profiler",
    "name": "PyTorch Profiler (0)",
    "args": {
      "Op count": 0
    }
  },
  {
    "name": "process_sort_index", "ph": "M", "ts": 1638154233175196,
    "pid": "Spans", "tid": 0,
    "args": {
      "sort_index": 536870912
    }
  },
  {
    "name": "Iteration Start: PyTorch Profiler", "ph": "i", "s": "g",
    "pid": "Traces", "tid": "Trace PyTorch Profiler", "ts": 1638154233175196
  },
  {
    "name": "Record Window End", "ph": "i", "s": "g",
    "pid": "", "tid": "", "ts": 1638154233244052
  }
]}